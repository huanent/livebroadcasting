!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.TEduBoard=e():t.TEduBoard=e()}(window,function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(r,o,function(e){return t[e]}.bind(null,o));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=137)}([function(t,e,i){var r=i(35)("wks"),o=i(21),n=i(1).Symbol,s="function"==typeof n;(t.exports=function(t){return r[t]||(r[t]=s&&n[t]||(s?n:o)("Symbol."+t))}).store=r},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e,i){var r=i(1),o=i(19),n=i(9),s=i(10),a=i(14),l=function(t,e,i){var d,u,c,h,p=t&l.F,f=t&l.G,g=t&l.S,m=t&l.P,y=t&l.B,_=f?r:g?r[e]||(r[e]={}):(r[e]||{}).prototype,v=f?o:o[e]||(o[e]={}),T=v.prototype||(v.prototype={});for(d in f&&(i=e),i)c=((u=!p&&_&&void 0!==_[d])?_:i)[d],h=y&&u?a(c,r):m&&"function"==typeof c?a(Function.call,c):c,_&&s(_,d,c,t&l.U),v[d]!=c&&n(v,d,h),m&&T[d]!=c&&(T[d]=c)};r.core=o,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,i){t.exports=!i(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,i){var r=i(8);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,i){var r=i(22),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,i){var r=i(5),o=i(72),n=i(32),s=Object.defineProperty;e.f=i(4)?Object.defineProperty:function(t,e,i){if(r(t),e=n(e,!0),r(i),o)try{return s(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){var r=i(7),o=i(27);t.exports=i(4)?function(t,e,i){return r.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var r=i(1),o=i(9),n=i(12),s=i(21)("src"),a=i(95),l=(""+a).split("toString");i(19).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var d="function"==typeof i;d&&(n(i,"name")||o(i,"name",e)),t[e]!==i&&(d&&(n(i,s)||o(i,s,t[e]?""+t[e]:l.join(String(e)))),t===r?t[e]=i:a?t[e]?t[e]=i:o(t,e,i):(delete t[e],o(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(t,e,i){var r=i(26);t.exports=function(t){return Object(r(t))}},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e,i){"use strict";var r=i(31),o={};o[i(0)("toStringTag")]="z",o+""!="[object z]"&&i(10)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,i){var r=i(30);t.exports=function(t,e,i){if(r(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,r){return t.call(e,i,r)};case 3:return function(i,r,o){return t.call(e,i,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,i){var r=i(2);r(r.S+r.F,"Object",{assign:i(96)})},function(t,e,i){"use strict";i(97);var r=i(5),o=i(36),n=i(4),s=/./.toString,a=function(t){i(10)(RegExp.prototype,"toString",t,!0)};i(3)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?a(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?o.call(t):void 0)}):"toString"!=s.name&&a(function(){return s.call(this)})},function(t,e,i){var r=Date.prototype,o=r.toString,n=r.getTime;new Date(NaN)+""!="Invalid Date"&&i(10)(r,"toString",function(){var t=n.call(this);return t==t?o.call(this):"Invalid Date"})},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e){var i=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=i)},function(t,e){t.exports=!1},function(t,e){var i=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+r).toString(36))}},function(t,e){var i=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:i)(t)}},function(t,e,i){var r=i(73),o=i(56);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e,i){var r=i(53),o=i(26);t.exports=function(t){return r(o(t))}},function(t,e,i){"use strict";var r=i(44),o=i(5),n=i(45),s=i(46),a=i(6),l=i(47),d=i(48),u=i(3),c=Math.min,h=[].push,p=!u(function(){RegExp(4294967295,"y")});i(49)("split",2,function(t,e,i,u){var f;return f="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var o=String(this);if(void 0===t&&0===e)return[];if(!r(t))return i.call(o,t,e);for(var n,s,a,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),c=0,p=void 0===e?4294967295:e>>>0,f=new RegExp(t.source,u+"g");(n=d.call(f,o))&&!((s=f.lastIndex)>c&&(l.push(o.slice(c,n.index)),n.length>1&&n.index<o.length&&h.apply(l,n.slice(1)),a=n[0].length,c=s,l.length>=p));)f.lastIndex===n.index&&f.lastIndex++;return c===o.length?!a&&f.test("")||l.push(""):l.push(o.slice(c)),l.length>p?l.slice(0,p):l}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,r){var o=t(this),n=null==i?void 0:i[e];return void 0!==n?n.call(i,o,r):f.call(String(o),i,r)},function(t,e){var r=u(f,t,this,e,f!==i);if(r.done)return r.value;var d=o(t),h=String(this),g=n(d,RegExp),m=d.unicode,y=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(p?"y":"g"),_=new g(p?d:"^(?:"+d.source+")",y),v=void 0===e?4294967295:e>>>0;if(0===v)return[];if(0===h.length)return null===l(_,h)?[h]:[];for(var T=0,S=0,E=[];S<h.length;){_.lastIndex=p?S:0;var b,O=l(_,p?h:h.slice(S));if(null===O||(b=c(a(_.lastIndex+(p?0:S)),h.length))===T)S=s(h,S,m);else{if(E.push(h.slice(T,S)),E.length===v)return E;for(var x=1;x<=O.length-1;x++)if(E.push(O[x]),E.length===v)return E;S=T=b}}return E.push(h.slice(T)),E}]})},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports={}},function(t,e,i){var r=i(73),o=i(56).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,i){var r=i(18),o=i(0)("toStringTag"),n="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?i:n?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,i){var r=i(8);t.exports=function(t,e){if(!r(t))return t;var i,o;if(e&&"function"==typeof(i=t.toString)&&!r(o=i.call(t)))return o;if("function"==typeof(i=t.valueOf)&&!r(o=i.call(t)))return o;if(!e&&"function"==typeof(i=t.toString)&&!r(o=i.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,i){var r=i(7).f,o=i(12),n=i(0)("toStringTag");t.exports=function(t,e,i){t&&!o(t=i?t:t.prototype,n)&&r(t,n,{configurable:!0,value:e})}},function(t,e,i){var r=i(19),o=i(1),n=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:i(20)?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,i){"use strict";var r=i(5);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,i){"use strict";var r=i(2),o=i(6),n=i(51),s="".endsWith;r(r.P+r.F*i(52)("endsWith"),"String",{endsWith:function(t){var e=n(this,t,"endsWith"),i=arguments.length>1?arguments[1]:void 0,r=o(e.length),a=void 0===i?r:Math.min(o(i),r),l=String(t);return s?s.call(e,l,a):e.slice(a-l.length,a)===l}})},function(t,e,i){var r=i(22),o=Math.max,n=Math.min;t.exports=function(t,e){return(t=r(t))<0?o(t+e,0):n(t,e)}},function(t,e,i){"use strict";var r=i(40),o=i(98),n=i(28),s=i(24);t.exports=i(74)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,o(1)):o(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])},"values"),n.Arguments=n.Array,r("keys"),r("values"),r("entries")},function(t,e,i){var r=i(0)("unscopables"),o=Array.prototype;null==o[r]&&i(9)(o,r,{}),t.exports=function(t){o[r][t]=!0}},function(t,e,i){var r=i(5),o=i(100),n=i(56),s=i(55)("IE_PROTO"),a=function(){},l=function(){var t,e=i(50)("iframe"),r=n.length;for(e.style.display="none",i(75).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;r--;)delete l.prototype[n[r]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=r(t),i=new a,a.prototype=null,i[s]=t):i=l(),void 0===e?i:o(i,e)}},function(t,e,i){"use strict";var r=i(5),o=i(11),n=i(6),s=i(22),a=i(46),l=i(47),d=Math.max,u=Math.min,c=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;i(49)("replace",2,function(t,e,i,f){return[function(r,o){var n=t(this),s=null==r?void 0:r[e];return void 0!==s?s.call(r,n,o):i.call(String(n),r,o)},function(t,e){var o=f(i,t,this,e);if(o.done)return o.value;var c=r(t),h=String(this),p="function"==typeof e;p||(e=String(e));var m=c.global;if(m){var y=c.unicode;c.lastIndex=0}for(var _=[];;){var v=l(c,h);if(null===v)break;if(_.push(v),!m)break;""===String(v[0])&&(c.lastIndex=a(h,n(c.lastIndex),y))}for(var T,S="",E=0,b=0;b<_.length;b++){v=_[b];for(var O=String(v[0]),x=d(u(s(v.index),h.length),0),D=[],I=1;I<v.length;I++)D.push(void 0===(T=v[I])?T:String(T));var A=v.groups;if(p){var R=[O].concat(D,x,h);void 0!==A&&R.push(A);var w=String(e.apply(void 0,R))}else w=g(O,h,x,D,A,e);x>=E&&(S+=h.slice(E,x)+w,E=x+O.length)}return S+h.slice(E)}];function g(t,e,r,n,s,a){var l=r+t.length,d=n.length,u=p;return void 0!==s&&(s=o(s),u=h),i.call(a,u,function(i,o){var a;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(l);case"<":a=s[o.slice(1,-1)];break;default:var u=+o;if(0===u)return i;if(u>d){var h=c(u/10);return 0===h?i:h<=d?void 0===n[h-1]?o.charAt(1):n[h-1]+o.charAt(1):i}a=n[u-1]}return void 0===a?"":a})}})},function(t,e,i){var r=i(33),o=i(27),n=i(24),s=i(32),a=i(12),l=i(72),d=Object.getOwnPropertyDescriptor;e.f=i(4)?d:function(t,e){if(t=n(t),e=s(e,!0),l)try{return d(t,e)}catch(t){}if(a(t,e))return o(!r.f.call(t,e),t[e])}},function(t,e,i){var r=i(8),o=i(18),n=i(0)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==o(t))}},function(t,e,i){var r=i(5),o=i(30),n=i(0)("species");t.exports=function(t,e){var i,s=r(t).constructor;return void 0===s||null==(i=r(s)[n])?e:o(i)}},function(t,e,i){"use strict";var r=i(71)(!0);t.exports=function(t,e,i){return e+(i?r(t,e).length:1)}},function(t,e,i){"use strict";var r=i(31),o=RegExp.prototype.exec;t.exports=function(t,e){var i=t.exec;if("function"==typeof i){var n=i.call(t,e);if("object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,i){"use strict";var r,o,n=i(36),s=RegExp.prototype.exec,a=String.prototype.replace,l=s,d=(r=/a/,o=/b*/g,s.call(r,"a"),s.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),u=void 0!==/()??/.exec("")[1];(d||u)&&(l=function(t){var e,i,r,o,l=this;return u&&(i=new RegExp("^"+l.source+"$(?!\\s)",n.call(l))),d&&(e=l.lastIndex),r=s.call(l,t),d&&r&&(l.lastIndex=l.global?r.index+r[0].length:e),u&&r&&r.length>1&&a.call(r[0],i,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r}),t.exports=l},function(t,e,i){"use strict";i(94);var r=i(10),o=i(9),n=i(3),s=i(26),a=i(0),l=i(48),d=a("species"),u=!n(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),c=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();t.exports=function(t,e,i){var h=a(t),p=!n(function(){var e={};return e[h]=function(){return 7},7!=""[t](e)}),f=p?!n(function(){var e=!1,i=/a/;return i.exec=function(){return e=!0,null},"split"===t&&(i.constructor={},i.constructor[d]=function(){return i}),i[h](""),!e}):void 0;if(!p||!f||"replace"===t&&!u||"split"===t&&!c){var g=/./[h],m=i(s,h,""[t],function(t,e,i,r,o){return e.exec===l?p&&!o?{done:!0,value:g.call(e,i,r)}:{done:!0,value:t.call(i,e,r)}:{done:!1}}),y=m[0],_=m[1];r(String.prototype,t,y),o(RegExp.prototype,h,2==e?function(t,e){return _.call(t,this,e)}:function(t){return _.call(t,this)})}}},function(t,e,i){var r=i(8),o=i(1).document,n=r(o)&&r(o.createElement);t.exports=function(t){return n?o.createElement(t):{}}},function(t,e,i){var r=i(44),o=i(26);t.exports=function(t,e,i){if(r(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(o(t))}},function(t,e,i){var r=i(0)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,i){var r=i(18);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,i){var r=i(24),o=i(6),n=i(38);t.exports=function(t){return function(e,i,s){var a,l=r(e),d=o(l.length),u=n(s,d);if(t&&i!=i){for(;d>u;)if((a=l[u++])!=a)return!0}else for(;d>u;u++)if((t||u in l)&&l[u]===i)return t||u||0;return!t&&-1}}},function(t,e,i){var r=i(35)("keys"),o=i(21);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,i){var r=i(7).f,o=Function.prototype,n=/^\s*function ([^ (]*)/;"name"in o||i(4)&&r(o,"name",{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},function(t,e,i){for(var r=i(39),o=i(23),n=i(10),s=i(1),a=i(9),l=i(28),d=i(0),u=d("iterator"),c=d("toStringTag"),h=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=o(p),g=0;g<f.length;g++){var m,y=f[g],_=p[y],v=s[y],T=v&&v.prototype;if(T&&(T[u]||a(T,u,h),T[c]||a(T,c,y),l[y]=h,_))for(m in r)T[m]||n(T,m,r[m],!0)}},function(t,e,i){"use strict";var r=i(2),o=i(30),n=i(11),s=i(3),a=[].sort,l=[1,2,3];r(r.P+r.F*(s(function(){l.sort(void 0)})||!s(function(){l.sort(null)})||!i(105)(a)),"Array",{sort:function(t){return void 0===t?a.call(n(this)):a.call(n(this),o(t))}})},function(t,e,i){"use strict";var r=i(11),o=i(38),n=i(6);t.exports=function(t){for(var e=r(this),i=n(e.length),s=arguments.length,a=o(s>1?arguments[1]:void 0,i),l=s>2?arguments[2]:void 0,d=void 0===l?i:o(l,i);d>a;)e[a++]=t;return e}},function(t,e,i){"use strict";var r,o,n,s,a=i(20),l=i(1),d=i(14),u=i(31),c=i(2),h=i(8),p=i(30),f=i(63),g=i(110),m=i(45),y=i(85).set,_=i(112)(),v=i(86),T=i(113),S=i(114),E=i(115),b=l.TypeError,O=l.process,x=O&&O.versions,D=x&&x.v8||"",I=l.Promise,A="process"==u(O),R=function(){},w=o=v.f,C=!!function(){try{var t=I.resolve(1),e=(t.constructor={})[i(0)("species")]=function(t){t(R,R)};return(A||"function"==typeof PromiseRejectionEvent)&&t.then(R)instanceof e&&0!==D.indexOf("6.6")&&-1===S.indexOf("Chrome/66")}catch(t){}}(),P=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},B=function(t,e){if(!t._n){t._n=!0;var i=t._c;_(function(){for(var r=t._v,o=1==t._s,n=0,s=function(e){var i,n,s,a=o?e.ok:e.fail,l=e.resolve,d=e.reject,u=e.domain;try{a?(o||(2==t._h&&M(t),t._h=1),!0===a?i=r:(u&&u.enter(),i=a(r),u&&(u.exit(),s=!0)),i===e.promise?d(b("Promise-chain cycle")):(n=P(i))?n.call(i,l,d):l(i)):d(r)}catch(t){u&&!s&&u.exit(),d(t)}};i.length>n;)s(i[n++]);t._c=[],t._n=!1,e&&!t._h&&L(t)})}},L=function(t){y.call(l,function(){var e,i,r,o=t._v,n=N(t);if(n&&(e=T(function(){A?O.emit("unhandledRejection",o,t):(i=l.onunhandledrejection)?i({promise:t,reason:o}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",o)}),t._h=A||N(t)?2:1),t._a=void 0,n&&e.e)throw e.v})},N=function(t){return 1!==t._h&&0===(t._a||t._c).length},M=function(t){y.call(l,function(){var e;A?O.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},q=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),B(e,!0))},F=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw b("Promise can't be resolved itself");(e=P(t))?_(function(){var r={_w:i,_d:!1};try{e.call(t,d(F,r,1),d(q,r,1))}catch(t){q.call(r,t)}}):(i._v=t,i._s=1,B(i,!1))}catch(t){q.call({_w:i,_d:!1},t)}}};C||(I=function(t){f(this,I,"Promise","_h"),p(t),r.call(this);try{t(d(F,this,1),d(q,this,1))}catch(t){q.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(66)(I.prototype,{then:function(t,e){var i=w(m(this,I));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=A?O.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&B(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),n=function(){var t=new r;this.promise=t,this.resolve=d(F,t,1),this.reject=d(q,t,1)},v.f=w=function(t){return t===I||t===s?new n(t):o(t)}),c(c.G+c.W+c.F*!C,{Promise:I}),i(34)(I,"Promise"),i(67)("Promise"),s=i(19).Promise,c(c.S+c.F*!C,"Promise",{reject:function(t){var e=w(this);return(0,e.reject)(t),e.promise}}),c(c.S+c.F*(a||!C),"Promise",{resolve:function(t){return E(a&&this===s?I:this,t)}}),c(c.S+c.F*!(C&&i(68)(function(t){I.all(t).catch(R)})),"Promise",{all:function(t){var e=this,i=w(e),r=i.resolve,o=i.reject,n=T(function(){var i=[],n=0,s=1;g(t,!1,function(t){var a=n++,l=!1;i.push(void 0),s++,e.resolve(t).then(function(t){l||(l=!0,i[a]=t,--s||r(i))},o)}),--s||r(i)});return n.e&&o(n.v),i.promise},race:function(t){var e=this,i=w(e),r=i.reject,o=T(function(){g(t,!1,function(t){e.resolve(t).then(i.resolve,r)})});return o.e&&r(o.v),i.promise}})},function(t,e){t.exports=function(t,e,i,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(i+": incorrect invocation!");return t}},function(t,e,i){var r=i(28),o=i(0)("iterator"),n=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||n[o]===t)}},function(t,e,i){var r=i(31),o=i(0)("iterator"),n=i(28);t.exports=i(19).getIteratorMethod=function(t){if(null!=t)return t[o]||t["@@iterator"]||n[r(t)]}},function(t,e,i){var r=i(10);t.exports=function(t,e,i){for(var o in e)r(t,o,e[o],i);return t}},function(t,e,i){"use strict";var r=i(1),o=i(7),n=i(4),s=i(0)("species");t.exports=function(t){var e=r[t];n&&e&&!e[s]&&o.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,i){var r=i(0)("iterator"),o=!1;try{var n=[7][r]();n.return=function(){o=!0},Array.from(n,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var i=!1;try{var n=[7],s=n[r]();s.next=function(){return{done:i=!0}},n[r]=function(){return s},t(n)}catch(t){}return i}},function(t,e,i){"use strict";var r=i(5),o=i(6),n=i(46),s=i(47);i(49)("match",1,function(t,e,i,a){return[function(i){var r=t(this),o=null==i?void 0:i[e];return void 0!==o?o.call(i,r):new RegExp(i)[e](String(r))},function(t){var e=a(i,t,this);if(e.done)return e.value;var l=r(t),d=String(this);if(!l.global)return s(l,d);var u=l.unicode;l.lastIndex=0;for(var c,h=[],p=0;null!==(c=s(l,d));){var f=String(c[0]);h[p]=f,""===f&&(l.lastIndex=n(d,o(l.lastIndex),u)),p++}return 0===p?null:h}]})},function(t,e,i){"use strict";var r=i(1),o=i(12),n=i(18),s=i(88),a=i(32),l=i(3),d=i(29).f,u=i(43).f,c=i(7).f,h=i(121).trim,p=r.Number,f=p,g=p.prototype,m="Number"==n(i(41)(g)),y="trim"in String.prototype,_=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){var i,r,o,n=(e=y?e.trim():h(e,3)).charCodeAt(0);if(43===n||45===n){if(88===(i=e.charCodeAt(2))||120===i)return NaN}else if(48===n){switch(e.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+e}for(var s,l=e.slice(2),d=0,u=l.length;d<u;d++)if((s=l.charCodeAt(d))<48||s>o)return NaN;return parseInt(l,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof p&&(m?l(function(){g.valueOf.call(i)}):"Number"!=n(i))?s(new f(_(e)),i,p):_(e)};for(var v,T=i(4)?d(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;T.length>S;S++)o(f,v=T[S])&&!o(p,v)&&c(p,v,u(f,v));p.prototype=g,g.constructor=p,i(10)(r,"Number",p)}},function(t,e,i){var r=i(22),o=i(26);t.exports=function(t){return function(e,i){var n,s,a=String(o(e)),l=r(i),d=a.length;return l<0||l>=d?t?"":void 0:(n=a.charCodeAt(l))<55296||n>56319||l+1===d||(s=a.charCodeAt(l+1))<56320||s>57343?t?a.charAt(l):n:t?a.slice(l,l+2):s-56320+(n-55296<<10)+65536}}},function(t,e,i){t.exports=!i(4)&&!i(3)(function(){return 7!=Object.defineProperty(i(50)("div"),"a",{get:function(){return 7}}).a})},function(t,e,i){var r=i(12),o=i(24),n=i(54)(!1),s=i(55)("IE_PROTO");t.exports=function(t,e){var i,a=o(t),l=0,d=[];for(i in a)i!=s&&r(a,i)&&d.push(i);for(;e.length>l;)r(a,i=e[l++])&&(~n(d,i)||d.push(i));return d}},function(t,e,i){"use strict";var r=i(20),o=i(2),n=i(10),s=i(9),a=i(28),l=i(99),d=i(34),u=i(76),c=i(0)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,i,f,g,m,y){l(i,e,f);var _,v,T,S=function(t){if(!h&&t in x)return x[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},E=e+" Iterator",b="values"==g,O=!1,x=t.prototype,D=x[c]||x["@@iterator"]||g&&x[g],I=D||S(g),A=g?b?S("entries"):I:void 0,R="Array"==e&&x.entries||D;if(R&&(T=u(R.call(new t)))!==Object.prototype&&T.next&&(d(T,E,!0),r||"function"==typeof T[c]||s(T,c,p)),b&&D&&"values"!==D.name&&(O=!0,I=function(){return D.call(this)}),r&&!y||!h&&!O&&x[c]||s(x,c,I),a[e]=I,a[E]=p,g)if(_={values:b?I:S("values"),keys:m?I:S("keys"),entries:A},y)for(v in _)v in x||n(x,v,_[v]);else o(o.P+o.F*(h||O),e,_);return _}},function(t,e,i){var r=i(1).document;t.exports=r&&r.documentElement},function(t,e,i){var r=i(12),o=i(11),n=i(55)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,n)?t[n]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,i){var r=i(11),o=i(23);i(101)("keys",function(){return function(t){return o(r(t))}})},function(t,e,i){var r=i(14),o=i(53),n=i(11),s=i(6),a=i(103);t.exports=function(t,e){var i=1==t,l=2==t,d=3==t,u=4==t,c=6==t,h=5==t||c,p=e||a;return function(e,a,f){for(var g,m,y=n(e),_=o(y),v=r(a,f,3),T=s(_.length),S=0,E=i?p(e,T):l?p(e,0):void 0;T>S;S++)if((h||S in _)&&(m=v(g=_[S],S,y),t))if(i)E[S]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return S;case 2:E.push(g)}else if(u)return!1;return c?-1:d||u?u:E}}},function(t,e,i){var r=i(18);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,i){i(81)("asyncIterator")},function(t,e,i){var r=i(1),o=i(19),n=i(20),s=i(82),a=i(7).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=n?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,i){e.f=i(0)},function(t,e,i){"use strict";var r=i(1),o=i(12),n=i(4),s=i(2),a=i(10),l=i(107).KEY,d=i(3),u=i(35),c=i(34),h=i(21),p=i(0),f=i(82),g=i(81),m=i(108),y=i(79),_=i(5),v=i(8),T=i(11),S=i(24),E=i(32),b=i(27),O=i(41),x=i(109),D=i(43),I=i(57),A=i(7),R=i(23),w=D.f,C=A.f,P=x.f,B=r.Symbol,L=r.JSON,N=L&&L.stringify,M=p("_hidden"),q=p("toPrimitive"),F={}.propertyIsEnumerable,k=u("symbol-registry"),U=u("symbols"),H=u("op-symbols"),G=Object.prototype,V="function"==typeof B&&!!I.f,W=r.QObject,Y=!W||!W.prototype||!W.prototype.findChild,X=n&&d(function(){return 7!=O(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(t,e,i){var r=w(G,e);r&&delete G[e],C(t,e,i),r&&t!==G&&C(G,e,r)}:C,j=function(t){var e=U[t]=O(B.prototype);return e._k=t,e},z=V&&"symbol"==typeof B.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof B},J=function(t,e,i){return t===G&&J(H,e,i),_(t),e=E(e,!0),_(i),o(U,e)?(i.enumerable?(o(t,M)&&t[M][e]&&(t[M][e]=!1),i=O(i,{enumerable:b(0,!1)})):(o(t,M)||C(t,M,b(1,{})),t[M][e]=!0),X(t,e,i)):C(t,e,i)},K=function(t,e){_(t);for(var i,r=m(e=S(e)),o=0,n=r.length;n>o;)J(t,i=r[o++],e[i]);return t},Z=function(t){var e=F.call(this,t=E(t,!0));return!(this===G&&o(U,t)&&!o(H,t))&&(!(e||!o(this,t)||!o(U,t)||o(this,M)&&this[M][t])||e)},$=function(t,e){if(t=S(t),e=E(e,!0),t!==G||!o(U,e)||o(H,e)){var i=w(t,e);return!i||!o(U,e)||o(t,M)&&t[M][e]||(i.enumerable=!0),i}},Q=function(t){for(var e,i=P(S(t)),r=[],n=0;i.length>n;)o(U,e=i[n++])||e==M||e==l||r.push(e);return r},tt=function(t){for(var e,i=t===G,r=P(i?H:S(t)),n=[],s=0;r.length>s;)!o(U,e=r[s++])||i&&!o(G,e)||n.push(U[e]);return n};V||(a((B=function(){if(this instanceof B)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(i){this===G&&e.call(H,i),o(this,M)&&o(this[M],t)&&(this[M][t]=!1),X(this,t,b(1,i))};return n&&Y&&X(G,t,{configurable:!0,set:e}),j(t)}).prototype,"toString",function(){return this._k}),D.f=$,A.f=J,i(29).f=x.f=Q,i(33).f=Z,I.f=tt,n&&!i(20)&&a(G,"propertyIsEnumerable",Z,!0),f.f=function(t){return j(p(t))}),s(s.G+s.W+s.F*!V,{Symbol:B});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),it=0;et.length>it;)p(et[it++]);for(var rt=R(p.store),ot=0;rt.length>ot;)g(rt[ot++]);s(s.S+s.F*!V,"Symbol",{for:function(t){return o(k,t+="")?k[t]:k[t]=B(t)},keyFor:function(t){if(!z(t))throw TypeError(t+" is not a symbol!");for(var e in k)if(k[e]===t)return e},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),s(s.S+s.F*!V,"Object",{create:function(t,e){return void 0===e?O(t):K(O(t),e)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:$,getOwnPropertyNames:Q,getOwnPropertySymbols:tt});var nt=d(function(){I.f(1)});s(s.S+s.F*nt,"Object",{getOwnPropertySymbols:function(t){return I.f(T(t))}}),L&&s(s.S+s.F*(!V||d(function(){var t=B();return"[null]"!=N([t])||"{}"!=N({a:t})||"{}"!=N(Object(t))})),"JSON",{stringify:function(t){for(var e,i,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(i=e=r[1],(v(e)||void 0!==t)&&!z(t))return y(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!z(e))return e}),r[1]=e,N.apply(L,r)}}),B.prototype[q]||i(9)(B.prototype,q,B.prototype.valueOf),c(B,"Symbol"),c(Math,"Math",!0),c(r.JSON,"JSON",!0)},function(t,e,i){var r=i(5);t.exports=function(t,e,i,o){try{return o?e(r(i)[0],i[1]):e(i)}catch(e){var n=t.return;throw void 0!==n&&r(n.call(t)),e}}},function(t,e,i){var r,o,n,s=i(14),a=i(111),l=i(75),d=i(50),u=i(1),c=u.process,h=u.setImmediate,p=u.clearImmediate,f=u.MessageChannel,g=u.Dispatch,m=0,y={},_=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},v=function(t){_.call(t.data)};h&&p||(h=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return y[++m]=function(){a("function"==typeof t?t:Function(t),e)},r(m),m},p=function(t){delete y[t]},"process"==i(18)(c)?r=function(t){c.nextTick(s(_,t,1))}:g&&g.now?r=function(t){g.now(s(_,t,1))}:f?(n=(o=new f).port2,o.port1.onmessage=v,r=s(n.postMessage,n,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(t){u.postMessage(t+"","*")},u.addEventListener("message",v,!1)):r="onreadystatechange"in d("script")?function(t){l.appendChild(d("script")).onreadystatechange=function(){l.removeChild(this),_.call(t)}}:function(t){setTimeout(s(_,t,1),0)}),t.exports={set:h,clear:p}},function(t,e,i){"use strict";var r=i(30);t.exports.f=function(t){return new function(t){var e,i;this.promise=new t(function(t,r){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=r}),this.resolve=r(e),this.reject=r(i)}(t)}},function(t,e,i){"use strict";var r=i(2),o=i(6),n=i(51),s="".startsWith;r(r.P+r.F*i(52)("startsWith"),"String",{startsWith:function(t){var e=n(this,t,"startsWith"),i=o(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return s?s.call(e,r,i):e.slice(i,i+r.length)===r}})},function(t,e,i){var r=i(8),o=i(120).set;t.exports=function(t,e,i){var n,s=e.constructor;return s!==i&&"function"==typeof s&&(n=s.prototype)!==i.prototype&&r(n)&&o&&o(t,n),t}},function(t,e,i){var r,o=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function o(t,e){if(!r[t]){r[t]={};for(var i=0;i<t.length;i++)r[t][t.charAt(i)]=i}return r[t][e]}var n={compressToBase64:function(t){if(null==t)return"";var i=n._compress(t,6,function(t){return e.charAt(t)});switch(i.length%4){default:case 0:return i;case 1:return i+"===";case 2:return i+"==";case 3:return i+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:n._decompress(t.length,32,function(i){return o(e,t.charAt(i))})},compressToUTF16:function(e){return null==e?"":n._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:n._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=n.compress(t),i=new Uint8Array(2*e.length),r=0,o=e.length;r<o;r++){var s=e.charCodeAt(r);i[2*r]=s>>>8,i[2*r+1]=s%256}return i},decompressFromUint8Array:function(e){if(null==e)return n.decompress(e);for(var i=new Array(e.length/2),r=0,o=i.length;r<o;r++)i[r]=256*e[2*r]+e[2*r+1];var s=[];return i.forEach(function(e){s.push(t(e))}),n.decompress(s.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":n._compress(t,6,function(t){return i.charAt(t)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),n._decompress(t.length,32,function(e){return o(i,t.charAt(e))}))},compress:function(e){return n._compress(e,16,function(e){return t(e)})},_compress:function(t,e,i){if(null==t)return"";var r,o,n,s={},a={},l="",d="",u="",c=2,h=3,p=2,f=[],g=0,m=0;for(n=0;n<t.length;n+=1)if(l=t.charAt(n),Object.prototype.hasOwnProperty.call(s,l)||(s[l]=h++,a[l]=!0),d=u+l,Object.prototype.hasOwnProperty.call(s,d))u=d;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,m==e-1?(m=0,f.push(i(g)),g=0):m++;for(o=u.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o>>=1}else{for(o=1,r=0;r<p;r++)g=g<<1|o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o=0;for(o=u.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o>>=1}0==--c&&(c=Math.pow(2,p),p++),delete a[u]}else for(o=s[u],r=0;r<p;r++)g=g<<1|1&o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o>>=1;0==--c&&(c=Math.pow(2,p),p++),s[d]=h++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,m==e-1?(m=0,f.push(i(g)),g=0):m++;for(o=u.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o>>=1}else{for(o=1,r=0;r<p;r++)g=g<<1|o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o=0;for(o=u.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o>>=1}0==--c&&(c=Math.pow(2,p),p++),delete a[u]}else for(o=s[u],r=0;r<p;r++)g=g<<1|1&o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o>>=1;0==--c&&(c=Math.pow(2,p),p++)}for(o=2,r=0;r<p;r++)g=g<<1|1&o,m==e-1?(m=0,f.push(i(g)),g=0):m++,o>>=1;for(;;){if(g<<=1,m==e-1){f.push(i(g));break}m++}return f.join("")},decompress:function(t){return null==t?"":""==t?null:n._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,i,r){var o,n,s,a,l,d,u,c=[],h=4,p=4,f=3,g="",m=[],y={val:r(0),position:i,index:1};for(o=0;o<3;o+=1)c[o]=o;for(s=0,l=Math.pow(2,2),d=1;d!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=i,y.val=r(y.index++)),s|=(a>0?1:0)*d,d<<=1;switch(s){case 0:for(s=0,l=Math.pow(2,8),d=1;d!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=i,y.val=r(y.index++)),s|=(a>0?1:0)*d,d<<=1;u=t(s);break;case 1:for(s=0,l=Math.pow(2,16),d=1;d!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=i,y.val=r(y.index++)),s|=(a>0?1:0)*d,d<<=1;u=t(s);break;case 2:return""}for(c[3]=u,n=u,m.push(u);;){if(y.index>e)return"";for(s=0,l=Math.pow(2,f),d=1;d!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=i,y.val=r(y.index++)),s|=(a>0?1:0)*d,d<<=1;switch(u=s){case 0:for(s=0,l=Math.pow(2,8),d=1;d!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=i,y.val=r(y.index++)),s|=(a>0?1:0)*d,d<<=1;c[p++]=t(s),u=p-1,h--;break;case 1:for(s=0,l=Math.pow(2,16),d=1;d!=l;)a=y.val&y.position,y.position>>=1,0==y.position&&(y.position=i,y.val=r(y.index++)),s|=(a>0?1:0)*d,d<<=1;c[p++]=t(s),u=p-1,h--;break;case 2:return m.join("")}if(0==h&&(h=Math.pow(2,f),f++),c[u])g=c[u];else{if(u!==p)return null;g=n+n.charAt(0)}m.push(g),c[p++]=n+g.charAt(0),n=g,0==--h&&(h=Math.pow(2,f),f++)}}};return n}();void 0===(r=function(){return o}.call(e,i,e,t))||(t.exports=r)},function(t,e,i){for(var r,o=i(1),n=i(9),s=i(21),a=s("typed_array"),l=s("view"),d=!(!o.ArrayBuffer||!o.DataView),u=d,c=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");c<9;)(r=o[h[c++]])?(n(r.prototype,a,!0),n(r.prototype,l,!0)):u=!1;t.exports={ABV:d,CONSTR:u,TYPED:a,VIEW:l}},function(t,e,i){var r=i(22),o=i(6);t.exports=function(t){if(void 0===t)return 0;var e=r(t),i=o(e);if(e!==i)throw RangeError("Wrong length!");return i}},function(t,e){t.exports=r;var i=null;try{i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function r(t,e,i){this.low=0|t,this.high=0|e,this.unsigned=!!i}function o(t){return!0===(t&&t.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=o;var n={},s={};function a(t,e){var i,r,o;return e?(o=0<=(t>>>=0)&&t<256)&&(r=s[t])?r:(i=d(t,(0|t)<0?-1:0,!0),o&&(s[t]=i),i):(o=-128<=(t|=0)&&t<128)&&(r=n[t])?r:(i=d(t,t<0?-1:0,!1),o&&(n[t]=i),i)}function l(t,e){if(isNaN(t))return e?_:y;if(e){if(t<0)return _;if(t>=f)return b}else{if(t<=-g)return O;if(t+1>=g)return E}return t<0?l(-t,e).neg():d(t%p|0,t/p|0,e)}function d(t,e,i){return new r(t,e,i)}r.fromInt=a,r.fromNumber=l,r.fromBits=d;var u=Math.pow;function c(t,e,i){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return y;if("number"==typeof e?(i=e,e=!1):e=!!e,(i=i||10)<2||36<i)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(t.substring(1),e,i).neg();for(var o=l(u(i,8)),n=y,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),d=parseInt(t.substring(s,s+a),i);if(a<8){var h=l(u(i,a));n=n.mul(h).add(l(d))}else n=(n=n.mul(o)).add(l(d))}return n.unsigned=e,n}function h(t,e){return"number"==typeof t?l(t,e):"string"==typeof t?c(t,e):d(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}r.fromString=c,r.fromValue=h;var p=4294967296,f=p*p,g=f/2,m=a(1<<24),y=a(0);r.ZERO=y;var _=a(0,!0);r.UZERO=_;var v=a(1);r.ONE=v;var T=a(1,!0);r.UONE=T;var S=a(-1);r.NEG_ONE=S;var E=d(-1,2147483647,!1);r.MAX_VALUE=E;var b=d(-1,-1,!0);r.MAX_UNSIGNED_VALUE=b;var O=d(0,-2147483648,!1);r.MIN_VALUE=O;var x=r.prototype;x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},x.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(O)){var e=l(t),i=this.div(e),r=i.mul(e).sub(this);return i.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var o=l(u(t,6),this.unsigned),n=this,s="";;){var a=n.div(o),d=(n.sub(a.mul(o)).toInt()>>>0).toString(t);if((n=a).isZero())return d+s;for(;d.length<6;)d="0"+d;s=""+d+s}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},x.isZero=function(){return 0===this.high&&0===this.low},x.eqz=x.isZero,x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return 1==(1&this.low)},x.isEven=function(){return 0==(1&this.low)},x.equals=function(t){return o(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},x.eq=x.equals,x.notEquals=function(t){return!this.eq(t)},x.neq=x.notEquals,x.ne=x.notEquals,x.lessThan=function(t){return this.comp(t)<0},x.lt=x.lessThan,x.lessThanOrEqual=function(t){return this.comp(t)<=0},x.lte=x.lessThanOrEqual,x.le=x.lessThanOrEqual,x.greaterThan=function(t){return this.comp(t)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(t){return this.comp(t)>=0},x.gte=x.greaterThanOrEqual,x.ge=x.greaterThanOrEqual,x.compare=function(t){if(o(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add(v)},x.neg=x.negate,x.add=function(t){o(t)||(t=h(t));var e=this.high>>>16,i=65535&this.high,r=this.low>>>16,n=65535&this.low,s=t.high>>>16,a=65535&t.high,l=t.low>>>16,u=0,c=0,p=0,f=0;return p+=(f+=n+(65535&t.low))>>>16,c+=(p+=r+l)>>>16,u+=(c+=i+a)>>>16,u+=e+s,d((p&=65535)<<16|(f&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},x.subtract=function(t){return o(t)||(t=h(t)),this.add(t.neg())},x.sub=x.subtract,x.multiply=function(t){if(this.isZero())return y;if(o(t)||(t=h(t)),i)return d(i.mul(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned);if(t.isZero())return y;if(this.eq(O))return t.isOdd()?O:y;if(t.eq(O))return this.isOdd()?O:y;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return l(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,r=65535&this.high,n=this.low>>>16,s=65535&this.low,a=t.high>>>16,u=65535&t.high,c=t.low>>>16,p=65535&t.low,f=0,g=0,_=0,v=0;return _+=(v+=s*p)>>>16,g+=(_+=n*p)>>>16,_&=65535,g+=(_+=s*c)>>>16,f+=(g+=r*p)>>>16,g&=65535,f+=(g+=n*c)>>>16,g&=65535,f+=(g+=s*u)>>>16,f+=e*p+r*c+n*u+s*a,d((_&=65535)<<16|(v&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},x.mul=x.multiply,x.divide=function(t){if(o(t)||(t=h(t)),t.isZero())throw Error("division by zero");var e,r,n;if(i)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?d((this.unsigned?i.div_u:i.div_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?_:y;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return _;if(t.gt(this.shru(1)))return T;n=_}else{if(this.eq(O))return t.eq(v)||t.eq(S)?O:t.eq(O)?v:(e=this.shr(1).div(t).shl(1)).eq(y)?t.isNegative()?v:S:(r=this.sub(t.mul(e)),n=e.add(r.div(t)));if(t.eq(O))return this.unsigned?_:y;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();n=y}for(r=this;r.gte(t);){e=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(e)/Math.LN2),a=s<=48?1:u(2,s-48),c=l(e),p=c.mul(t);p.isNegative()||p.gt(r);)p=(c=l(e-=a,this.unsigned)).mul(t);c.isZero()&&(c=v),n=n.add(c),r=r.sub(p)}return n},x.div=x.divide,x.modulo=function(t){return o(t)||(t=h(t)),i?d((this.unsigned?i.rem_u:i.rem_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},x.mod=x.modulo,x.rem=x.modulo,x.not=function(){return d(~this.low,~this.high,this.unsigned)},x.and=function(t){return o(t)||(t=h(t)),d(this.low&t.low,this.high&t.high,this.unsigned)},x.or=function(t){return o(t)||(t=h(t)),d(this.low|t.low,this.high|t.high,this.unsigned)},x.xor=function(t){return o(t)||(t=h(t)),d(this.low^t.low,this.high^t.high,this.unsigned)},x.shiftLeft=function(t){return o(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?d(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):d(0,this.low<<t-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(t){return o(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?d(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):d(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(t){if(o(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?d(this.low>>>t|e<<32-t,e>>>t,this.unsigned):d(32===t?e:e>>>t-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.shr_u=x.shiftRightUnsigned,x.toSigned=function(){return this.unsigned?d(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:d(this.low,this.high,!0)},x.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},x.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},r.fromBytes=function(t,e,i){return i?r.fromBytesLE(t,e):r.fromBytesBE(t,e)},r.fromBytesLE=function(t,e){return new r(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},r.fromBytesBE=function(t,e){return new r(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},function(t,e,i){!function(){function e(t){return Math.sqrt(t.x*t.x+t.y*t.y)}var i=function(t){this.handlers=[],this.el=t};function r(t,e){var r=new i(t);return r.add(e),r}i.prototype.add=function(t){this.handlers.push(t)},i.prototype.del=function(t){t||(this.handlers=[]);for(var e=this.handlers.length;e>=0;e--)this.handlers[e]===t&&this.handlers.splice(e,1)},i.prototype.dispatch=function(){for(var t=0,e=this.handlers.length;t<e;t++){var i=this.handlers[t];"function"==typeof i&&i.apply(this.el,arguments)}};var o=function(t,e){this.element="string"==typeof t?document.querySelector(t):t,this.start=this.start.bind(this),this.move=this.move.bind(this),this.end=this.end.bind(this),this.cancel=this.cancel.bind(this),this.element.addEventListener("touchstart",this.start,!1),this.element.addEventListener("touchmove",this.move,!1),this.element.addEventListener("touchend",this.end,!1),this.element.addEventListener("touchcancel",this.cancel,!1),this.preV={x:null,y:null},this.pinchStartLen=null,this.zoom=1,this.isDoubleTap=!1;var i=function(){};this.rotate=r(this.element,e.rotate||i),this.touchStart=r(this.element,e.touchStart||i),this.multipointStart=r(this.element,e.multipointStart||i),this.multipointEnd=r(this.element,e.multipointEnd||i),this.pinch=r(this.element,e.pinch||i),this.swipe=r(this.element,e.swipe||i),this.tap=r(this.element,e.tap||i),this.doubleTap=r(this.element,e.doubleTap||i),this.longTap=r(this.element,e.longTap||i),this.singleTap=r(this.element,e.singleTap||i),this.pressMove=r(this.element,e.pressMove||i),this.twoFingerPressMove=r(this.element,e.twoFingerPressMove||i),this.touchMove=r(this.element,e.touchMove||i),this.touchEnd=r(this.element,e.touchEnd||i),this.touchCancel=r(this.element,e.touchCancel||i),this._cancelAllHandler=this.cancelAll.bind(this),window.addEventListener("scroll",this._cancelAllHandler),this.delta=null,this.last=null,this.now=null,this.tapTimeout=null,this.singleTapTimeout=null,this.longTapTimeout=null,this.swipeTimeout=null,this.x1=this.x2=this.y1=this.y2=null,this.preTapPosition={x:null,y:null}};o.prototype={start:function(t){if(t.touches){this.now=Date.now(),this.x1=t.touches[0].pageX,this.y1=t.touches[0].pageY,this.delta=this.now-(this.last||this.now),this.touchStart.dispatch(t,this.element),null!==this.preTapPosition.x&&(this.isDoubleTap=this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30,this.isDoubleTap&&clearTimeout(this.singleTapTimeout)),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now;var i=this.preV;if(t.touches.length>1){this._cancelLongTap(),this._cancelSingleTap();var r={x:t.touches[1].pageX-this.x1,y:t.touches[1].pageY-this.y1};i.x=r.x,i.y=r.y,this.pinchStartLen=e(i),this.multipointStart.dispatch(t,this.element)}this._preventTap=!1,this.longTapTimeout=setTimeout(function(){this.longTap.dispatch(t,this.element),this._preventTap=!0}.bind(this),750)}},move:function(t){if(t.touches){var i=this.preV,r=t.touches.length,o=t.touches[0].pageX,n=t.touches[0].pageY;if(this.isDoubleTap=!1,r>1){var s=t.touches[1].pageX,a=t.touches[1].pageY,l={x:t.touches[1].pageX-o,y:t.touches[1].pageY-n};null!==i.x&&(this.pinchStartLen>0&&(t.zoom=e(l)/this.pinchStartLen,this.pinch.dispatch(t,this.element)),t.angle=function(t,i){var r=function(t,i){var r=e(t)*e(i);if(0===r)return 0;var o=function(t,e){return t.x*e.x+t.y*e.y}(t,i)/r;return o>1&&(o=1),Math.acos(o)}(t,i);return function(t,e){return t.x*e.y-e.x*t.y}(t,i)>0&&(r*=-1),180*r/Math.PI}(l,i),this.rotate.dispatch(t,this.element)),i.x=l.x,i.y=l.y,null!==this.x2&&null!==this.sx2?(t.deltaX=(o-this.x2+s-this.sx2)/2,t.deltaY=(n-this.y2+a-this.sy2)/2):(t.deltaX=0,t.deltaY=0),this.twoFingerPressMove.dispatch(t,this.element),this.sx2=s,this.sy2=a}else{if(null!==this.x2){t.deltaX=o-this.x2,t.deltaY=n-this.y2;var d=Math.abs(this.x1-this.x2),u=Math.abs(this.y1-this.y2);(d>10||u>10)&&(this._preventTap=!0)}else t.deltaX=0,t.deltaY=0;this.pressMove.dispatch(t,this.element)}this.touchMove.dispatch(t,this.element),this._cancelLongTap(),this.x2=o,this.y2=n,r>1&&t.preventDefault()}},end:function(t){if(t.changedTouches){this._cancelLongTap();var e=this;t.touches.length<2&&(this.multipointEnd.dispatch(t,this.element),this.sx2=this.sy2=null),this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.y1-this.y2)>30?(t.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),this.swipeTimeout=setTimeout(function(){e.swipe.dispatch(t,e.element)},0)):(this.tapTimeout=setTimeout(function(){e._preventTap||e.tap.dispatch(t,e.element),e.isDoubleTap&&(e.doubleTap.dispatch(t,e.element),e.isDoubleTap=!1)},0),e.isDoubleTap||(e.singleTapTimeout=setTimeout(function(){e.singleTap.dispatch(t,e.element)},250))),this.touchEnd.dispatch(t,this.element),this.preV.x=0,this.preV.y=0,this.zoom=1,this.pinchStartLen=null,this.x1=this.x2=this.y1=this.y2=null}},cancelAll:function(){this._preventTap=!0,clearTimeout(this.singleTapTimeout),clearTimeout(this.tapTimeout),clearTimeout(this.longTapTimeout),clearTimeout(this.swipeTimeout)},cancel:function(t){this.cancelAll(),this.touchCancel.dispatch(t,this.element)},_cancelLongTap:function(){clearTimeout(this.longTapTimeout)},_cancelSingleTap:function(){clearTimeout(this.singleTapTimeout)},_swipeDirection:function(t,e,i,r){return Math.abs(t-e)>=Math.abs(i-r)?t-e>0?"Left":"Right":i-r>0?"Up":"Down"},on:function(t,e){this[t]&&this[t].add(e)},off:function(t,e){this[t]&&this[t].del(e)},destroy:function(){return this.singleTapTimeout&&clearTimeout(this.singleTapTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout),this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.swipeTimeout&&clearTimeout(this.swipeTimeout),this.element.removeEventListener("touchstart",this.start),this.element.removeEventListener("touchmove",this.move),this.element.removeEventListener("touchend",this.end),this.element.removeEventListener("touchcancel",this.cancel),this.rotate.del(),this.touchStart.del(),this.multipointStart.del(),this.multipointEnd.del(),this.pinch.del(),this.swipe.del(),this.tap.del(),this.doubleTap.del(),this.longTap.del(),this.singleTap.del(),this.pressMove.del(),this.twoFingerPressMove.del(),this.touchMove.del(),this.touchEnd.del(),this.touchCancel.del(),this.preV=this.pinchStartLen=this.zoom=this.isDoubleTap=this.delta=this.last=this.now=this.tapTimeout=this.singleTapTimeout=this.longTapTimeout=this.swipeTimeout=this.x1=this.x2=this.y1=this.y2=this.preTapPosition=this.rotate=this.touchStart=this.multipointStart=this.multipointEnd=this.pinch=this.swipe=this.tap=this.doubleTap=this.longTap=this.singleTap=this.pressMove=this.touchMove=this.touchEnd=this.touchCancel=this.twoFingerPressMove=null,window.removeEventListener("scroll",this._cancelAllHandler),null}},t.exports=o}()},function(t,e,i){"use strict";var r=i(48);i(2)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(t,e,i){t.exports=i(35)("native-function-to-string",Function.toString)},function(t,e,i){"use strict";var r=i(4),o=i(23),n=i(57),s=i(33),a=i(11),l=i(53),d=Object.assign;t.exports=!d||i(3)(function(){var t={},e={},i=Symbol(),r="abcdefghijklmnopqrst";return t[i]=7,r.split("").forEach(function(t){e[t]=t}),7!=d({},t)[i]||Object.keys(d({},e)).join("")!=r})?function(t,e){for(var i=a(t),d=arguments.length,u=1,c=n.f,h=s.f;d>u;)for(var p,f=l(arguments[u++]),g=c?o(f).concat(c(f)):o(f),m=g.length,y=0;m>y;)p=g[y++],r&&!h.call(f,p)||(i[p]=f[p]);return i}:d},function(t,e,i){i(4)&&"g"!=/./g.flags&&i(7).f(RegExp.prototype,"flags",{configurable:!0,get:i(36)})},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,i){"use strict";var r=i(41),o=i(27),n=i(34),s={};i(9)(s,i(0)("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=r(s,{next:o(1,i)}),n(t,e+" Iterator")}},function(t,e,i){var r=i(7),o=i(5),n=i(23);t.exports=i(4)?Object.defineProperties:function(t,e){o(t);for(var i,s=n(e),a=s.length,l=0;a>l;)r.f(t,i=s[l++],e[i]);return t}},function(t,e,i){var r=i(2),o=i(19),n=i(3);t.exports=function(t,e){var i=(o.Object||{})[t]||Object[t],s={};s[t]=e(i),r(r.S+r.F*n(function(){i(1)}),"Object",s)}},function(t,e,i){"use strict";var r=i(2),o=i(78)(5),n=!0;"find"in[]&&Array(1).find(function(){n=!1}),r(r.P+r.F*n,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i(40)("find")},function(t,e,i){var r=i(104);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,i){var r=i(8),o=i(79),n=i(0)("species");t.exports=function(t){var e;return o(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!o(e.prototype)||(e=void 0),r(e)&&null===(e=e[n])&&(e=void 0)),void 0===e?Array:e}},function(t,e,i){"use strict";var r=i(3);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,i){var r=i(2);r(r.P,"Array",{fill:i(61)}),i(40)("fill")},function(t,e,i){var r=i(21)("meta"),o=i(8),n=i(12),s=i(7).f,a=0,l=Object.isExtensible||function(){return!0},d=!i(3)(function(){return l(Object.preventExtensions({}))}),u=function(t){s(t,r,{value:{i:"O"+ ++a,w:{}}})},c=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!n(t,r)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[r].i},getWeak:function(t,e){if(!n(t,r)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[r].w},onFreeze:function(t){return d&&c.NEED&&l(t)&&!n(t,r)&&u(t),t}}},function(t,e,i){var r=i(23),o=i(57),n=i(33);t.exports=function(t){var e=r(t),i=o.f;if(i)for(var s,a=i(t),l=n.f,d=0;a.length>d;)l.call(t,s=a[d++])&&e.push(s);return e}},function(t,e,i){var r=i(24),o=i(29).f,n={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==n.call(t)?function(t){try{return o(t)}catch(t){return s.slice()}}(t):o(r(t))}},function(t,e,i){var r=i(14),o=i(84),n=i(64),s=i(5),a=i(6),l=i(65),d={},u={};(e=t.exports=function(t,e,i,c,h){var p,f,g,m,y=h?function(){return t}:l(t),_=r(i,c,e?2:1),v=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(n(y)){for(p=a(t.length);p>v;v++)if((m=e?_(s(f=t[v])[0],f[1]):_(t[v]))===d||m===u)return m}else for(g=y.call(t);!(f=g.next()).done;)if((m=o(g,_,f.value,e))===d||m===u)return m}).BREAK=d,e.RETURN=u},function(t,e){t.exports=function(t,e,i){var r=void 0===i;switch(e.length){case 0:return r?t():t.call(i);case 1:return r?t(e[0]):t.call(i,e[0]);case 2:return r?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},function(t,e,i){var r=i(1),o=i(85).set,n=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,l="process"==i(18)(s);t.exports=function(){var t,e,i,d=function(){var r,o;for(l&&(r=s.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?i():e=void 0,r}}e=void 0,r&&r.enter()};if(l)i=function(){s.nextTick(d)};else if(!n||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0);i=function(){u.then(d)}}else i=function(){o.call(r,d)};else{var c=!0,h=document.createTextNode("");new n(d).observe(h,{characterData:!0}),i=function(){h.data=c=!c}}return function(r){var o={fn:r,next:void 0};e&&(e.next=o),t||(t=o,i()),e=o}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,i){var r=i(1).navigator;t.exports=r&&r.userAgent||""},function(t,e,i){var r=i(5),o=i(8),n=i(86);t.exports=function(t,e){if(r(t),o(e)&&e.constructor===t)return e;var i=n.f(t);return(0,i.resolve)(e),i.promise}},function(t,e,i){"use strict";var r=i(2),o=i(54)(!0);r(r.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i(40)("includes")},function(t,e,i){"use strict";var r=i(2),o=i(51);r(r.P+r.F*i(52)("includes"),"String",{includes:function(t){return!!~o(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,i){var r=i(2),o=i(119)(!1);r(r.S,"Object",{values:function(t){return o(t)}})},function(t,e,i){var r=i(4),o=i(23),n=i(24),s=i(33).f;t.exports=function(t){return function(e){for(var i,a=n(e),l=o(a),d=l.length,u=0,c=[];d>u;)i=l[u++],r&&!s.call(a,i)||c.push(t?[i,a[i]]:a[i]);return c}}},function(t,e,i){var r=i(8),o=i(5),n=function(t,e){if(o(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=i(14)(Function.call,i(43).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return n(t,i),e?t.__proto__=i:r(t,i),t}}({},!1):void 0),check:n}},function(t,e,i){var r=i(2),o=i(26),n=i(3),s=i(122),a="["+s+"]",l=RegExp("^"+a+a+"*"),d=RegExp(a+a+"*$"),u=function(t,e,i){var o={},a=n(function(){return!!s[t]()||"âÂ"!="âÂ"[t]()}),l=o[t]=a?e(c):s[t];i&&(o[i]=l),r(r.P+r.F*a,"String",o)},c=u.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(d,"")),t};t.exports=u},function(t,e){t.exports="\t\n\v\f\r Â áá ââââââââââââ¯âã\u2028\u2029\ufeff"},function(t,e,i){"use strict";var r=i(71)(!0);i(74)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=r(e,i),this._i+=t.length,{value:t,done:!1})})},function(t,e,i){"use strict";var r=i(14),o=i(2),n=i(11),s=i(84),a=i(64),l=i(6),d=i(125),u=i(65);o(o.S+o.F*!i(68)(function(t){Array.from(t)}),"Array",{from:function(t){var e,i,o,c,h=n(t),p="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,m=void 0!==g,y=0,_=u(h);if(m&&(g=r(g,f>2?arguments[2]:void 0,2)),null==_||p==Array&&a(_))for(i=new p(e=l(h.length));e>y;y++)d(i,y,m?g(h[y],y):h[y]);else for(c=_.call(h),i=new p;!(o=c.next()).done;y++)d(i,y,m?s(c,g,[o.value,y],!0):o.value);return i.length=y,i}})},function(t,e,i){"use strict";var r=i(7),o=i(27);t.exports=function(t,e,i){e in t?r.f(t,e,o(0,i)):t[e]=i}},function(t,e,i){var r=i(2),o=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var i,r,n=0,s=0,a=arguments.length,l=0;s<a;)l<(i=o(arguments[s++]))?(n=n*(r=l/i)*r+1,l=i):n+=i>0?(r=i/l)*r:i;return l===1/0?1/0:l*Math.sqrt(n)}})},function(t,e,i){var r=i(1),o=i(88),n=i(7).f,s=i(29).f,a=i(44),l=i(36),d=r.RegExp,u=d,c=d.prototype,h=/a/g,p=/a/g,f=new d(h)!==h;if(i(4)&&(!f||i(3)(function(){return p[i(0)("match")]=!1,d(h)!=h||d(p)==p||"/a/i"!=d(h,"i")}))){d=function(t,e){var i=this instanceof d,r=a(t),n=void 0===e;return!i&&r&&t.constructor===d&&n?t:o(f?new u(r&&!n?t.source:t,e):u((r=t instanceof d)?t.source:t,r&&n?l.call(t):e),i?this:c,d)};for(var g=function(t){t in d||n(d,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},m=s(u),y=0;m.length>y;)g(m[y++]);c.constructor=d,d.prototype=c,i(10)(r,"RegExp",d)}i(67)("RegExp")},function(t,e,i){i(129)("Uint8",1,function(t){return function(e,i,r){return t(this,e,i,r)}})},function(t,e,i){"use strict";if(i(4)){var r=i(20),o=i(1),n=i(3),s=i(2),a=i(90),l=i(130),d=i(14),u=i(63),c=i(27),h=i(9),p=i(66),f=i(22),g=i(6),m=i(91),y=i(38),_=i(32),v=i(12),T=i(31),S=i(8),E=i(11),b=i(64),O=i(41),x=i(76),D=i(29).f,I=i(65),A=i(21),R=i(0),w=i(78),C=i(54),P=i(45),B=i(39),L=i(28),N=i(68),M=i(67),q=i(61),F=i(131),k=i(7),U=i(43),H=k.f,G=U.f,V=o.RangeError,W=o.TypeError,Y=o.Uint8Array,X=Array.prototype,j=l.ArrayBuffer,z=l.DataView,J=w(0),K=w(2),Z=w(3),$=w(4),Q=w(5),tt=w(6),et=C(!0),it=C(!1),rt=B.values,ot=B.keys,nt=B.entries,st=X.lastIndexOf,at=X.reduce,lt=X.reduceRight,dt=X.join,ut=X.sort,ct=X.slice,ht=X.toString,pt=X.toLocaleString,ft=R("iterator"),gt=R("toStringTag"),mt=A("typed_constructor"),yt=A("def_constructor"),_t=a.CONSTR,vt=a.TYPED,Tt=a.VIEW,St=w(1,function(t,e){return Dt(P(t,t[yt]),e)}),Et=n(function(){return 1===new Y(new Uint16Array([1]).buffer)[0]}),bt=!!Y&&!!Y.prototype.set&&n(function(){new Y(1).set({})}),Ot=function(t,e){var i=f(t);if(i<0||i%e)throw V("Wrong offset!");return i},xt=function(t){if(S(t)&&vt in t)return t;throw W(t+" is not a typed array!")},Dt=function(t,e){if(!(S(t)&&mt in t))throw W("It is not a typed array constructor!");return new t(e)},It=function(t,e){return At(P(t,t[yt]),e)},At=function(t,e){for(var i=0,r=e.length,o=Dt(t,r);r>i;)o[i]=e[i++];return o},Rt=function(t,e,i){H(t,e,{get:function(){return this._d[i]}})},wt=function(t){var e,i,r,o,n,s,a=E(t),l=arguments.length,u=l>1?arguments[1]:void 0,c=void 0!==u,h=I(a);if(null!=h&&!b(h)){for(s=h.call(a),r=[],e=0;!(n=s.next()).done;e++)r.push(n.value);a=r}for(c&&l>2&&(u=d(u,arguments[2],2)),e=0,i=g(a.length),o=Dt(this,i);i>e;e++)o[e]=c?u(a[e],e):a[e];return o},Ct=function(){for(var t=0,e=arguments.length,i=Dt(this,e);e>t;)i[t]=arguments[t++];return i},Pt=!!Y&&n(function(){pt.call(new Y(1))}),Bt=function(){return pt.apply(Pt?ct.call(xt(this)):xt(this),arguments)},Lt={copyWithin:function(t,e){return F.call(xt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return $(xt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return q.apply(xt(this),arguments)},filter:function(t){return It(this,K(xt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Q(xt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(xt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){J(xt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return it(xt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(xt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return dt.apply(xt(this),arguments)},lastIndexOf:function(t){return st.apply(xt(this),arguments)},map:function(t){return St(xt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return at.apply(xt(this),arguments)},reduceRight:function(t){return lt.apply(xt(this),arguments)},reverse:function(){for(var t,e=xt(this).length,i=Math.floor(e/2),r=0;r<i;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return Z(xt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ut.call(xt(this),t)},subarray:function(t,e){var i=xt(this),r=i.length,o=y(t,r);return new(P(i,i[yt]))(i.buffer,i.byteOffset+o*i.BYTES_PER_ELEMENT,g((void 0===e?r:y(e,r))-o))}},Nt=function(t,e){return It(this,ct.call(xt(this),t,e))},Mt=function(t){xt(this);var e=Ot(arguments[1],1),i=this.length,r=E(t),o=g(r.length),n=0;if(o+e>i)throw V("Wrong length!");for(;n<o;)this[e+n]=r[n++]},qt={entries:function(){return nt.call(xt(this))},keys:function(){return ot.call(xt(this))},values:function(){return rt.call(xt(this))}},Ft=function(t,e){return S(t)&&t[vt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},kt=function(t,e){return Ft(t,e=_(e,!0))?c(2,t[e]):G(t,e)},Ut=function(t,e,i){return!(Ft(t,e=_(e,!0))&&S(i)&&v(i,"value"))||v(i,"get")||v(i,"set")||i.configurable||v(i,"writable")&&!i.writable||v(i,"enumerable")&&!i.enumerable?H(t,e,i):(t[e]=i.value,t)};_t||(U.f=kt,k.f=Ut),s(s.S+s.F*!_t,"Object",{getOwnPropertyDescriptor:kt,defineProperty:Ut}),n(function(){ht.call({})})&&(ht=pt=function(){return dt.call(this)});var Ht=p({},Lt);p(Ht,qt),h(Ht,ft,qt.values),p(Ht,{slice:Nt,set:Mt,constructor:function(){},toString:ht,toLocaleString:Bt}),Rt(Ht,"buffer","b"),Rt(Ht,"byteOffset","o"),Rt(Ht,"byteLength","l"),Rt(Ht,"length","e"),H(Ht,gt,{get:function(){return this[vt]}}),t.exports=function(t,e,i,l){var d=t+((l=!!l)?"Clamped":"")+"Array",c="get"+t,p="set"+t,f=o[d],y=f||{},_=f&&x(f),v=!f||!a.ABV,E={},b=f&&f.prototype,I=function(t,i){H(t,i,{get:function(){return function(t,i){var r=t._d;return r.v[c](i*e+r.o,Et)}(this,i)},set:function(t){return function(t,i,r){var o=t._d;l&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),o.v[p](i*e+o.o,r,Et)}(this,i,t)},enumerable:!0})};v?(f=i(function(t,i,r,o){u(t,f,d,"_d");var n,s,a,l,c=0,p=0;if(S(i)){if(!(i instanceof j||"ArrayBuffer"==(l=T(i))||"SharedArrayBuffer"==l))return vt in i?At(f,i):wt.call(f,i);n=i,p=Ot(r,e);var y=i.byteLength;if(void 0===o){if(y%e)throw V("Wrong length!");if((s=y-p)<0)throw V("Wrong length!")}else if((s=g(o)*e)+p>y)throw V("Wrong length!");a=s/e}else a=m(i),n=new j(s=a*e);for(h(t,"_d",{b:n,o:p,l:s,e:a,v:new z(n)});c<a;)I(t,c++)}),b=f.prototype=O(Ht),h(b,"constructor",f)):n(function(){f(1)})&&n(function(){new f(-1)})&&N(function(t){new f,new f(null),new f(1.5),new f(t)},!0)||(f=i(function(t,i,r,o){var n;return u(t,f,d),S(i)?i instanceof j||"ArrayBuffer"==(n=T(i))||"SharedArrayBuffer"==n?void 0!==o?new y(i,Ot(r,e),o):void 0!==r?new y(i,Ot(r,e)):new y(i):vt in i?At(f,i):wt.call(f,i):new y(m(i))}),J(_!==Function.prototype?D(y).concat(D(_)):D(y),function(t){t in f||h(f,t,y[t])}),f.prototype=b,r||(b.constructor=f));var A=b[ft],R=!!A&&("values"==A.name||null==A.name),w=qt.values;h(f,mt,!0),h(b,vt,d),h(b,Tt,!0),h(b,yt,f),(l?new f(1)[gt]==d:gt in b)||H(b,gt,{get:function(){return d}}),E[d]=f,s(s.G+s.W+s.F*(f!=y),E),s(s.S,d,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*n(function(){y.of.call(f,1)}),d,{from:wt,of:Ct}),"BYTES_PER_ELEMENT"in b||h(b,"BYTES_PER_ELEMENT",e),s(s.P,d,Lt),M(d),s(s.P+s.F*bt,d,{set:Mt}),s(s.P+s.F*!R,d,qt),r||b.toString==ht||(b.toString=ht),s(s.P+s.F*n(function(){new f(1).slice()}),d,{slice:Nt}),s(s.P+s.F*(n(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!n(function(){b.toLocaleString.call([1,2])})),d,{toLocaleString:Bt}),L[d]=R?A:w,r||R||h(b,ft,w)}}else t.exports=function(){}},function(t,e,i){"use strict";var r=i(1),o=i(4),n=i(20),s=i(90),a=i(9),l=i(66),d=i(3),u=i(63),c=i(22),h=i(6),p=i(91),f=i(29).f,g=i(7).f,m=i(61),y=i(34),_="prototype",v="Wrong index!",T=r.ArrayBuffer,S=r.DataView,E=r.Math,b=r.RangeError,O=r.Infinity,x=T,D=E.abs,I=E.pow,A=E.floor,R=E.log,w=E.LN2,C=o?"_b":"buffer",P=o?"_l":"byteLength",B=o?"_o":"byteOffset";function L(t,e,i){var r,o,n,s=new Array(i),a=8*i-e-1,l=(1<<a)-1,d=l>>1,u=23===e?I(2,-24)-I(2,-77):0,c=0,h=t<0||0===t&&1/t<0?1:0;for((t=D(t))!=t||t===O?(o=t!=t?1:0,r=l):(r=A(R(t)/w),t*(n=I(2,-r))<1&&(r--,n*=2),(t+=r+d>=1?u/n:u*I(2,1-d))*n>=2&&(r++,n/=2),r+d>=l?(o=0,r=l):r+d>=1?(o=(t*n-1)*I(2,e),r+=d):(o=t*I(2,d-1)*I(2,e),r=0));e>=8;s[c++]=255&o,o/=256,e-=8);for(r=r<<e|o,a+=e;a>0;s[c++]=255&r,r/=256,a-=8);return s[--c]|=128*h,s}function N(t,e,i){var r,o=8*i-e-1,n=(1<<o)-1,s=n>>1,a=o-7,l=i-1,d=t[l--],u=127&d;for(d>>=7;a>0;u=256*u+t[l],l--,a-=8);for(r=u&(1<<-a)-1,u>>=-a,a+=e;a>0;r=256*r+t[l],l--,a-=8);if(0===u)u=1-s;else{if(u===n)return r?NaN:d?-O:O;r+=I(2,e),u-=s}return(d?-1:1)*r*I(2,u-e)}function M(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function q(t){return[255&t]}function F(t){return[255&t,t>>8&255]}function k(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function U(t){return L(t,52,8)}function H(t){return L(t,23,4)}function G(t,e,i){g(t[_],e,{get:function(){return this[i]}})}function V(t,e,i,r){var o=p(+i);if(o+e>t[P])throw b(v);var n=t[C]._b,s=o+t[B],a=n.slice(s,s+e);return r?a:a.reverse()}function W(t,e,i,r,o,n){var s=p(+i);if(s+e>t[P])throw b(v);for(var a=t[C]._b,l=s+t[B],d=r(+o),u=0;u<e;u++)a[l+u]=d[n?u:e-u-1]}if(s.ABV){if(!d(function(){T(1)})||!d(function(){new T(-1)})||d(function(){return new T,new T(1.5),new T(NaN),"ArrayBuffer"!=T.name})){for(var Y,X=(T=function(t){return u(this,T),new x(p(t))})[_]=x[_],j=f(x),z=0;j.length>z;)(Y=j[z++])in T||a(T,Y,x[Y]);n||(X.constructor=T)}var J=new S(new T(2)),K=S[_].setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||l(S[_],{setInt8:function(t,e){K.call(this,t,e<<24>>24)},setUint8:function(t,e){K.call(this,t,e<<24>>24)}},!0)}else T=function(t){u(this,T,"ArrayBuffer");var e=p(t);this._b=m.call(new Array(e),0),this[P]=e},S=function(t,e,i){u(this,S,"DataView"),u(t,T,"DataView");var r=t[P],o=c(e);if(o<0||o>r)throw b("Wrong offset!");if(o+(i=void 0===i?r-o:h(i))>r)throw b("Wrong length!");this[C]=t,this[B]=o,this[P]=i},o&&(G(T,"byteLength","_l"),G(S,"buffer","_b"),G(S,"byteLength","_l"),G(S,"byteOffset","_o")),l(S[_],{getInt8:function(t){return V(this,1,t)[0]<<24>>24},getUint8:function(t){return V(this,1,t)[0]},getInt16:function(t){var e=V(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=V(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return M(V(this,4,t,arguments[1]))},getUint32:function(t){return M(V(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return N(V(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return N(V(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){W(this,1,t,q,e)},setUint8:function(t,e){W(this,1,t,q,e)},setInt16:function(t,e){W(this,2,t,F,e,arguments[2])},setUint16:function(t,e){W(this,2,t,F,e,arguments[2])},setInt32:function(t,e){W(this,4,t,k,e,arguments[2])},setUint32:function(t,e){W(this,4,t,k,e,arguments[2])},setFloat32:function(t,e){W(this,4,t,H,e,arguments[2])},setFloat64:function(t,e){W(this,8,t,U,e,arguments[2])}});y(T,"ArrayBuffer"),y(S,"DataView"),a(S[_],s.VIEW,!0),e.ArrayBuffer=T,e.DataView=S},function(t,e,i){"use strict";var r=i(11),o=i(38),n=i(6);t.exports=[].copyWithin||function(t,e){var i=r(this),s=n(i.length),a=o(t,s),l=o(e,s),d=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===d?s:o(d,s))-l,s-a),c=1;for(l<a&&a<l+u&&(c=-1,l+=u-1,a+=u-1);u-- >0;)l in i?i[a]=i[l]:delete i[a],a+=c,l+=c;return i}},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;
/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.7.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.7.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(135),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t){return function(e){return new Md5(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Md5},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var i=OUTPUT_TYPES[e];t[i]=createOutputMethod(i)}return t},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("md5").update(t,"utf8").digest("hex");if(null==t)throw ERROR;return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer?crypto.createHash("md5").update(new Buffer(t)).digest("hex"):method(t)};return nodeMethod};function Md5(t){if(t)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var e=new ArrayBuffer(68);this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(t){if(!this.finalized){var e,i=typeof t;if("string"!==i){if("object"!==i)throw ERROR;if(null===t)throw ERROR;if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||ARRAY_BUFFER&&ArrayBuffer.isView(t)))throw ERROR;e=!0}for(var r,o,n=0,s=t.length,a=this.blocks,l=this.buffer8;n<s;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)if(ARRAY_BUFFER)for(o=this.start;n<s&&o<64;++n)l[o++]=t[n];else for(o=this.start;n<s&&o<64;++n)a[o>>2]|=t[n]<<SHIFT[3&o++];else if(ARRAY_BUFFER)for(o=this.start;n<s&&o<64;++n)(r=t.charCodeAt(n))<128?l[o++]=r:r<2048?(l[o++]=192|r>>6,l[o++]=128|63&r):r<55296||r>=57344?(l[o++]=224|r>>12,l[o++]=128|r>>6&63,l[o++]=128|63&r):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++n)),l[o++]=240|r>>18,l[o++]=128|r>>12&63,l[o++]=128|r>>6&63,l[o++]=128|63&r);else for(o=this.start;n<s&&o<64;++n)(r=t.charCodeAt(n))<128?a[o>>2]|=r<<SHIFT[3&o++]:r<2048?(a[o>>2]|=(192|r>>6)<<SHIFT[3&o++],a[o>>2]|=(128|63&r)<<SHIFT[3&o++]):r<55296||r>=57344?(a[o>>2]|=(224|r>>12)<<SHIFT[3&o++],a[o>>2]|=(128|r>>6&63)<<SHIFT[3&o++],a[o>>2]|=(128|63&r)<<SHIFT[3&o++]):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++n)),a[o>>2]|=(240|r>>18)<<SHIFT[3&o++],a[o>>2]|=(128|r>>12&63)<<SHIFT[3&o++],a[o>>2]|=(128|r>>6&63)<<SHIFT[3&o++],a[o>>2]|=(128|63&r)<<SHIFT[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[e>>2]|=EXTRA[3&e],e>=56&&(this.hashed||this.hash(),t[0]=t[16],t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.bytes<<3,t[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var t,e,i,r,o,n,s=this.blocks;this.first?e=((e=((t=((t=s[0]-680876937)<<7|t>>>25)-271733879<<0)^(i=((i=(-271733879^(r=((r=(-1732584194^2004318071&t)+s[1]-117830708)<<12|r>>>20)+t<<0)&(-271733879^t))+s[2]-1126478375)<<17|i>>>15)+r<<0)&(r^t))+s[3]-1316259209)<<22|e>>>10)+i<<0:(t=this.h0,e=this.h1,i=this.h2,e=((e+=((t=((t+=((r=this.h3)^e&(i^r))+s[0]-680876936)<<7|t>>>25)+e<<0)^(i=((i+=(e^(r=((r+=(i^t&(e^i))+s[1]-389564586)<<12|r>>>20)+t<<0)&(t^e))+s[2]+606105819)<<17|i>>>15)+r<<0)&(r^t))+s[3]-1044525330)<<22|e>>>10)+i<<0),e=((e+=((t=((t+=(r^e&(i^r))+s[4]-176418897)<<7|t>>>25)+e<<0)^(i=((i+=(e^(r=((r+=(i^t&(e^i))+s[5]+1200080426)<<12|r>>>20)+t<<0)&(t^e))+s[6]-1473231341)<<17|i>>>15)+r<<0)&(r^t))+s[7]-45705983)<<22|e>>>10)+i<<0,e=((e+=((t=((t+=(r^e&(i^r))+s[8]+1770035416)<<7|t>>>25)+e<<0)^(i=((i+=(e^(r=((r+=(i^t&(e^i))+s[9]-1958414417)<<12|r>>>20)+t<<0)&(t^e))+s[10]-42063)<<17|i>>>15)+r<<0)&(r^t))+s[11]-1990404162)<<22|e>>>10)+i<<0,e=((e+=((t=((t+=(r^e&(i^r))+s[12]+1804603682)<<7|t>>>25)+e<<0)^(i=((i+=(e^(r=((r+=(i^t&(e^i))+s[13]-40341101)<<12|r>>>20)+t<<0)&(t^e))+s[14]-1502002290)<<17|i>>>15)+r<<0)&(r^t))+s[15]+1236535329)<<22|e>>>10)+i<<0,e=((e+=((r=((r+=(e^i&((t=((t+=(i^r&(e^i))+s[1]-165796510)<<5|t>>>27)+e<<0)^e))+s[6]-1069501632)<<9|r>>>23)+t<<0)^t&((i=((i+=(t^e&(r^t))+s[11]+643717713)<<14|i>>>18)+r<<0)^r))+s[0]-373897302)<<20|e>>>12)+i<<0,e=((e+=((r=((r+=(e^i&((t=((t+=(i^r&(e^i))+s[5]-701558691)<<5|t>>>27)+e<<0)^e))+s[10]+38016083)<<9|r>>>23)+t<<0)^t&((i=((i+=(t^e&(r^t))+s[15]-660478335)<<14|i>>>18)+r<<0)^r))+s[4]-405537848)<<20|e>>>12)+i<<0,e=((e+=((r=((r+=(e^i&((t=((t+=(i^r&(e^i))+s[9]+568446438)<<5|t>>>27)+e<<0)^e))+s[14]-1019803690)<<9|r>>>23)+t<<0)^t&((i=((i+=(t^e&(r^t))+s[3]-187363961)<<14|i>>>18)+r<<0)^r))+s[8]+1163531501)<<20|e>>>12)+i<<0,e=((e+=((r=((r+=(e^i&((t=((t+=(i^r&(e^i))+s[13]-1444681467)<<5|t>>>27)+e<<0)^e))+s[2]-51403784)<<9|r>>>23)+t<<0)^t&((i=((i+=(t^e&(r^t))+s[7]+1735328473)<<14|i>>>18)+r<<0)^r))+s[12]-1926607734)<<20|e>>>12)+i<<0,e=((e+=((n=(r=((r+=((o=e^i)^(t=((t+=(o^r)+s[5]-378558)<<4|t>>>28)+e<<0))+s[8]-2022574463)<<11|r>>>21)+t<<0)^t)^(i=((i+=(n^e)+s[11]+1839030562)<<16|i>>>16)+r<<0))+s[14]-35309556)<<23|e>>>9)+i<<0,e=((e+=((n=(r=((r+=((o=e^i)^(t=((t+=(o^r)+s[1]-1530992060)<<4|t>>>28)+e<<0))+s[4]+1272893353)<<11|r>>>21)+t<<0)^t)^(i=((i+=(n^e)+s[7]-155497632)<<16|i>>>16)+r<<0))+s[10]-1094730640)<<23|e>>>9)+i<<0,e=((e+=((n=(r=((r+=((o=e^i)^(t=((t+=(o^r)+s[13]+681279174)<<4|t>>>28)+e<<0))+s[0]-358537222)<<11|r>>>21)+t<<0)^t)^(i=((i+=(n^e)+s[3]-722521979)<<16|i>>>16)+r<<0))+s[6]+76029189)<<23|e>>>9)+i<<0,e=((e+=((n=(r=((r+=((o=e^i)^(t=((t+=(o^r)+s[9]-640364487)<<4|t>>>28)+e<<0))+s[12]-421815835)<<11|r>>>21)+t<<0)^t)^(i=((i+=(n^e)+s[15]+530742520)<<16|i>>>16)+r<<0))+s[2]-995338651)<<23|e>>>9)+i<<0,e=((e+=((r=((r+=(e^((t=((t+=(i^(e|~r))+s[0]-198630844)<<6|t>>>26)+e<<0)|~i))+s[7]+1126891415)<<10|r>>>22)+t<<0)^((i=((i+=(t^(r|~e))+s[14]-1416354905)<<15|i>>>17)+r<<0)|~t))+s[5]-57434055)<<21|e>>>11)+i<<0,e=((e+=((r=((r+=(e^((t=((t+=(i^(e|~r))+s[12]+1700485571)<<6|t>>>26)+e<<0)|~i))+s[3]-1894986606)<<10|r>>>22)+t<<0)^((i=((i+=(t^(r|~e))+s[10]-1051523)<<15|i>>>17)+r<<0)|~t))+s[1]-2054922799)<<21|e>>>11)+i<<0,e=((e+=((r=((r+=(e^((t=((t+=(i^(e|~r))+s[8]+1873313359)<<6|t>>>26)+e<<0)|~i))+s[15]-30611744)<<10|r>>>22)+t<<0)^((i=((i+=(t^(r|~e))+s[6]-1560198380)<<15|i>>>17)+r<<0)|~t))+s[13]+1309151649)<<21|e>>>11)+i<<0,e=((e+=((r=((r+=(e^((t=((t+=(i^(e|~r))+s[4]-145523070)<<6|t>>>26)+e<<0)|~i))+s[11]-1120210379)<<10|r>>>22)+t<<0)^((i=((i+=(t^(r|~e))+s[2]+718787259)<<15|i>>>17)+r<<0)|~t))+s[9]-343485551)<<21|e>>>11)+i<<0,this.first?(this.h0=t+1732584193<<0,this.h1=e-271733879<<0,this.h2=i-1732584194<<0,this.h3=r+271733878<<0,this.first=!1):(this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+i<<0,this.h3=this.h3+r<<0)},Md5.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,r=this.h3;return HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,r=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(16),e=new Uint32Array(t);return e[0]=this.h0,e[1]=this.h1,e[2]=this.h2,e[3]=this.h3,t},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var t,e,i,r="",o=this.array(),n=0;n<15;)t=o[n++],e=o[n++],i=o[n++],r+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[63&(t<<4|e>>>4)]+BASE64_ENCODE_CHAR[63&(e<<2|i>>>6)]+BASE64_ENCODE_CHAR[63&i];return t=o[n],r+(BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[t<<4&63]+"==")};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(133),__webpack_require__(134))},function(t,e){var i,r,o=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===n||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:n}catch(t){i=n}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var l,d=[],u=!1,c=-1;function h(){u&&l&&(u=!1,l.length?d=l.concat(d):c=-1,d.length&&p())}function p(){if(!u){var t=a(h);u=!0;for(var e=d.length;e;){for(l=d,d=[];++c<e;)l&&l[c].run();c=-1,e=d.length}l=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];d.push(new f(t,e)),1!==d.length||u||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e){[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild&&this.parentNode.removeChild(this)}})})},function(t,e,i){"use strict";function r(){this.VERSION="2.4.5",this.REPORT_VERSION=this.VERSION+"_20200509_1622",this.MINIPROGRAM_REPORT_VERSION=this.VERSION+"_20200326_0402",this.NATIVEVERSION="web",this.PLATFORM="web",this.SERVER_URL="https://yun.tim.qq.com/v4/ilvb_edu/whiteboard?sdkappid=",this.TEST_SERVER_URL="https://test.tim.qq.com/v4/ilvb_test/whiteboard?sdkappid=",this.COS_SERVER_URL="https://yun.tim.qq.com/v4/ilvb_edu/cos",this.TEST_COS_SERVER_URL="https://test.tim.qq.com/v4/ilvb_test/cos",this.WHITELIST_SERVER_URL="https://yun.tim.qq.com/v4/ilvb_edu/whitelist?sdkappid=",this.TEST_WHITELIST_SERVER_URL="https://test.tim.qq.com/v4/ilvb_test/whitelist?sdkappid=",this.TRANSCODE_SERVER_URL="https://yun.tim.qq.com/v4/ilvb_edu/transcode?sdkappid=",this.TEST_TRANSCODE_SERVER_URL="https://test.tim.qq.com/v4/ilvb_test/transcode?sdkappid=",this.TEST_HEARTBEAT_SERVER_URL="https://yun.tim.qq.com/v4/ilvb_test/report_heartbeat?sdkappid=",this.HEARTBEAT_SERVER_URL="https://yun.tim.qq.com/v4/ilvb_heartbeat/report_heartbeat?sdkappid=",this.NOTIFY_SERVER_URL="https://yun.tim.qq.com/v4/ilvb_edu/notify?sdkappid=",this.TEST_NOTIFY_SERVER_URL="https://yun.tim.qq.com/v4/ilvb_test/notify?sdkappid=",this.fontUrl="https://tic-res-1259648581.file.myqcloud.com/board/fonts/simhei-Regular.ttf",this.SUB_CMD={GET_BOARD_DATA:"get_board_data",REPORT_BOARD_DATA:"report_board_data"},this.PROGRESS_ENABLE=!1,this.PROGRESS_SHOW_DELAY=100,this.SYNC_VIDEO_STATUS_INTERVAL=3e3,this.SYNC_VIDEO_STATUS_PRECISION=3e3,this.COMMON_GROUP="#DEFAULT",this.COMMON_DEFAULT_BOARD="#DEFAULT",this.SCALE=100,this.MAX_SCALE=1600,this.MIN_SCALE=100,this.RATIO="16:9",this.THIN=100,this.SMOOTH_LEVEL=0,this.MIN_LINE_WIDTH=1,this.MIN_FONT_SIZE=1,this.TEXT_MAX_LENGTH=2e3,this.TEXT_SIZE=320,this.TEXT_COLOR=0,this.TEXT_FONT_FAMILY="customFontFamily,sans-serif,serif,monospace",this.DATA_SYNC_ENABLE=!0,this.PRELOAD_DEPTH=5,this.IMAGESFILE_MAX_URL_LENGTH=5e3,this.IMAGE_TIMEOUT=10,this.TEXT_FONT_STYLE={NORMAL:0,BOLD:1,ITALIC:2,BOLD_ITALIC:3},this.FILE_TYPE={IMG:0,H5PPT:1,VOD:2,LIVE:3,H5FILE:4,VODFILE:5,IMAGESFILE:6},this.VIDEO_STATUS={STOP:0,PLAY:1,PAUSE:2},this.VIDEO_ACTION={PASSIVE:1,API:2,EXCEPTIOIN:3},this.VIDEO_FORMAT={NONE:"",MP4:"mp4",M3U8:"m3u8",FLV:"flv",RTMP:"rtmp"},this.ABOUTBLANK="about:blank",this.penCursorIcon="https://tic-res-1259648581.file.myqcloud.com/board/icons/pen2.png",this.laserCursorIcon="https://tic-res-1259648581.file.myqcloud.com/board/icons/laserpen.png",this.ICONS={0:{cursor:"auto"},1:{cursor:"none",url:this.penCursorIcon,offsetX:0,offsetY:0},2:{cursor:"auto"},3:{cursor:"none",url:this.laserCursorIcon,offsetX:32,offsetY:32},4:{cursor:"crosshair"},5:{cursor:"crosshair"},6:{cursor:"crosshair"},7:{cursor:"crosshair"},8:{cursor:"crosshair"},9:{cursor:"auto"},10:{cursor:"crosshair"},11:{cursor:"text"},12:{cursor:"move"}},this.PROTOCOL_ACTION={LINE_START_ACTION:1,LINE_MOVE_ACTION:2,LINE_END_ACTION:3,RASER_SHOW_ACTION:6,RASER_HIDE_ACTION:7,ERASER_ACTION:8,MOVE_LINE_GRAPH_ACTION:9,GRAPH_LINE_ACTION:10,GRAPH_CIRCLE_ACTION:11,GRAPH_RECT_ACTION:12,INPUT_TEXT_ACTION:13,IMAGE_ELEMENT:20,GRAPH_CLEAR_ALL_ACTION:101,GRAPH_CLEAR_ACTION:102,FILE_CLEAR_ACTION:103,RESET_DATA_ACTION:104,SET_BOARD_RATIO_ACTION:105,SET_BOARD_FIT_MODE_ACTION:106,UPDATE_BG_IMG_ACTION:201,DELETE_BG_IMG_ACTION:202,UPDATE_BG_COLOR_ACTION:203,BOARD_MOVE_SCALE_ACTION:301,SWITCH_ACTION:401,ADD_FILE_ACTION:501,PPT_EVENT_ACTION:601,VIDEO_EVENT_ACTION:701}}i.r(e),i(25),i(37),i(15),i(58),i(16),i(17),i(13),i(59),i(39),i(77),i(102),i(60),i(106),i(42),i(80),i(83),i(62),i(69),i(116),i(117),i(118),i(87),r.prototype.setPlatform=function(t){this.PLATFORM=t},r.prototype.setNativeVersion=function(t){this.NATIVEVERSION=t};var o=new r,n={BOARD_ACTION_TYPE:{LINE:"line",ERASER:"eraser",RASER:"raser",POINTSELECT:"pointselect",SELECT:"select",MOVE:"move","GRAPH-LINE":"graph-line","GRAPH-CIRCLE":"graph-circle","GRAPH-RECT":"graph-rect","GRAPH-OVAL":"graph-oval","GRAPH-CIRCLE-SOLID":"graph-circle-solid","GRAPH-RECT-SOLID":"graph-rect-solid","GRAPH-OVAL-SOLID":"graph-oval-solid",INPUTTEXT:"inputtext",MOUSE:"mouse",ZOOM:"zoom","GRAPH-STRAIGHTLINE":"graph-straightLine","GRAPH-ELLIPSE":"graph-ellipse"},BOARD_MODE:{BOARD:0,FILE:1},BACKGROUND_TYPE:{IMAGE:0,H5:1},FILL_MODE:{DEFAULT:0,LEFT:4,TOP:5,RIGHT:6,BOTTOM:7},COLOR:{RED:4278190335,WHITE:4294967295},EVENT:{HISTROY_DATA_COMPLETE:"histroy_data_complete",ADD_BOARD:"add_board",RT_DATA:"real_time_data",REAL_TIME_DATA:"real_time_data",ADD_DATA_ERROR:"add_data_error",DELETE_BOARD:"delete_board",SWITCH_BOARD:"switch_board",ADD_FILE:"add_group",ADD_H5PPT_FILE:"add_h5ppt_file",DELETE_FILE:"delete_group",SWITCH_FILE:"switch_group",IMG_START_LOAD:"img_start_load",IMG_LOAD:"img_load",IMG_ERROR:"img_error",IMG_ABORT:"img_abort",PRELOAD:"preload",BOARD_CAN_UNDO:"board_can_undo",BOARD_CAN_REDO:"board_can_redo",VERIFY_SDK_SUCC:"verify_sdk_succ",VERIFY_SDK_ERROR:"verify_sdk_error",CANVAS_MOUSEDOWN:"canvas_mousedown",CANVAS_MOUSEMOVE:"canvas_mousemove",CANVAS_MOUSEUP:"canvas_mouseup",CANVAS_MOUSELEAVE:"canvas_mouseleave",CANVAS_TOUCHSTART:"canvas_touchstart",CANVAS_TOUCHMOVE:"canvas_touchmove",CANVAS_TOUCHEND:"CANVAS_touchend",CANVAS_TOUCHCANCEL:"canvas_touchcancel",UPDATE_BACKGROUND_IMAGE_SUCCESS:"update_background_image_success",UPDATE_BACKGROUND_IMAGE_ERROR:"update_background_image_error",COS:{GET_SIGN_ERROR:"get_sign_error",TASK_READY:"task_ready",HASH_PROGRESS:"hash_progress",PROGRESS:"progress",GET_SIGN_SUCCESS:"get_sign_success",DOES_NOT_SUPPORT_UPLOAD:"does_not_support_upload",UPLOAD_SUCCESS:"upload_success",UPLOAD_ERROR:"upload_error"}}},s=(i(70),i(92)),a=i.n(s),l={performanceNow:0,serverTime:0,localTime:0,localServerTimeDiff:0,seq:0,getCurrentTimeStamp:function(){var t=0;return window&&window.performance&&window.performance.now?t=this.serverTime+parseInt(window.performance.now()-this.performanceNow):(isNaN(this.localServerTimeDiff)&&(this.localServerTimeDiff=0),t=Date.now()-this.localServerTimeDiff),t},getSeq:function(){var t=parseInt(this.getCurrentTimeStamp()/1e3);return 1*new a.a(t>>>0<<15|32767&this.seq++,t>>>0>>17).toString()}},d={decimalToRgba:function(t){6===t.length&&(t+="ff");var e=[];return t.replace(/../g,function(t,i){var r;r=3==e.length?parseInt(t,"0x10")/255:parseInt(t,"0x10"),e.push(r)}),"rgba("+e.join(",")+")"},hexToRgba:function(t){var e;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3==(e=t.substring(1).split("")).length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2]]),t="#"+e.join(""),"rgba("+parseInt("0x"+t.slice(1,3))+","+parseInt("0x"+t.slice(3,5))+","+parseInt("0x"+t.slice(5,7))+", 1)"},rgbaToDecimal:function(t){for(var e=t.toString().match(/[\d\.]+/g),i="",r=0;r<3;r++)i+=("0"+(0|Number(e[r])).toString(16)).slice(-2);var o="ff";return e.length>=4&&(o=("0"+(0|Number(Math.min(255,255*e[3]))).toString(16)).slice(-2)),i+o},dealColor:function(t){if(t<0)return"rgba("+(t>>24&255)+","+(t>>16&255)+","+(t>>8&255)+",1)";var e=parseInt(t).toString(16),i=e.substr(e.length-2,e.length)||0;return e=(e="000000"+(e=e.substr(0,e.length-2))).substring(e.length-6,e.length),this.decimalToRgba(e+i)},formatColor:function(t){var e=this.rgbaToDecimal(t);return parseInt(e,16)},getEffectivePoint:function(t,e){return t<=0?t=Math.floor(e/2):t>=1e4&&(t=1e4-Math.floor(e/2)),t},getAVSdkTimestamp:function(){var t=this.getTimeStamp()+"",e=t.substring(0,5)+"00000000",i=t.substr(5),r=parseInt(e,10).toString(2).substr(-32);return parseInt(r,2)+(4294967295&i)},getTimeStamp:function(){return l.getCurrentTimeStamp()},getSecondTime:function(){return parseInt(this.getTimeStamp()/1e3)},getTimeDiff:function(t){return this.getTimeStamp()-t},boardId2Fid:function(t){return t.substring(t.indexOf("#"))},boardId2Uid:function(t){if(t===o.COMMON_DEFAULT_BOARD)return"";var e="";try{e=(e=t.substring(0,t.match(/_\d+_\d+_#\w+$/).index)).substring(e.indexOf("_")+1)}catch(t){}return e},boardIdGetSeq:function(t){return t.match(/\d+_#/)[0].replace(/\D/gi,"")},isCosUrl:function(t){return t.indexOf("myqcloud.com")>-1&&t.indexOf("cos")>-1},cosUrlExtractFileName:function(t){t.indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?")));var e=t.substring(t.lastIndexOf("/")+1);return t.indexOf("-1257240443")>-1&&e.match(/\d+_/)&&(e=e.substr(e.match(/^\d+_/)[0].length)),decodeURIComponent(e)},fileDownLoadUrlToPreviewUrl:function(t){if(t.startsWith("https")||(t=t.startsWith("http")?t.replace("http","https"):"https://"+t),t.endsWith("/"))return t;t.indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?")));var e="//";t.indexOf(e)>-1&&(t=t.substring(t.indexOf(e)+e.length)),e=".";var i=t.indexOf(e);return e=".com","https://"+t.substr(0,i)+".preview.myqcloud.com"+t.substring(t.indexOf(e)+e.length)+"?cmd=doc_preview&of=pic&page="},fontStyle2CanvasFontStyle:function(t){var e="";return 0===t?e="":1===t?e="bold":2===t?e="italic":3===t&&(e="italic bold"),e+" "},maxCommonDivisor:function(t,e){return 0!=e?this.maxCommonDivisor(e,t%e):t},calcRatioWidthHeight:function(t,e){var i,r;try{var o=t.split(":");i=1*o[0],i=isNaN(i)?e.split(":")[0]:i,r=1*o[1],r=isNaN(r)?e.split(":")[1]:r}catch(t){return this.calcRatioWidthHeight(e)}return{ratioWidth:i,ratioHeight:r}},isMobile:function(){var t=navigator.userAgent.toLowerCase();if(!(t.indexOf("macintosh")>-1))return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(t);try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}},isIOS:function(){var t=navigator.userAgent.toLowerCase();if(!(t.indexOf("macintosh")>-1))return/iphone|ipad|ipod/i.test(t);try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}},isIOS8910:function(){return!!this.isIOS()&&!!navigator.userAgent.toLowerCase().match(/OS (8|9|10)[_\d]* like Mac OS X/i)},isAndroid:function(){var t=navigator.userAgent.toLowerCase();return/android/i.test(t)},isTBS:function(){var t=navigator.userAgent.toLowerCase();return/tbs/i.test(t)},parseQueryString:function(t){for(var e={},i=[],r="",o="",n=t.substring(t.indexOf("?")+1,t.length).split("&"),s=0,a=n.length;s<a;s++)r=(i=n[s].split("="))[0],o=i[1],e[r]=o;return e},extractTouch:function(t){return t&&t.changedTouches&&t.changedTouches[0]?{clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY,force:t.changedTouches[0].force,identifier:t.changedTouches[0].identifier,pageX:t.changedTouches[0].pageX,pageY:t.changedTouches[0].pageY,radiusX:t.changedTouches[0].radiusX,radiusY:t.changedTouches[0].radiusY,rotationAngle:t.changedTouches[0].rotationAngle,screenX:t.changedTouches[0].screenX,screenY:t.changedTouches[0].screenY}:{}},extractTaskId:function(t){return t.substring(t.indexOf(".com/")+5,t.indexOf("/index.html"))},camelCase2CamelCase:function(t){if("[object String]"===Object.prototype.toString.call(t))return t.replace(/(.)(.*)/,t.charAt(0).toUpperCase()+"$2");if("[object Object]"===Object.prototype.toString.call(t)){var e={};for(var i in t)e[this.camelCase2CamelCase(i)]=t[i];return e}},CamelCase2camelCase:function(t){if("[object String]"===Object.prototype.toString.call(t))return t.replace(/(.)(.*)/,t.charAt(0).toLowerCase()+"$2");if("[object Object]"===Object.prototype.toString.call(t)){var e={};for(var i in t)e[this.CamelCase2camelCase(i)]=t[i];return e}},debounce:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,i=null;return function(){var r=this,o=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(r,o)},e)}},calcPointAndBoardRightBorderDistance:function(t,e,i,r,o,n){return{distanceX:t-o/1e4*t,distanceY:i-n/1e4*i}},calcPointAndContainerRightBorderDistance:function(t,e,i,r,o,n,s,a){var l=0,d=0;return t<e?(l=t-s/1e4*t,d=i-a/1e4*i):(l=(t-e)/2+(50-o)*t/100+e-s/1e4*t,d=(i-r)/2+(50-n)*i/100+r-a/1e4*i),{distanceX:l,distanceY:d}},calcPointAndContainerLeftBorderDistance:function(t,e,i,r,o,n,s,a){var l=0,d=0;return t<e?(l=s/1e4*t,d=a/1e4*i):(l=s/1e4*t-(t-e)/2-(50-o)*t/100,d=a/1e4*i-(i-r)/2-(50-n)*i/100),{distanceX:l,distanceY:d}},compress:function(t){return t?i(89).compressToBase64(t):""},decompress:function(t){return t?i(89).decompressFromBase64(t):""},canvasTextAutoLine:function(t,e,i,r,o,n,s){var a=0,l=0,d=e.split("\n"),u=0,c=0,h=s||o-i-10-2-1,p=/[\u4E00-\u9FA5\uF900-\uFA2D\u0800-\u4e00]/,f=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;return d.forEach(function(e,o){if(o>0&&(r+=n),a=0,l=0,""==e)t.fillText(e,i,r),u+=n,a=0;else for(var s=0;s<e.length;s++)p.test(e[s])||f.test(e[s])?a+=2*t.measureText("M").width:a+=t.measureText("M").width,c=Math.max(c,a),a>h+t.measureText(e[s]).width/2&&(t.fillText(e.substring(l,s),i,r,h),c=Math.min(c,h),u+=n,r+=n,a=0,l=s,--s),s==e.length-1&&(t.fillText(e.substring(l,e.length),i,r,h),u+=n)}),[c,u]},renderTextAutoLine:function(t,e,i,r,o,n,s){var a=0,l=0,d=e.split("\n"),u=0,c=0,h=s||o-i-10-2-1,p=/[\u4E00-\u9FA5\uF900-\uFA2D\u0800-\u4e00]/,f=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;return d.forEach(function(e,o){if(o>0&&(r+=n),a=0,l=0,""==e)t.fillText(e,i,r),u+=n,a=0;else for(var s=0;s<e.length&&(p.test(e[s])||f.test(e[s])?a+=2*t.measureText("M").width:a+=t.measureText("M").width,c=Math.max(c,a),!(a>h&&(t.fillText(e.substring(l,s),i,r,h),c=Math.min(c,h),u+=n,r+=n,a=0,l=s,--s<0)));s++)s==e.length-1&&(t.fillText(e.substring(l,e.length),i,r,h),u+=n)}),[c,u]},calcCanvasTextWidthAndHeight:function(t,e,i,r,o,n){for(var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1e4,a=arguments.length>7?arguments[7]:void 0,l=0,d=e.split("\n"),u=0,c=0,h=Math.min(Math.max(o-i-Math.floor(100*o/1e4),0),s),p=/[\u4E00-\u9FA5\uF900-\uFA2D\u0800-\u4e00]/,f=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/,g=t.measureText("M").width,m=0,y=0;y<d.length;y++){var _=d[y];if(l=0,(u+=n)>a)break;if(""==_)m+=1,l=0;else{0!=y&&(m+=1);for(var v=!1,T=0,S=0;S<_.length;S++)if(p.test(_[S])||f.test(_[S])?l+=2*g:l+=g,c=Math.max(c,l),l>h){if(v=!0,c=Math.min(c,h),u+=n,l=0,0==S){T=_.length-S;break}if(u>a){T=_.length-S;break}if(--S<0)break}m+=_.length,v&&(m-=T)}}return{textWidth:c,textHeight:u,limitIndex:m}}},u=function(t,e){this.user=t,this.type=e.type,this.seq=e.seq};function c(t,e){this.user=t,this.type="line",this.seq=e.belongSeq,this.belongSeq=e.belongSeq,this.show=e.show,this.status="begin",this.select=!1,this.color=e.color,this.time=d.getTimeStamp(),this.thin=e.thin,this.writing=e.writing,this.startSeq=e.belongSeq,this.endSeq=0,this.lines=[{x:e.x,y:e.y,w:e.w,belongSeq:e.belongSeq,seq:e.seq}],this.fitCurve=[],this.border={maxX:e.x,maxY:e.y,minX:e.x,minY:e.y}}c.prototype.setBorder=function(t,e){t+this.thin>this.border.maxX&&(this.border.maxX=d.getEffectivePoint(t+this.thin,this.thin)),t-this.thin<this.border.minX&&(this.border.minX=d.getEffectivePoint(t-this.thin,this.thin)),e+this.thin>this.border.maxY&&(this.border.maxY=d.getEffectivePoint(e+this.thin,this.thin)),e-this.thin<this.border.minY&&(this.border.minY=d.getEffectivePoint(e-this.thin,this.thin))},c.prototype.sort=function(){this.lines.sort(function(t,e){return t.seq-e.seq})};var h=c,p=function(t,e){this.user=t,this.type="inputtext",this.seq=e.belongSeq,this.belongSeq=e.belongSeq,this.scale=1,this.color=0,this.typeFace="",this.textSize=0,this.fontStyle=0,this.time=d.getTimeStamp(),this.text="",this.show=!0,this.textWidth=0,this.textHeight=0,this.location={x:e.x,y:e.y}},f=function(t,e){this.user=t,this.type="graph",this.graph=e.graph,this.seq=e.seq,this.show=e.show,this.status="begin",this.select=!1,this.time=d.getTimeStamp(),this.color=e.color,this.thin=e.thin,this.solid=e.solid||!1,this.style=e.style,this.startPoint={x:e.beginPoint.x,y:e.beginPoint.y,seq:e.beginPoint.seq},this.endPoint={x:e.endPoint.x,y:e.endPoint.y,seq:e.endPoint.seq}},g=function(t,e){this.user=t,this.type="select",this.seq=Math.floor(100*Math.random()),this.show=!0,this.color=e.color,this.startInfo={x:e.startx,y:e.starty},this.location={x:e.x,y:e.y}},m=function(t,e){this.user=t,this.type="raser",this.seq=e.seq,this.show=!0,this.status=1,this.color=e.color,this.radius=e.radius,this.location={x:e.x,y:e.y},this.toolType=e.toolType||3};function y(){this.waterEvents=["addData"],this.waterUrl="https://report-log-lv0.api.qcloud.com",this.keyUrl="https://report-log-lv1.api.qcloud.com"}y.prototype={method:"POST",events:{start_draw_curve:"start_draw_curve",move_draw_curve:"move_draw_curve",end_draw_curve:"end_draw_curve",over_draw_curve:"over_draw_curve",start_raser:"start_raser",end_raser:"end_raser",eraser:"eraser",move_scrawl:"move_scrawl",draw_graph:"draw_graph",clear_all:"clear_all",clear_scrawl:"clear_scrawl",set_bg_img:"set_bg_img",clear_bg_img:"clear_bg_img",set_bg_color:"set_bg_color",switch_board:"switch_board",start_select:"start_select",move_select:"move_select",end_select:"end_select",point_select:"point_select"},levels:{info:"info",warn:"warn",error:"error"},send:function(t,e){try{e.userAgent=navigator.userAgent,e=this.fillDatas(e);var i=this.getXHR();i.onreadystatechange=this.reporterHandel(i),i.open(this.method,t,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(JSON.stringify(e))}catch(t){}},fillDatas:function(t){var e={};for(var i in this.defDatas)["sdkappid","classid","userid"].indexOf(i)>=0?e[i]=this.defDatas[i]:(e[i]=void 0!==t[i]?t[i]:this.defDatas[i],"boardid_list"===i&&(e[i]=JSON.stringify(this.defDatas[i])),"roomid"===i&&(e[i]=this.defDatas[i]+""));return e.device=o.PLATFORM,e.nativeVersion=o.NATIVEVERSION,e},datasParseToString:function(t){var e=[];for(var i in t)e.push(i+"="+encodeURIComponent(t[i]));return e.join("&")},getXHR:function(){var t=null,e=window.ActiveXObject;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(e)try{t=new e("Msxml2.XMLHTTP")}catch(i){try{t=new e("Microsoft.XMLHTTP")}catch(t){}}if(null!=t)return t},reporterHandel:function(t){return function(){t&&t.readyState&&t.readyState}},log:function(t,e){this.send({action:t,action_result:e||0,log_msg:t,log_level:this.levels.info})},warn:function(t,e){this.send({action:t,action_result:e||0,log_msg:t,log_level:this.levels.warn})},error:function(t,e){this.send({action:t,action_result:e||0,log_msg:t,log_level:this.levels.error})},defDatas:{action:"",version:o.REPORT_VERSION,action_result:0,action_info:"",userid:"",time_consume:0,sdkappid:"",device:o.PLATFORM,log_time:0,business:"ticsdk",roomid:"",boardid:"",image_url:"",boardid_list:[],to_boardId:"",color:null,file_id:"",file_title:"",isfinish:0,msgLength:20,bucket:"",cos_appid:null,extra_info:"",net_type:"unknown",userAgent:null},setSdkAppid:function(t){null!=t&&null!=t&&(this.defDatas.sdkappid=t)},setRoomId:function(t){null!=t&&null!=t&&(this.defDatas.roomid=t)},setUserId:function(t){null!=t&&null!=t&&(this.defDatas.userid=t)},boardAction:function(t,e){this.report(t,e)},report:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var i;i=this.waterEvents.indexOf(t)>-1?this.waterUrl:this.keyUrl,this.send(i,Object.assign({action_result:0,time_consume:0},e,{action:t,log_time:d.getTimeStamp()}))}catch(t){}}};var _=new y,v=function(t){var e=window.axios.create({timeout:5e3});e.defaults.retry=3,e.defaults.retryDelay=1e3,e.interceptors.request.use(function(t){return t},function(t){return Promise.reject(t)});var i=function(t){var i=t.config;if(i.data)try{var r=JSON.parse(i.data);!1===r.first_time&&(r.first_time=!0,i.data=JSON.stringify(r))}catch(t){}return i&&i.retry?(i.__retryCount=i.__retryCount||0,i.__retryCount>=i.retry?Promise.reject(t):(i.__retryCount+=1,new Promise(function(t){setTimeout(function(){t()},i.retryDelay||1e3)}).then(function(){return e(i)}))):Promise.reject(t)};return e.interceptors.response.use(function(t){if(200==t.status)try{if(60008===t.data.ErrorCode)return i(t)}catch(e){return t}return t},i),new Promise(function(i,r){e(t).then(function(t){i(t)},function(t){try{var e;e=t.response?JSON.stringify({data:t.response.data,status:t.response.status,headers:t.response.headers,config:t.config,message:t.message}):t.request?JSON.stringify({request:t.request,config:t.config,message:t.message}):JSON.stringify({message:t.message,config:t.config}),_.report("requestError",{action_result:-1,extra_info:e})}catch(t){_.report("requestError",{action_result:-2,extra_info:{stack:t.stack,message:t.message}})}r(t)})})};function T(t){if(this.permissions=!1,this.reportEnable=!1,this.option=Object.assign({},t),!this.option.tlsData)throw new Error("not found sdkAppId|userId|userSig");if(!this.option.tlsData.sdkAppId)throw new Error("not found sdkAppId");if(!this.option.tlsData.identifier)throw new Error("not found userId");if(!this.option.tlsData.userSig)throw new Error("not found userSig");this.BOARD_URL=(t.isTest?o.TEST_SERVER_URL:o.SERVER_URL)+this.option.tlsData.sdkAppId,this.COS_SERVER_URL=t.isTest?o.TEST_COS_SERVER_URL:o.COS_SERVER_URL,this.WHITELIST_SERVER_URL=(t.isTest?o.TEST_WHITELIST_SERVER_URL:o.WHITELIST_SERVER_URL)+this.option.tlsData.sdkAppId,this.TRANSCODE_SERVER_URL=(t.isTest?o.TEST_TRANSCODE_SERVER_URL:o.TRANSCODE_SERVER_URL)+this.option.tlsData.sdkAppId,this.HEARTBEAT_SERVER_URL=(t.isTest?o.TEST_HEARTBEAT_SERVER_URL:o.HEARTBEAT_SERVER_URL)+this.option.tlsData.sdkAppId,this.NOTIFY_SERVER_URL=(t.isTest?o.TEST_NOTIFY_SERVER_URL:o.NOTIFY_SERVER_URL)+this.option.tlsData.sdkAppId}T.prototype.setPermissions=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.permissions=t},T.prototype.initXmlHttp=function(){var t=window.ActiveXObject;return XMLHttpRequest?new XMLHttpRequest:new t("Microsoft.XMLHTTP")},T.prototype.setReportEnable=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.reportEnable=t},T.prototype.reportMsg=function(t,e,i){if(this.option.classId&&this.permissions&&this.reportEnable){var r={cmd:"open_conf_svc",sub_cmd:"report_board_data",conf_id:parseInt(this.option.classId,10),board_data_list:t};this.post(r,e,i)}},T.prototype.getBoardData=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r={first_time:t,cmd:"open_conf_svc",sub_cmd:"get_board_data_bulk",seq:l.getSeq(),conf_id:parseInt(this.option.classId,10),version:1};this.post(r,e,i)},T.prototype.getLineData=function(t,e,i){var r=d.getTimeStamp(),o={cmd:"open_conf_svc",sub_cmd:"get_line",conf_id:parseInt(this.option.classId,10),boardId:t.boardId,owner:t.owner,seq:t.seq};this.post(o,function(t){_.report("getLineData",{action_result:0,time_consume:d.getTimeStamp()-r,extra_info:JSON.stringify(t)}),e&&e(t)},function(t){_.report("getLineData",{action_result:-1,time_consume:d.getTimeStamp()-r,extra_info:JSON.stringify(t)}),i&&i(t)})},T.prototype.getFileInfo=function(t,e,i){var r=d.getTimeStamp(),o={cmd:"open_conf_svc",sub_cmd:"get_file",conf_id:parseInt(this.option.classId,10),fid:t.fid};this.post(o,function(t){_.report("getFileInfo",{action_result:0,time_consume:d.getTimeStamp()-r,extra_info:JSON.stringify(t)}),e&&e(t)},function(t){_.report("getFileInfo",{action_result:-1,time_consume:d.getTimeStamp()-r,extra_info:JSON.stringify(t)}),i&&i(t)})},T.prototype.getDocTotalPage=function(t){return v({url:t,method:"get",responseType:"blob"})},T.prototype.getCosAuthData=function(){var t=this.COS_SERVER_URL+"?SdkAppId=".concat(this.option.tlsData.sdkAppId,"&Identifier=").concat(this.option.tlsData.identifier,"&UserSig=").concat(this.option.tlsData.identifier);return v({url:t,method:"post",data:{cmd:"open_cos_svc",sub_cmd:"get_cos_token",duration:300,version:2}})},T.prototype.applyPermissions=function(){var t=this.WHITELIST_SERVER_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier;return v({url:t,method:"post",data:{cmd:"open_conf_svc",sub_cmd:"verify_sdk",sdkappid:1*this.option.tlsData.sdkAppId,version:1}})},T.prototype.heartbeat=function(t){var e=this.HEARTBEAT_SERVER_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier+"&contenttype=json&random="+parseInt(1e8*Math.random(0,1));return v({url:e,method:"post",data:Object.assign({LastReportTime:0,HeartbeatVersion:"1.0"},t)})},T.prototype.createTranscode=function(t){var e=this.TRANSCODE_SERVER_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier;return v({url:e,method:"post",data:Object.assign({Action:"CreateTranscode"},d.camelCase2CamelCase(t))})},T.prototype.describeTranscode=function(t){var e=this.TRANSCODE_SERVER_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier;return v({url:e,method:"post",data:Object.assign({Action:"DescribeTranscode"},d.camelCase2CamelCase(t))})},T.prototype.requestFont=function(){var t=o.fontUrl;return v({url:t,method:"get"})},T.prototype.machineNotify=function(t,e){var i,r,o,n=this.NOTIFY_SERVER_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier;return v({url:n,method:"post",data:(i={msgtype:t},r=t,o={content:e},r in i?Object.defineProperty(i,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[r]=o,i)})},T.prototype.urlPost=function(t,e,i,r){"undefined"==typeof axios?this.cPost(t,e,i,r):this.axiosPost(t,e,i,r)},T.prototype.post=function(t,e,i){var r=this.BOARD_URL+"&usersig="+this.option.tlsData.userSig+"&identifier="+this.option.tlsData.identifier;"undefined"==typeof axios?this.cPost(r,t,e,i):this.axiosPost(r,t,e,i)},T.prototype.axiosPost=function(t,e,i,r){v({url:t,method:"post",data:e}).then(function(t){i&&i(t.data,t)}).catch(function(t){r&&r(t)})},T.prototype.cPost=function(t,e,i,r){var o=this.initXmlHttp();o.open("POST",t,!0),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.send(JSON.stringify(e)),o.onreadystatechange=function(){if(4==o.readyState)if(o.status>=200&&o.status<300||304==o.status){var t=null;try{t=JSON.parse(o.responseText),i&&i(t)}catch(t){r&&r(t)}}else{var e=new Error("Network Error");r&&r(e)}}};var S=T;function E(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(e){var i=e.newEnterId,r=void 0===i?0:i,o=e.classId,n=e.request;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$request=n,this.classId=Number(o),this.newEnterId=Number(r)||0,this.defaultTimeout=3e4,this.maxTimeout=10*this.defaultTimeout,this.timeout=this.defaultTimeout,this.status=!0,this.sto=null,this.maxRetry=10,this.retryCount=0,this.LastReportTime=0,this.visible=!0,this._heartbeatLifecycle="live"}var e,i;return e=t,(i=[{key:"beat",value:function(t){var e=this;clearTimeout(this.sto);var i={LastReportTime:this.LastReportTime,HeartbeatVersion:"2.0",RoomId:this.classId,HeartbeatList:[{BusinessType:"whiteboard",Submodule:"",CustomData:{Event:t}}],ClientVersion:o.VERSION,NewEnterId:this.newEnterId,UserAgent:navigator.userAgent,BackgroundState:this.visible?0:1};if("destroy"!==this._heartbeatLifecycle){var r=d.getTimeStamp();return this.$request.heartbeat(i).then(function(t){t.data.Response&&!t.data.Response.Error?(e.retryCount=0,e.LastReportTime=t.data.Response.ReportTime,e.timeout=1e3*t.data.Response.IntervalTime,e.trigger()):(e.retryCount++,e.timeout=Math.min(Math.ceil(e.retryCount/10)*e.defaultTimeout,e.maxTimeout),e.trigger(),e.reportElk(r,t.data))}).catch(function(t){e.retryCount++,e.timeout=Math.min(Math.ceil(e.retryCount/10)*e.defaultTimeout,e.maxTimeout),e.trigger(),e.reportElk(r,t)})}}},{key:"trigger",value:function(){var t=this;clearTimeout(this.sto),this.sto=setTimeout(function(){t.beat(null)},this.timeout||this.defaultTimeout)}},{key:"setClassId",value:function(t){this.classId=Number(t)}},{key:"setVisible",value:function(t){this.visible=t;var e=[{name:t?"visible":"unvisible",timestamp:d.getSecondTime()}];this.beat(e)}},{key:"start",value:function(){var t=[{name:"init",timestamp:d.getSecondTime()}];this.beat(t)}},{key:"pause",value:function(){this.status=!1,clearTimeout(this.sto)}},{key:"resume",value:function(){this.status=!0,this.beat(null)}},{key:"destroy",value:function(){var t=this,e=[{name:"uninit",timestamp:d.getSecondTime()}];this.beat(e).then(function(){t._heartbeatLifecycle="destroy",clearTimeout(t.sto)}).catch(function(){t._heartbeatLifecycle="destroy",clearTimeout(t.sto)})}},{key:"reportElk",value:function(t,e){_.report("heartbeat_error",{time_consume:d.getTimeStamp()-t,extra_info:JSON.stringify({retryCount:this.retryCount,error:e})})}}])&&E(e.prototype,i),t}();function O(t){this.request=t}O.prototype.setPreCallback=function(t){this.preCallback=t},O.prototype.setCallback=function(t){this.callback=t},O.prototype.reportCreateBoards=function(t,e){var i;if(0!==(i=Array.isArray(e)?e:[e]).length){var r=d.getTimeStamp();this.reportMsg([{type:"createBoards",seq:l.getSeq(),content:{fid:d.boardId2Fid(i[0]),createBoards:i,updateTime:d.getTimeStamp()}}],function(e){e.ErrorCode||e.error_code?_.boardAction("createBoards",{action_result:e.ErrorCode?"ErrorCode:".concat(e.ErrorCode):"error_code:".concat(e.error_code),action_info:e.ErrorInfo||e.error_msg,time_consume:d.getTimeDiff(r),boardid:t,boardid_list:i,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):_.boardAction("createBoards",{action_result:0,action_info:null,time_consume:d.getTimeDiff(r),boardid:t,boardid_list:i,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(e){_.boardAction("createBoards",{action_result:-9999,action_info:e&&e.message,time_consume:d.getTimeDiff(r),boardid:t,boardid_list:i,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})}},O.prototype.reportDeleteBoard=function(t,e){var i=d.getTimeStamp();this.reportMsg([{type:"deleteBoards",seq:l.getSeq(),content:{deleteBoards:t,toBoardId:e,updateTime:d.getTimeStamp()}}],function(r){r.ErrorCode||r.error_code?_.boardAction("deleteBoards",{action_result:r.ErrorCode?"ErrorCode:".concat(r.ErrorCode):"error_code:".concat(r.error_code),action_info:r.ErrorInfo||r.error_msg,time_consume:d.getTimeDiff(i),boardid:null,boardid_list:t,image_url:null,to_boardId:e,color:null,file_id:null,file_title:null}):_.boardAction("deleteBoards",{action_result:0,action_info:null,time_consume:d.getTimeDiff(i),boardid:null,boardid_list:t,image_url:null,to_boardId:e,color:null,file_id:null,file_title:null})},function(r){_.boardAction("deleteBoards",{action_result:-9999,action_info:r&&r.message,time_consume:d.getTimeDiff(i),boardid:null,boardid_list:t,image_url:null,to_boardId:e,color:null,file_id:null,file_title:null})})},O.prototype.reportSetBoardBgColor=function(t,e){var i=d.getTimeStamp();this.reportMsg([{type:"setBoardBG",seq:l.getSeq(),content:{boardId:t,updateTime:d.getTimeStamp(),colorRGBA:e}}],function(r){r.ErrorCode||r.error_code?_.boardAction("setBoardBG",{action_result:r.ErrorCode?"ErrorCode:".concat(r.ErrorCode):"error_code:".concat(r.error_code),action_info:r.ErrorInfo||r.error_msg,time_consume:d.getTimeDiff(i),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:e,file_id:null,file_title:null}):_.boardAction("setBoardBG",{action_result:0,action_info:null,time_consume:d.getTimeDiff(i),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:e,file_id:null,file_title:null})},function(r){_.boardAction("setBoardBG",{action_result:-9999,action_info:r&&r.message,time_consume:d.getTimeDiff(i),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:e,file_id:null,file_title:null})})},O.prototype.reportClear=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"clean",seq:l.getSeq(),content:{boardId:t,updateTime:d.getTimeStamp()}}],function(i){i.ErrorCode||i.error_code?_.boardAction("clean",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):_.boardAction("clean",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(i){_.boardAction("clean",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},O.prototype.reportClearDraws=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"cleanDraws",seq:l.getSeq(),content:{boardId:t,updateTime:d.getTimeStamp()}}],function(i){i.ErrorCode||i.error_code?_.boardAction("cleanDraws",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):_.boardAction("cleanDraws",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(i){_.boardAction("cleanDraws",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:t,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},O.prototype.reportImage=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.FILL_MODE.DEFAULT,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.BACKGROUND_TYPE.IMAGE,o=d.getTimeStamp();this.reportMsg([{type:"image",seq:l.getSeq(),content:{fid:d.boardId2Fid(t),boardId:t,url:e,updateTime:d.getTimeStamp(),type:r,mode:i}}],function(i){var r={};r[t]=e,i.ErrorCode||i.error_code?_.boardAction("image",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(o),boardid:null,boardid_list:[r],to_boardId:null,color:null,file_id:null,file_title:null}):_.boardAction("image",{action_result:0,action_info:null,time_consume:d.getTimeDiff(o),boardid:null,boardid_list:[r],to_boardId:null,color:null,file_id:null,file_title:null})},function(i){var r={};r[t]=e,_.boardAction("image",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(o),boardid:null,boardid_list:[r],to_boardId:null,color:null,file_id:null,file_title:null})})},O.prototype.reportImages=function(t){for(var e=d.getTimeStamp(),i=0,r=Math.ceil(t.length/100);i<r;i++){var o;o=t.slice(100*i,100*(i+1)),this.reportMsg(o,function(i){var r=[];t.forEach(function(t){var e={};e[t.content.boardId]=t.content.url,r.push(e)}),i.ErrorCode||i.error_code?_.boardAction("image",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:r,to_boardId:null,color:null,file_id:null,file_title:null}):_.boardAction("image",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:r,to_boardId:null,color:null,file_id:null,file_title:null})},function(i){var r=[];t.forEach(function(t){var e={};e[t.content.boardId]=t.content.url,r.push(e)}),_.boardAction("image",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:r,to_boardId:null,color:null,file_id:null,file_title:null})})}},O.prototype.reportSwitchBoard=function(t){var e=t.boardId,i=t.fid,r=t.url,o=t.type,n=t.page,s=t.step,a=t.ratio,u=t.scale,c=d.getTimeStamp();this.reportMsg([{type:"switchBoard",seq:l.getSeq(),content:{boardId:e,fid:i,url:r,type:o,page:n,step:s,ratio:a,scale:u,updateTime:d.getTimeStamp()}}],function(t){t.ErrorCode||t.error_code?_.boardAction("switchBoard",{action_result:t.ErrorCode?"ErrorCode:".concat(t.ErrorCode):"error_code:".concat(t.error_code),action_info:t.ErrorInfo||t.error_msg,time_consume:d.getTimeDiff(c),boardid:e,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):_.boardAction("switchBoard",{action_result:0,action_info:null,time_consume:d.getTimeDiff(c),boardid:e,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(t){_.boardAction("switchBoard",{action_result:-9999,action_info:t&&t.message,time_consume:d.getTimeDiff(c),boardid:e,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},O.prototype.reportGlobalBgColor=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"setGlobalBG",seq:l.getSeq(),content:{updateTime:d.getTimeStamp(),colorRGBA:t}}],function(i){i.ErrorCode||i.error_code?_.boardAction("setGlobalBG",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:t,file_id:null,file_title:null}):_.boardAction("setGlobalBG",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:t,file_id:null,file_title:null})},function(i){_.boardAction("setGlobalBG",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:t,file_id:null,file_title:null})})},O.prototype.reportAddLine=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"addLine",seq:l.getSeq(),content:t}],function(i){i.ErrorCode||i.error_code?_.boardAction("addLine",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null,extra_info:JSON.stringify({belongSeq:t.belongSeq})}):_.boardAction("addLine",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null,extra_info:JSON.stringify({belongSeq:t.belongSeq})})},function(i){_.boardAction("addLine",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null,extra_info:JSON.stringify({belongSeq:t.belongSeq})})})},O.prototype.reportAddText=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"addText",seq:l.getSeq(),content:t}],function(i){i.ErrorCode||i.error_code?_.boardAction("addText",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null,text:t.text}):_.boardAction("addText",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null,text:t.text})},function(i){_.boardAction("addText",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:t.colorRGBA,file_id:null,file_title:null,text:t.text})})},O.prototype.reportDisplayLine=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"displayLine",seq:l.getSeq(),content:t}],function(i){i.ErrorCode||i.error_code?_.boardAction("displayLine",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null,display:t.display}):_.boardAction("displayLine",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null,display:t.display})},function(i){_.boardAction("displayLine",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:t.boardId,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null,display:t.display})})},O.prototype.reportGraphData=function(t){var e=d.getTimeStamp();this.reportMsg(t,function(i){t.forEach(function(t){i.ErrorCode||i.error_code?_.boardAction(t.type,{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:t.content.boardId,boardid_list:null,to_boardId:null,color:t.content.colorRGBA,file_id:null,file_title:null}):_.boardAction(t.type,{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:t.content.boardId,boardid_list:null,to_boardId:null,color:t.content.colorRGBA,file_id:null,file_title:null})})},function(i){t.forEach(function(t){_.boardAction(t.type,{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:t.content.boardId,boardid_list:null,to_boardId:null,color:t.content.colorRGBA,file_id:null,file_title:null})})})},O.prototype.reportAddFile=function(t){var e=t.fid,i=t.title,r=t.downloadURL,n=t.pageCount,s=t.currentPageIndex,a=t.currentPageStep,u=t.uid,c=t.timestamp,h=t.platform,p=t.type,f=t.ratio,g=t.scale,m=t.isTranscodeFile,y=t.status,v=t.progress,T=d.getTimeStamp();this.reportMsg([{type:"addFile",seq:l.getSeq(),content:{updateTime:d.getTimeStamp(),fid:e,title:i,downloadURL:r,pageCount:n,currentPageIndex:s,currentPageStep:a,uid:u,timestamp:c,platform:h||o.PLATFORM,type:p||o.FILE_TYPE.IMG,ratio:f,scale:g,isTranscodeFile:m,status:y,progress:v}}],function(t){t.ErrorCode||t.error_code?_.boardAction("addFile",{action_result:t.ErrorCode?"ErrorCode:".concat(t.ErrorCode):"error_code:".concat(t.error_code),action_info:t.ErrorInfo||t.error_msg,time_consume:d.getTimeDiff(T),extra_info:JSON.stringify({downloadURL:r,pageCount:n,currentPageIndex:s,currentPageStep:a,uid:u,timestamp:c,platform:h||o.PLATFORM,type:p||o.FILE_TYPE.IMG,ratio:f,scale:g,isTranscodeFile:m,status:y,progress:v}),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:e,file_title:i}):_.boardAction("addFile",{action_result:0,action_info:null,time_consume:d.getTimeDiff(T),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:e,file_title:i,extra_info:JSON.stringify({downloadURL:r,pageCount:n,currentPageIndex:s,currentPageStep:a,uid:u,timestamp:c,platform:h||o.PLATFORM,type:p||o.FILE_TYPE.IMG,ratio:f,scale:g,isTranscodeFile:m,status:y,progress:v})})},function(t){_.boardAction("addFile",{action_result:-9999,action_info:t&&t.message,time_consume:d.getTimeDiff(T),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:e,file_title:i,extra_info:JSON.stringify({downloadURL:r,pageCount:n,currentPageIndex:s,currentPageStep:a,uid:u,timestamp:c,platform:h||o.PLATFORM,type:p||o.FILE_TYPE.IMG,ratio:f,scale:g,isTranscodeFile:m,status:y,progress:v})})})},O.prototype.reportDeleteFile=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"deleteFile",seq:l.getSeq(),content:{fid:t,updateTime:d.getTimeStamp()}}],function(i){i.ErrorCode||i.error_code?_.boardAction("deleteFile",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:null}):_.boardAction("deleteFile",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:null})},function(i){_.boardAction("deleteFile",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:t,file_title:null})})},O.prototype.reportDrag=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"drag",seq:l.getSeq(),content:t}],function(i){i.ErrorCode||i.error_code?_.boardAction("drag",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),extra_info:JSON.stringify(t)}):_.boardAction("drag",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),extra_info:JSON.stringify(t)})},function(i){_.boardAction("drag",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),extra_info:JSON.stringify(t)})})},O.prototype.reportsetBoardRatio=function(t){var e=d.getTimeStamp();this.reportMsg([{type:"setRatio",seq:l.getSeq(),content:t}],function(i){i.ErrorCode||i.error_code?_.boardAction("setRatio",{action_result:i.ErrorCode?"ErrorCode:".concat(i.ErrorCode):"error_code:".concat(i.error_code),action_info:i.ErrorInfo||i.error_msg,time_consume:d.getTimeDiff(e),extra_info:JSON.stringify(t)}):_.boardAction("setRatio",{action_result:0,action_info:null,time_consume:d.getTimeDiff(e),extra_info:JSON.stringify(t)})},function(i){_.boardAction("setRatio",{action_result:-9999,action_info:i&&i.message,time_consume:d.getTimeDiff(e),extra_info:JSON.stringify(t)})})},O.prototype.reportsetBoardContentFitMode=function(t){this.reportMsg([{type:"setBoardContentFitMode",seq:l.getSeq(),content:t}],function(t){},function(t){})},O.prototype.reportImageElement=function(t){var e=[];"[object Array]"===Object.prototype.toString.call(t)?t.forEach(function(t){e.push({type:"imageElement",seq:l.getSeq(),content:t})}):e.push({type:"imageElement",seq:l.getSeq(),content:t}),this.reportMsg(e,function(t){},function(t){})},O.prototype.reportCleanAll=function(){var t=d.getTimeStamp();this.reportMsg([{type:"cleanAll",seq:l.getSeq()}],function(e){e.ErrorCode||e.error_code?_.boardAction("cleanAll",{action_result:e.ErrorCode?"ErrorCode:".concat(e.ErrorCode):"error_code:".concat(e.error_code),action_info:e.ErrorInfo||e.error_msg,time_consume:d.getTimeDiff(t),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null}):_.boardAction("cleanAll",{action_result:0,action_info:null,time_consume:d.getTimeDiff(t),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})},function(e){_.boardAction("cleanAll",{action_result:-9999,action_info:e&&e.message,time_consume:d.getTimeDiff(t),boardid:null,boardid_list:null,image_url:null,to_boardId:null,color:null,file_id:null,file_title:null})})},O.prototype.reportMsg=function(t,e,i){var r=this;this.preCallback&&this.preCallback(t),this.request.reportMsg(t,function(i){e&&e(i),r.callback&&r.callback(t,null)},function(e){i&&i(e),r.callback&&r.callback(t,e)})};var x=O,D={postMessage:function(t,e){t&&t.contentWindow&&t.contentWindow.postMessage(e,"*")},init:function(t,e){this.postMessage(t,{module:"tx_board_postmessage",cmd:"init",data:e},"*")},count:function(t){this.postMessage(t,{module:"tx_board_postmessage",cmd:"count"},"*")},getCurrentSlideIndex:function(t){this.postMessage(t,{module:"tx_board_postmessage",cmd:"current_slide_index"},"*")},getCurrentStepIndex:function(t){this.postMessage(t,{module:"tx_board_postmessage",cmd:"current_step_index"},"*")},getCurrentStepCount:function(t){this.postMessage(t,{module:"tx_board_postmessage",cmd:"current_step_count"},"*")},nextPage:function(t){this.postMessage(t,{module:"tx_board_postmessage",cmd:"next_page"},"*")},prevPage:function(t){this.postMessage(t,{module:"tx_board_postmessage",cmd:"prev_page"},"*")},gotoNextStep:function(t,e){this.postMessage(t,{module:"tx_board_postmessage",cmd:"next_step_new",data:e},"*")},gotoPreviousStep:function(t,e){this.postMessage(t,{module:"tx_board_postmessage",cmd:"prev_step_new",data:e},"*")},gotoSlide:function(t,e,i){this.postMessage(t,{module:"tx_board_postmessage",cmd:"goto_slide",data:{slideIndex:e,autoStart:i}},"*")},gotoTimestamp:function(t,e,i,r,o){this.postMessage(t,{module:"tx_board_postmessage",cmd:"goto_timestamp",data:{slideIndex:e,stepIndex:i,autoStart:r,timeOffset:o}},"*")},gotoTimestampNew:function(t,e){this.postMessage(t,{module:"tx_board_postmessage",cmd:"goto_timestamp_new",data:{slideIndex:e.slideIndex,stepIndex:e.stepIndex,resetStep:e.resetStep,usePrevNextStepMethod:e.usePrevNextStepMethod,isPassive:e.isPassive}},"*")},clearIframeCache:function(t){this.postMessage(t,{module:"tx_board_postmessage",cmd:"clear_cache"},"*")},setFid:function(t,e){this.postMessage(t,{module:"tx_board_postmessage",cmd:"set_fid",data:e},"*")},pptAction:function(t,e){this.postMessage(t,{module:"tx_board_postmessage",cmd:"ppt_action",data:e},"*")},sendMouseEvent:function(t,e){this.postMessage(t,{module:"tx_board_postmessage",cmd:"mouse_event",data:e},"*")}};function I(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var A=function(){function t(e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boardId=e||"",this.backgroundUrl="",i&&(this.backgroundUrl=i.url||""),this.backgroundColor=r||""}var e,i;return e=t,(i=[{key:"setBoardId",value:function(t){this.boardId=t}},{key:"setBackgroundUrl",value:function(t){this.backgroundUrl=t}},{key:"getBoardId",value:function(){return this.boardId}},{key:"getBackgroundUrl",value:function(){return this.backgroundUrl}},{key:"setBackgroundColor",value:function(t){this.backgroundColor=t}},{key:"getBackgroundColor",value:function(){return this.backgroundColor}}])&&I(e.prototype,i),t}(),R=1,w=3,C=5,P=6,B=7,L=8,N={TEDU_BOARD_ERROR_INIT:1,TEDU_BOARD_ERROR_AUTH:2,TEDU_BOARD_ERROR_LOAD:3,TEDU_BOARD_ERROR_UPLOAD:4,TEDU_BOARD_ERROR_TIM_INVALID:5,TEDU_BOARD_ERROR_HISTORYDATA:6,TEDU_BOARD_ERROR_RUNTIME:7,TEDU_BOARD_ERROR_AUTH_TIMEOUT:8,TEDU_BOARD_ERROR_DATA_TOO_LARGE:9},M={TEDU_BOARD_FILE_FIT_MODE_NONE:0,TEDU_BOARD_FILE_FIT_MODE_CENTER_INSIDE:1,TEDU_BOARD_FILE_FIT_MODE_CENTER_COVER:2},q={TEDU_BOARD_LINE_TYPE_SOLID:1,TEDU_BOARD_LINE_TYPE_DOTTED:2},F={TEDU_BOARD_ARROW_TYPE_NONE:1,TEDU_BOARD_ARROW_TYPE_NORMAL:2,TEDU_BOARD_ARROW_TYPE_SOLID:3};function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function H(t,e,i){return e&&U(t.prototype,e),i&&U(t,i),t}function G(t,e){return function(t){if(Array.isArray(t))return t}
/**
 *  @preserve  JavaScript implementation of
 *  Algorithm for Automatically Fitting Digitized Curves
 *  by Philip J. Schneider
 *  "Graphics Gems", Academic Press, 1990
 *
 *  The MIT License (MIT)
 *
 *  https://github.com/soswow/fit-curves
 */(t)||function(t,e){var i=[],r=!0,o=!1,n=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);r=!0);}catch(t){o=!0,n=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw n}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function V(t,e,i,r,o,n){var s,a,l,d=G(function(t,e,i){var r,o,n,s,a,l,d,u;o=0,n=t.length/2;var c=Y(e,10);for(a=0,l=t.length;a<l;a++)d=t[a],u=X(e,i[a],c,10),(r=(s=z.subtract(J.q(e,u),d))[0]*s[0]+s[1]*s[1])>o&&(o=r,n=a);return[o,n]}(t,s=function(t,e,i,r){var o,n,s,a,l,d,u,c,h,p,f,g,m,y,_,v,T,S=t[0],E=t[t.length-1];for(o=[S,null,null,E],n=z.zeros_Xx2x2(e.length),m=0,y=e.length;m<y;m++)T=1-(v=e[m]),(s=n[m])[0]=z.mulItems(i,3*v*(T*T)),s[1]=z.mulItems(r,3*T*(v*v));for(a=[[0,0],[0,0]],l=[0,0],m=0,y=t.length;m<y;m++)v=e[m],s=n[m],a[0][0]+=z.dot(s[0],s[0]),a[0][1]+=z.dot(s[0],s[1]),a[1][0]+=z.dot(s[0],s[1]),a[1][1]+=z.dot(s[1],s[1]),_=z.subtract(t[m],J.q([S,S,E,E],v)),l[0]+=z.dot(s[0],_),l[1]+=z.dot(s[1],_);return d=a[0][0]*a[1][1]-a[1][0]*a[0][1],u=a[0][0]*l[1]-a[1][0]*l[0],c=l[0]*a[1][1]-l[1]*a[0][1],p=0===d?0:u/d,(h=0===d?0:c/d)<(f=1e-6*(g=z.vectorLen(z.subtract(S,E))))||p<f?(o[1]=z.addArrays(S,z.mulItems(i,g/3)),o[2]=z.addArrays(E,z.mulItems(r,g/3))):(o[1]=z.addArrays(S,z.mulItems(i,h)),o[2]=z.addArrays(E,z.mulItems(r,p))),o}(t,i,r,o),e),2);return a=d[0],l=d[1],n&&n({bez:s,points:t,params:e,maxErr:a,maxPoint:l}),[s,a,l]}function W(t,e,i){return i.map(function(i,r){return function(t,e,i){var r=z.subtract(J.q(t,i),e),o=J.qprime(t,i),n=z.mulMatrix(r,o),s=z.sum(z.squareItems(o))+2*z.mulMatrix(r,J.qprimeprime(t,i));return 0===s?i:i-n/s}(t,e[r],i)})}i(123),i(124),i(126);var Y=function(t,e){for(var i,r=[0],o=t[0],n=0,s=1;s<=e;s++)i=J.q(t,s/e),n+=z.vectorLen(z.subtract(i,o)),r.push(n),o=i;return r.map(function(t){return t/n})};function X(t,e,i,r){if(e<0)return 0;if(e>1)return 1;for(var o,n,s,a,l=1;l<=r;l++)if(e<=i[l]){s=(l-1)/r,n=l/r,a=(e-(o=i[l-1]))/(i[l]-o)*(n-s)+s;break}return a}function j(t,e){return z.normalize(z.subtract(t,e))}var z=function(){function t(){k(this,t)}return H(t,null,[{key:"zeros_Xx2x2",value:function(t){for(var e=[];t--;)e.push([0,0]);return e}},{key:"mulItems",value:function(t,e){return t.map(function(t){return t*e})}},{key:"mulMatrix",value:function(t,e){return t.reduce(function(t,i,r){return t+i*e[r]},0)}},{key:"subtract",value:function(t,e){return t.map(function(t,i){return t-e[i]})}},{key:"addArrays",value:function(t,e){return t.map(function(t,i){return t+e[i]})}},{key:"addItems",value:function(t,e){return t.map(function(t){return t+e})}},{key:"sum",value:function(t){return t.reduce(function(t,e){return t+e})}},{key:"dot",value:function(e,i){return t.mulMatrix(e,i)}},{key:"vectorLen",value:function(t){return Math.hypot.apply(Math,function(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(t))}},{key:"divItems",value:function(t,e){return t.map(function(t){return t/e})}},{key:"squareItems",value:function(t){return t.map(function(t){return t*t})}},{key:"normalize",value:function(t){return this.divItems(t,this.vectorLen(t))}}]),t}(),J=function(){function t(){k(this,t)}return H(t,null,[{key:"q",value:function(t,e){var i=1-e,r=z.mulItems(t[0],i*i*i),o=z.mulItems(t[1],3*i*i*e),n=z.mulItems(t[2],3*i*e*e),s=z.mulItems(t[3],e*e*e);return z.addArrays(z.addArrays(r,o),z.addArrays(n,s))}},{key:"qprime",value:function(t,e){var i=1-e,r=z.mulItems(z.subtract(t[1],t[0]),3*i*i),o=z.mulItems(z.subtract(t[2],t[1]),6*i*e),n=z.mulItems(z.subtract(t[3],t[2]),3*e*e);return z.addArrays(z.addArrays(r,o),n)}},{key:"qprimeprime",value:function(t,e){return z.addArrays(z.mulItems(z.addArrays(z.subtract(t[2],z.mulItems(t[1],2)),t[0]),6*(1-e)),z.mulItems(z.addArrays(z.subtract(t[3],z.mulItems(t[2],2)),t[1]),6*e))}}]),t}(),K=function(t,e,i){if(!Array.isArray(t))return[];var r=!0;if(t.forEach(function(e){Array.isArray(e)&&!e.some(function(t){return"number"!=typeof t})&&e.length===t[0].length||(r=!1)}),!r)return[];if((t=t.filter(function(e,i){return 0===i||!e.every(function(e,r){return e===t[i-1][r]})})).length<2)return[];var o=t.length,n=j(t[1],t[0]),s=j(t[o-2],t[o-1]);return function t(e,i,r,o,n){var s,a,l,d,u,c,h,p,f,g,m,y,_;if(2===e.length)return y=z.vectorLen(z.subtract(e[0],e[1]))/3,[s=[e[0],z.addArrays(e[0],z.mulItems(i,y)),z.addArrays(e[1],z.mulItems(r,y)),e[1]]];a=function(t){var e,i,r,o=[];return t.forEach(function(t,n){e=n?i+z.vectorLen(z.subtract(t,r)):0,o.push(e),i=e,r=t}),o=o.map(function(t){return t/i})}(e);var v=G(V(e,a,a,i,r,n),3);if(s=v[0],d=v[1],c=v[2],d<o)return[s];if(d<o*o)for(l=a,u=d,h=c,_=0;_<20;_++){var T=G(V(e,a,l=W(s,e,l),i,r,n),3);if(s=T[0],d=T[1],c=T[2],d<o)return[s];if(c===h){var S=d/u;if(S>.9999&&S<1.0001)break}u=d,h=c}if(m=[],(p=z.subtract(e[c-1],e[c+1])).every(function(t){return 0===t})){var E=[-(p=z.subtract(e[c-1],e[c]))[1],p[0]];p[0]=E[0],p[1]=E[1]}return f=z.normalize(p),g=z.mulItems(f,-1),(m=m.concat(t(e.slice(0,c+1),i,f,o,n))).concat(t(e.slice(c),g,r,o,n))}(t,n,s,e,i)};function Z(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.action=o.PROTOCOL_ACTION.BOARD_MOVE_SCALE_ACTION,this.scale=e.scale,this.xOffsetRatio=e.xOffsetRatio,this.yOffsetRatio=e.yOffsetRatio,this.xOffset=e.xOffset,this.yOffset=e.yOffset}var e,i;return e=t,(i=[{key:"update",value:function(t){Object.assign(this,t),this.scale=Math.floor(this.scale)}},{key:"getReportData",value:function(){return{updateTime:d.getSecondTime(),xOffset:Number(this.xOffset.toFixed(4)),yOffset:Number(this.yOffset.toFixed(4)),scale:Math.floor(this.scale)}}},{key:"getRealTimeData",value:function(){return{action:this.action,time:d.getTimeStamp(),seq:l.getSeq(),scale:Math.floor(this.scale),xOffset:Number(this.xOffset.toFixed(4)),yOffset:Number(this.yOffset.toFixed(4))}}}])&&Z(e.prototype,i),t}();function Q(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var tt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={}}var e,i;return e=t,(i=[{key:"addDragData",value:function(t,e){this.data[t]||(this.data[t]=e)}},{key:"getDragData",value:function(t){return this.data[t]}},{key:"updateDragData",value:function(t,e){this.data[t].update(e)}}])&&Q(e.prototype,i),t}(),et={TEDU_BOARD_OVAL_DRAW_MODE_FIX_START:1,TEDU_BOARD_OVAL_DRAW_MODE_FIX_CENTER:2},it={TEDU_BOARD_VIDEO_STATUS_ERROR:1,TEDU_BOARD_VIDEO_STATUS_LOADING:2,TEDU_BOARD_VIDEO_STATUS_LOADED:3,TEDU_BOARD_VIDEO_STATUS_PLAYED:4,TEDU_BOARD_VIDEO_STATUS_TIMEUPDATE:5,TEDU_BOARD_VIDEO_STATUS_PAUSED:6,TEDU_BOARD_VIDEO_STATUS_SEEKED:7,TEDU_BOARD_VIDEO_STATUS_ENDED:8};function rt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ot=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boardId=e.boardId,this.type="imageElement",this.show=e.show,this.user=e.user,this.belongSeq=e.belongSeq,this.seq=e.seq,this.url=e.url,this.width=e.width,this.height=e.height,this.time=e.time||d.getTimeStamp(),this.x=e.x||0,this.y=e.y||0,this.focusStatus="blur",this.container=null,this.boardWidth=0,this.boardHeight=0,this.rectArea={maxX:0,maxY:0,minX:0,minY:0}}var e,i;return e=t,(i=[{key:"setBoardSize",value:function(t,e){this.boardWidth=t,this.boardHeight=e,this.left=this.boardWidth*this.x/1e4,this.top=this.boardHeight*this.y/1e4}},{key:"getImageSize",value:function(t,e,i,r){var o=this;this.boardWidth=t,this.boardHeight=e;var n=new Image;n.onload=function(s){n.onload=null;var a=0,l=0;n.naturalWidth<=t&&n.naturalHeight<=e?(a=n.naturalWidth,l=n.naturalHeight):t/e>n.naturalWidth/n.naturalHeight?(a=n.naturalWidth*e/n.naturalHeight,l=e,a/=2,l/=2):(a=t,l=n.naturalHeight*t/n.naturalWidth,a/=2,l/=2),i/=100,o.width=1e4*a/o.boardWidth/i,o.height=1e4*l/o.boardHeight/i,o.x=5e3-o.width/2,o.y=5e3-o.height/2,r&&r()},n.src=this.url}},{key:"getRealTimeData",value:function(){return{action:o.PROTOCOL_ACTION.IMAGE_ELEMENT,seq:l.getSeq(),belongSeq:this.belongSeq,url:this.url,time:this.time,show:this.show,x:1*this.x.toFixed(4),y:1*this.y.toFixed(4),width:1*this.width.toFixed(4),height:1*this.height.toFixed(4)}}},{key:"getReportData",value:function(){return{uid:this.user,boardId:this.boardId,belongSeq:this.belongSeq,url:this.url,time:this.time,x:1*this.x.toFixed(4),y:1*this.y.toFixed(4),width:1*this.width.toFixed(4),height:1*this.height.toFixed(4),updateTime:d.getTimeStamp(),hidden:1*!this.show}}},{key:"renderTo",value:function(t){this.container=t;var e="tic_image_element_".concat(this.belongSeq),i=t.querySelector("#".concat(e));if(i)this.left=this.x*this.boardWidth/1e4,this.top=this.y*this.boardHeight/1e4,i.style.left=this.left+"px",i.style.top=this.top+"px",i.style.width=this.width*this.boardWidth/1e4+"px",i.style.height=this.height*this.boardHeight/1e4+"px",this.imageWrap=i;else{var r=document.createElement("img");r.src=this.url,r.dataset.belongSeq=this.belongSeq,r.dataset.imageElement=!0,r.setAttribute("style","width:100%;height:100%;"),(i=document.createElement("div")).dataset.belongSeq=this.belongSeq,i.dataset.imageElement=!0,i.dataset.boardId=this.boardId,i.id=e,i.setAttribute("style","position:absolute;left:".concat(this.left,"px;top:").concat(this.top,"px;margin:0;padding:0;width:").concat(this.width*this.boardWidth/1e4,"px;height:").concat(this.height*this.boardHeight/1e4,"px;border:1px dotted transparent;cursor:move;")),i.appendChild(r),t.appendChild(i),this.imageWrap=i}this._updateRectArea()}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t){var r=24e4/this.boardWidth,o=24e4/this.boardHeight;this.width<=r&&(e=0),this.height<=o&&(i=0)}this.left+=e,this.top+=i,this.x=1e4*this.left/this.boardWidth,this.y=1e4*this.top/this.boardHeight,this.imageWrap.style.left=this.left+"px",this.imageWrap.style.top=this.top+"px",this._updateRectArea()}},{key:"setSize",value:function(t,e){this.width+=1e4*t/this.boardWidth,this.height+=1e4*e/this.boardHeight;var i=24e4/this.boardWidth,r=24e4/this.boardHeight;this.width=Math.max(i,this.width),this.height=Math.max(r,this.height),this.imageWrap.style.width=this.width*this.boardWidth/1e4+"px",this.imageWrap.style.height=this.height*this.boardHeight/1e4+"px",this._updateRectArea()}},{key:"_updateRectArea",value:function(){this.rectArea={minX:this.x,minY:this.y,maxX:this.x+this.width,maxY:this.y+this.height}}},{key:"getRealSize",value:function(){return{left:this.left,top:this.top,width:this.width*this.boardWidth/1e4,height:this.height*this.boardHeight/1e4}}},{key:"remove",value:function(){this.imageWrap&&this.imageWrap.remove()}}])&&rt(e.prototype,i),t}();function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t){var e=this;this.event=t.event,this.options=JSON.parse(JSON.stringify(t)),this.maxSeq=0,this.maxAddTextSeq=0,this.maxMoveSeq=0,this.maxVideoSeq=0,this.maxImageElementSeq=0,this.seqFilter={},this.laserData=[],this.maxLaserSeq=0,this.request=new S(t),this.report=new x(this.request),this.report.setCallback(function(t,i){i||e.addReportAckData(t)}),this.report.setPreCallback(function(t){e.addReportAckData(t,!1)}),this.permissions=0,this.accessibleUsers=[],"[object Undefined]"===Object.prototype.toString.call(t.syncHistroyEnable)||"[object Null]"===Object.prototype.toString.call(t.syncHistroyEnable)?this.syncHistroyEnable=!0:this.syncHistroyEnable=t.syncHistroyEnable,this.identifier=t.tlsData.identifier,this.classId=t.classId,this.user=t.tlsData.identifier,this.data={},this.progressEnable=o.PROGRESS_ENABLE,this.opData={},this.opIndex={},this.userData={},this.backgroundPic={},this.backgroundColor={},this.pptFilePreloaded={},this.boardRatio={},this.dragDataList=new tt,this.scale=this.options.scale||o.SCALE,this.ratio=this.options.ratio||o.RATIO,this.currentGroup=null,this.currentBoard=null,this.boardList=[],this.groups=[],this.drawEnable=!0,this.color=0,this.thin=0,this.typeFace=o.TEXT_FONT_FAMILY,this.textSize=0,this.textColor="",this.fontStyle=o.TEXT_FONT_STYLE.NORMAL,this.smoothLevel=0,this.dataSyncEnable=!1,this.preloadDepth=0,this.globalBackgroundColor=0,this.lineStyle={lineType:q.TEDU_BOARD_LINE_TYPE_SOLID,startArrowType:F.TEDU_BOARD_ARROW_TYPE_NONE,endArrowType:F.TEDU_BOARD_ARROW_TYPE_NONE},this.ovalDrawMode=et.TEDU_BOARD_OVAL_DRAW_MODE_FIX_START,this.ovalCenterPoint=null,this.type=n.BOARD_ACTION_TYPE.LINE,this.transparent=!1,this.seq=0,this.selectedList=[],this.selectArea={},this.gSeq=0,this.boardIdSeq=0,this.belongLineSeq=0,this.realTimeData=[],this.reportAckDatas={},this.sendAckDatas={},this.beforeMoveType="",this.containerWidth=0,this.containerHeight=0,this.boardWidth=0,this.boardHeight=0,this.boardContentFitMode=0,this.imageTimeout=o.IMAGE_TIMEOUT,this.faceData=[],this.textInputTask=null,this.lastInputActionData=null,this.drawRaserTask=null,this.sendInterval=null,this.cosData={cosAppId:null,cosBucket:null},_.setSdkAppid(t.tlsData.sdkAppId),_.setRoomId(this.classId),_.setUserId(t.tlsData.identifier),this.heartbeat=new b({newEnterId:this.options.newEnterId,classId:this.classId,request:this.request}),this.applyPermissions(),this.initInterval()}st.prototype.initFont=function(){var t=this;this.request.requestFont().then(function(e){t.setNeedDraw(!0)}).catch(function(){t.setNeedDraw(!0)})},st.prototype.applyPermissions=function(){var t=this,e=d.getTimeStamp();this.request.applyPermissions().then(function(i){if(t.permissions=0,0===i.data.error_code){var r=d.getTimeStamp();if(i.data.level)return window.performance&&window.performance.now?(l.performanceNow=window.performance.now(),l.serverTime=i.data.server_time+Math.floor((r-e)/2)):(l.localTime=d.getTimeStamp(),l.serverTime=i.data.server_time+Math.floor((r-e)/2),l.localServerTimeDiff=l.localTime-l.serverTime),t.cosData={cosAppId:i.data.cos_appid,cosBucket:i.data.cos_bucket},t.permissions=i.data.level,t.request.setPermissions(t.permissions),t.setDefaultBoard(),t.initData(t.options),_.report("verify_sdk",{time_consume:d.getTimeStamp()-e,extra_info:JSON.stringify({permissions:t.permissions})}),t.syncHistroyEnable&&t.classId&&t.syncHistroyData(),t.event.fire(t,"TEB_INIT"),t.heartbeat.start(),void t.setNeedDraw(!0);t.event.fire(t,"TEB_ERROR",N.TEDU_BOARD_ERROR_AUTH,"please purchase the service first"),_.report("verify_sdk",{action_result:i.data.error_code,action_info:JSON.stringify(i.data),time_consume:d.getTimeStamp()-e,extra_info:JSON.stringify({permissions:t.permissions})})}else void 0!==i.data.error_code&&0!=i.data.error_code?(t.event.fire(t,"TEB_ERROR",N.TEDU_BOARD_ERROR_RUNTIME,i.data.error_msg),_.report("verify_sdk",{action_result:i.data.error_code,action_info:JSON.stringify(i.data),time_consume:d.getTimeStamp()-e,extra_info:JSON.stringify({permissions:t.permissions,message:i.data.error_msg})})):void 0!==i.data.ErrorCode?(60008===i.data.ErrorCode?t.event.fire(t,"TEB_ERROR",N.TEDU_BOARD_ERROR_AUTH_TIMEOUT,"the request has timed out. please try again"):t.event.fire(t,"TEB_ERROR",N.TEDU_BOARD_ERROR_RUNTIME,i.data.ErrorMsg),_.report("verify_sdk",{action_result:i.data.ErrorCode,action_info:JSON.stringify(i.data),time_consume:d.getTimeStamp()-e,extra_info:JSON.stringify({permissions:t.permissions})})):(t.event.fire(t,"TEB_ERROR",N.TEDU_BOARD_ERROR_RUNTIME,"server error"),_.report("verify_sdk",{action_result:-9999,action_info:JSON.stringify(i.data),time_consume:d.getTimeStamp()-e,extra_info:JSON.stringify({permissions:t.permissions})}));t.permissions=0,t.request.setPermissions(t.permissions)},function(i){t.permissions=0,t.request.setPermissions(t.permissions),t.event.fire(t,"TEB_ERROR",N.TEDU_BOARD_ERROR_AUTH_TIMEOUT,"the request has timed out. please try again"),_.report("verify_sdk",{action_result:-9998,action_info:JSON.stringify(i),time_consume:d.getTimeStamp()-e,extra_info:JSON.stringify({permissions:t.permissions})})})},st.prototype.createBoardIdForFile=function(t,e,i,r,o){for(var n=1,s=[],a=0;a<r;a++){var l="".concat(o,"_").concat(e,"_").concat(i,"_").concat(n++,"_").concat(t);s.push(l)}return s},st.prototype.createBoardId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentGroup,e=arguments.length>1?arguments[1]:void 0;return 0==this.boardIdSeq?(this.boardIdSeq++,o.COMMON_DEFAULT_BOARD):(o.COMMON_GROUP,"".concat(o.PLATFORM,"_").concat(this.identifier,"_").concat(e||d.getSecondTime(),"_").concat(this.boardIdSeq++,"_").concat(t))},st.prototype.initInterval=function(){var t=this;this.sendInterval=setInterval(function(){t.realTimeData.length>0&&t.sendRequest()},200),this.drawRaserTask=setInterval(function(){t.laserData=t.laserData.sort(function(t,e){return t.seq-e.seq});var e=t.laserData.shift();e&&t.event.fire(t,"draw_laser",e)},20)},st.prototype.resetData=function(){this.data={},this.opData={},this.opIndex={},this.userData={},this.backgroundPic={},this.backgroundColor={},this.currentGroup=null,this.currentBoard=null,this.boardList=[],this.groups=[],this.seq=0,this.maxSeq=0,this.maxAddTextSeq=0,this.maxMoveSeq=0,this.maxVideoSeq=0,this.maxImageElementSeq=0,this.maxLaserSeq=0,this.seqFilter={},this.selectedList=[],this.selectArea={},this.gSeq=0,this.boardIdSeq=0,this.belongLineSeq=0,this.realTimeData=[],this.beforeMoveType="",this.setDefaultBoard()},st.prototype.initData=function(t){var e=this;"[object Undefined]"!==Object.prototype.toString.call(t.drawEnable)&&"[object Null]"!==Object.prototype.toString.call(t.drawEnable)||(t.drawEnable=!0),this.setDrawEnable(t.drawEnable),this.setProgressEnable(t.progressEnable),this.setColor(t.brushColor),this.setThin(t.brushThin),this.setTextFontFamily(t.textFamily),this.setTextSize(t.textSize),this.setTextColor(t.textColor),this.setTextFontStyle(t.textStyle),this.setSmoothLevel(t.smoothLevel),this.setDataSyncEnable(t.dataSyncEnable),this.setPreloadDepth(t.preloadDepth),this.setBoardContentFitMode(t.boardContentFitMode,!1),this.setImageTimeout(t.imageTimeout||o.IMAGE_TIMEOUT),"[object Undefined]"!==Object.prototype.toString.call(t.toolType)&&"[object Null]"!==Object.prototype.toString.call(t.toolType)||(t.toolType=1),this.setType(n.BOARD_ACTION_TYPE[["MOUSE","LINE","ERASER","RASER","GRAPH-LINE","GRAPH-OVAL","GRAPH-RECT","GRAPH-OVAL-SOLID","GRAPH-RECT-SOLID","POINTSELECT","SELECT","INPUTTEXT","ZOOM"][t.toolType]]),this.setGlobalBackgroundColor(t.globalBackgroundColor,!0),this.setTransparent(t.transparent),this.setSelectArea(),setTimeout(function(){e.event.fire(e,"TEB_OPERATE_CANREDO_STATUS_CHANGED",e.canRedo()),e.event.fire(e,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",e.canUndo())},500)},st.prototype.addBoard=function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];if(Array.isArray(t))r=t;else{if(!t)return;r=[t]}var s={};for(var a in r.forEach(function(t,i){e.userData[t]={},e.userData[t][e.identifier]=[],e.data[t]=[],e.opData[t]=[],e.opIndex[t]=0,e.backgroundColor[t]=e.globalBackgroundColor,e.backgroundPic[t]={url:"",user:t===o.COMMON_DEFAULT_BOARD?e.identifier:d.boardId2Uid(t),show:!0,mode:n.FILL_MODE.DEFAULT,type:n.BACKGROUND_TYPE.IMAGE},-1===e.boardList.indexOf(t)&&e.boardList.push(t);var r=d.boardId2Fid(t);s[r]||(s[r]=[]),s[r].push(t)}),s)this.event.fire(this,"TEB_ADDBOARD",s[a],a);return this.sortBoard(),i&&this.report.reportCreateBoards(this.currentBoard,r),this.boardList},st.prototype.findLine=function(t,e,i){for(var r,o=this.userData[t][e],n=0,s=o.length;n<s;n++){var a=o[n];if("line"===a.type&&a.seq==i.belongSeq){r=a;break}}return r},st.prototype.setNeedDraw=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.needDraw=t},st.prototype.getNeedDraw=function(){return this.needDraw},st.prototype.getBoardList=function(){return this.boardList},st.prototype.getBoardPicList=function(){return this.backgroundPic},st.prototype.setDefaultBoard=function(){this.currentGroup=o.COMMON_GROUP;var t=d.getSecondTime();this.addGroup(o.COMMON_GROUP,o.COMMON_GROUP,this.user,null,1,0,t,o.PLATFORM,o.FILE_TYPE.IMG,0),this.currentBoard=this.createBoardId(),this.addBoard(this.currentBoard,!1),this.setBackgroundColor(d.formatColor(this.globalBackgroundColor),!0),delete this.setDefaultBoard},st.prototype.removeBoard=function(t){Array.isArray(t)||(t=[t]);for(var e=[],i=[],r=!1,n={},s=0,a=t.length;s<a;s++){var l,u=t[s];if(u!==o.COMMON_DEFAULT_BOARD&&(l=this.boardList.indexOf(u))>-1){e.push(u);var c=d.boardId2Fid(u);if(n[c]||(n[c]=[]),n[c].push(u),delete this.userData[u],delete this.data[u],delete this.opData[u],delete this.opIndex[u],delete this.backgroundColor[u],delete this.backgroundPic[u],u==this.currentBoard){r=!0;var h=this.getBoardByGroup(this.currentGroup),p=h.indexOf(u);if(this.currentBoard=0===p?h[p+1]:h[p-1],!this.currentBoard){var f=this.getBoardByGroup(o.COMMON_GROUP);this.currentBoard=f[this.getFileInfo(o.COMMON_GROUP).currentPageIndex]}}this.boardList.splice(l,1);var g=d.boardId2Fid(u),m=this.getBoardByGroup(g),y=this.getFileInfo(g);0===m.length?y&&(this.deleteGroup(g),i.push(g)):y&&(y.pageCount=y.pageCount-1,y.pageCount===y.currentPageIndex&&(y.currentPageIndex=y.currentPageIndex-1),this.updateFileInfo(y))}}var _=d.boardId2Fid(this.currentBoard),v=this.getBoardByGroup(_);for(var T in(y=this.getFileInfo(_))&&(y.pageCount=v.length,y.currentPageIndex=v.indexOf(this.currentBoard),this.updateFileInfo(y)),this.currentGroup=d.boardId2Fid(this.currentBoard),n)this.event.fire(this,"TEB_DELETEBOARD",n[T],T);return r&&this.event.fire(this,"TEB_GOTOBOARD",this.currentBoard,d.boardId2Fid(this.currentBoard)),this.setNeedDraw(!0),{deleteBoards:e,deleteFids:i}},st.prototype.deleteBoard=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentBoard,e=arguments.length>1?arguments[1]:void 0,i=this.removeBoard(t)||[],r=i.deleteBoards,n=i.deleteFids;if(r.length){var s=this.backgroundPic[this.currentBoard]?this.backgroundPic[this.currentBoard].url:"";s&&this.addRealtimeData({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:s,time:d.getTimeStamp(),seq:l.getSeq(),mode:this.backgroundPic[this.currentBoard].mode,type:this.backgroundPic[this.currentBoard].type,cleanBoard:0});var a=[];e?n.indexOf(e)>-1?a=n:a.push(e):a=n;var u=this.getBoardByGroup(this.currentGroup),c=u.indexOf(this.currentBoard),h=l.getSeq();this.addRealtimeData({action:o.PROTOCOL_ACTION.SWITCH_ACTION,time:d.getTimeStamp(),seq:h,toBoardId:this.currentBoard,deleteBoards:a.length?[]:r,deleteFiles:a.length?a:[],page:c,step:0}),this.maxSeq=h,this.sendRequest(),this.report.reportDeleteBoard(r,this.currentBoard);var p=this.getFileInfo(this.currentGroup);p.currentPageIndex=c,p.currentPageStep=0,p.pageCount=u.length,this.report.reportAddFile(p),this.report.reportSwitchBoard({boardId:this.currentBoard,fid:p.fid,url:p.downloadURL,type:p.type,page:p.currentPageIndex,step:p.currentPageStep,ratio:p.ratio,scale:p.scale})}return r},st.prototype.getGroup=function(){var t=this,e=Object.assign([],this.groups);return e.forEach(function(e){var i=[];(t.getBoardByGroup(e.fid)||[]).forEach(function(e){var r=new A(e,t.backgroundPic[e],t.backgroundColor[e]);i.push(r)}),e.boardInfoList=i}),e},st.prototype.getFileInfo=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.COMMON_GROUP,e=null,i=this.getGroup(),r=0,n=i.length;r<n;r++){var s=i[r];if(t===s.fid){e=s;break}}return e},st.prototype.getBoardByGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.COMMON_GROUP;return this.boardList.filter(function(e){return t===o.COMMON_GROUP&&e===o.COMMON_DEFAULT_BOARD||e.indexOf("_".concat(t))>-1})},st.prototype.addGroupNotReport=function(t,e,i,r,n,s,a){for(var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:o.PLATFORM,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:o.FILE_TYPE.IMG,u=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0,h=arguments.length>11?arguments[11]:void 0,p=arguments.length>12?arguments[12]:void 0,f=arguments.length>13?arguments[13]:void 0,g=arguments.length>14?arguments[14]:void 0,m=!1,y=0,v=this.groups.length;y<v;y++)if(this.groups[y].fid==t){m=!0;break}if(m)return this.groups;var T={fid:t,title:e||t,downloadURL:r,pageCount:n,currentPageIndex:s,currentPageStep:u,uid:i,timestamp:a,platform:l,ratio:c,type:d,scale:h,status:f,progress:g};this.groups.push(T),p?this.event.fire(this,"TEB_ADDTRANSCODEFILE",t):d==o.FILE_TYPE.IMG?this.event.fire(this,"TEB_ADDFILE",t):d==o.FILE_TYPE.IMAGESFILE?(this.event.fire(this,"TEB_ADDIMAGESFILE",t),_.report("add_images_file_event_peer",{extra_info:JSON.stringify({fid:t})})):this.event.fire(this,"TEB_ADDH5PPTFILE",t)},st.prototype.addGroup=function(t,e,i,r,n,s,a){for(var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:o.PLATFORM,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:o.FILE_TYPE.IMG,u=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0,h=arguments.length>11?arguments[11]:void 0,p=arguments.length>12?arguments[12]:void 0,f=!1,g=0,m=this.groups.length;g<m;g++)if(this.groups[g].fid==t){f=!0;break}if(f)return this.groups;var y={fid:t,title:e||t,downloadURL:r,pageCount:n,currentPageIndex:s,currentPageStep:u,uid:i,timestamp:a,platform:l,ratio:c,type:d,scale:h,isTranscodeFile:!!p,progress:0,status:0};t&&t!==o.COMMON_GROUP&&this.report.reportAddFile(y),this.groups.push(y),p?this.event.fire(this,"TEB_ADDTRANSCODEFILE",t):d==o.FILE_TYPE.IMG?this.event.fire(this,"TEB_ADDFILE",t):d==o.FILE_TYPE.IMAGESFILE?(this.event.fire(this,"TEB_ADDIMAGESFILE",t),_.report("add_images_file_event_myself",{extra_info:JSON.stringify({fid:t})})):this.event.fire(this,"TEB_ADDH5PPTFILE",t)},st.prototype.deleteGroup=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t===o.COMMON_GROUP)return[];for(var i=-1,r=0,n=this.groups.length;r<n;r++)if(this.groups[r].fid==t){i=r;break}return i>-1&&(this.groups.splice(i,1),D.clearIframeCache(this.iframeDom)),e&&this.report.reportDeleteFile(t),this.getBoardByGroup(t)},st.prototype.setDrawEnable=function(t){this.drawEnable=!!t,_.report("call_method",{extra_info:JSON.stringify({method:"setDrawEnable",data:this.drawEnable})})},st.prototype.isDrawEnable=function(t){return this.drawEnable},st.prototype.setColor=function(t){t||(t=n.COLOR.RED),this.cancelSelect(),"number"==typeof t?this.color=d.dealColor(t):"string"!=typeof t||0!=t.indexOf("#")||4!==t.length&&7!==t.length?"string"==typeof t&&t.startsWith("rgba(")&&(this.color=t):this.color=d.hexToRgba(t)},st.prototype.getColor=function(){return this.color},st.prototype.setThin=function(t){t||(t=o.THIN),this.cancelSelect(),this.thin=t},st.prototype.getThin=function(){return this.thin},st.prototype.setSmoothLevel=function(t){"[object Undefined]"!==Object.prototype.toString.call(t)&&"[object Null]"!==Object.prototype.toString.call(t)||(t=o.SMOOTH_LEVEL),t=Math.max(0,Math.min(1,t)),this.smoothLevel=t},st.prototype.getSmoothLevel=function(){return this.smoothLevel},st.prototype.setTextSize=function(t){t||(t=o.TEXT_SIZE),this.cancelSelect(),this.textSize=t},st.prototype.getTextSize=function(){return this.textSize},st.prototype.setTextColor=function(t){t||(t=o.TEXT_COLOR),this.cancelSelect(),"number"==typeof t?this.textColor=d.dealColor(t):"string"!=typeof t||0!=t.indexOf("#")||4!==t.length&&7!==t.length?"string"==typeof t&&t.startsWith("rgba(")&&(this.textColor=t):this.textColor=d.hexToRgba(t)},st.prototype.getTextColor=function(){return this.textColor},st.prototype.setTextFontFamily=function(t){this.typeFace=o.TEXT_FONT_FAMILY},st.prototype.getTextFontFamily=function(){return this.typeFace},st.prototype.setTextFontStyle=function(t){t||(t=o.TEXT_FONT_STYLE.NORMAL),this.cancelSelect(),this.fontStyle=t},st.prototype.getTextFontStyle=function(){return this.fontStyle},st.prototype.setDataSyncEnable=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.DATA_SYNC_ENABLE;this.request.setReportEnable(t),this.dataSyncEnable=t,_.report("call_method",{extra_info:JSON.stringify({method:"setDataSyncEnable",data:t})})},st.prototype.isDataSyncEnable=function(){return this.dataSyncEnable},st.prototype.setAccessibleUsers=function(t){this.accessibleUsers=t||[]},st.prototype.setProgressEnable=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.PROGRESS_ENABLE;this.progressEnable=t},st.prototype.isProgressEnable=function(){return this.progressEnable},st.prototype.setPreloadDepth=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.PRELOAD_DEPTH;this.preloadDepth=t},st.prototype.setType=function(t){var e=Object.values(n.BOARD_ACTION_TYPE);this.cancelSelect(),e.indexOf(t)>-1?this.type=t:this.type=n.BOARD_ACTION_TYPE.LINE,_.report("call_method",{extra_info:JSON.stringify({method:"setType",data:t})})},st.prototype.getType=function(){return this.type},st.prototype.setTransparent=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.transparent=t},st.prototype.getTransparent=function(){return this.transparent},st.prototype.setBackgroundColor=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.COLOR.WHITE,e=arguments.length>1?arguments[1]:void 0,i=this.currentBoard;"object"===nt(t)&&(i=t.boardId,t=t.color);var r=0;"number"==typeof t?(this.backgroundColor[i]=d.dealColor(t),r=t):"string"!=typeof t||0!=t.indexOf("#")||4!==t.length&&7!==t.length?"string"==typeof t&&t.startsWith("rgba(")&&(this.backgroundColor[i]=t,r=d.formatColor(t)):(this.backgroundColor[i]=d.hexToRgba(t),r=d.formatColor(d.hexToRgba(t))),this.setNeedDraw(!0),e||(this.addRealtimeData({action:o.PROTOCOL_ACTION.UPDATE_BG_COLOR_ACTION,time:d.getTimeStamp(),seq:l.getSeq(),color:r,isGlobal:0}),this.report.reportSetBoardBgColor(i,r))},st.prototype.getBackgroundColor=function(){return this.backgroundColor[this.getCurrentBoard()]},st.prototype.setSelectArea=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.selectArea={x:t,y:e,width:i,height:r}},st.prototype.getSelectArea=function(){return this.selectArea},st.prototype.getCurrentBoard=function(){return this.currentBoard},st.prototype.getCurrentFile=function(){return this.currentGroup},st.prototype.getData=function(){return this.data},st.prototype.getFaceData=function(){var t,e,i=this.getCurrentBoardData(),r=this.faceData.pop();if(r&&r.content&&r.content.fid){var n=r.content;if(n.type===o.FILE_TYPE.IMG){t={downloadURL:n.url,currentPageIndex:n.page,currentPageStep:n.step,type:n.type,fid:n.fid,ratio:n.ratio};var s="";n.url&&((s=d.fileDownLoadUrlToPreviewUrl(n.url)).endsWith("/")?s+=n.page+1+".jpg":s+=n.page+1),e={mode:0,show:!0,type:0,url:s}}else n.type===o.FILE_TYPE.H5PPT&&(t={downloadURL:n.url,currentPageIndex:n.page,currentPageStep:n.step,type:n.type,fid:n.fid,ratio:n.ratio},e={mode:0,show:!0,type:0,url:""})}return this.faceData=[],{fileInfo:t,backgroundColor:i.backgroundColor,currentPic:e,data:i.data}},st.prototype.getCurrentBoardData=function(){return{data:this.data[this.currentBoard],userData:this.userData[this.currentBoard],opData:this.opData[this.currentBoard],opIndex:this.opIndex[this.currentBoard],backgroundPic:this.backgroundPic[this.currentBoard],backgroundColor:this.backgroundColor[this.currentBoard],ratio:this.boardRatio[this.currentBoard],scale:this.getBoardScale()}},st.prototype.getCurrentBoardPic=function(){return this.backgroundPic[this.currentBoard]},st.prototype.getCurrentBoardColor=function(){return this.backgroundColor[this.currentBoard]},st.prototype.getSelectList=function(){return this.selectedList},st.prototype.clearBoard=function(t,e,i){if(this.currentBoard){if(e){var r=this.getType();"select"!==r&&"pointselect"!==r||(this.deleteSelectedData(),this.event.fire(this,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",this.canUndo()),this.event.fire(this,"TEB_OPERATE_CANREDO_STATUS_CHANGED",this.canRedo()))}else{if(!i&&this.accessibleUsers&&this.accessibleUsers.length>0)this.deleteBoardData();else{for(var s=0,a=this.data[this.currentBoard].length;s<a;s++){var l=this.data[this.currentBoard][s];if("imageElement"===l.type)l.remove();else if("inputtext"===l.type){var d=document.getElementById("tic-textarea__".concat(l.belongSeq));d&&(d.value="",d.blur(),d.remove())}}this.data[this.currentBoard]=[],this.opData[this.currentBoard]=[],this.opIndex[this.currentBoard]=0,this.userData[this.currentBoard]={},this.userData[this.currentBoard][this.identifier]=[],t&&(this.getCurrentFile()===o.COMMON_GROUP&&(this.backgroundPic[this.currentBoard]={show:!1,mode:n.FILL_MODE.DEFAULT,url:"",type:n.BACKGROUND_TYPE.IMAGE,user:""}),this.backgroundColor[this.currentBoard]=this.globalBackgroundColor)}this.cancelSelect()}this.setNeedDraw(!0)}},st.prototype.clear=function(t,e){e?this.clearBoard(!1,!0):this.accessibleUsers&&this.accessibleUsers.length>0?this.clearBoard(!1,!1):t?(this.clearBoard(!0,!1),this.addRealtimeData({action:101,seq:l.getSeq()}),this.report.reportClear(this.currentBoard)):(this.clearBoard(!1,!1),this.addRealtimeData({action:102,seq:l.getSeq()}),this.report.reportClearDraws(this.currentBoard))},st.prototype.clearFileDrawData=function(t){var e=this;t.forEach(function(t){(e.getBoardByGroup(t)||[]).forEach(function(t){for(var i=0,r=e.data[t].length;i<r;i++){var o=e.data[t][i];if("imageElement"===o.type)o.remove();else if("inputtext"===o.type){var n=document.getElementById("tic-textarea__".concat(o.belongSeq));n&&(n.value="",n.blur(),n.remove())}}e.data[t]=[],e.opData[t]=[],e.opIndex[t]=0,e.userData[t]={},e.userData[t][e.identifier]=[]})}),this.cancelSelect(),this.setNeedDraw(!0)},st.prototype.clearFileDraws=function(t){var e=this;if(t){Array.isArray(t)||(t=[t]),this.clearFileDrawData(t);var i=[];t.forEach(function(t){i=i.concat(e.getBoardByGroup(t))}),this.addRealtimeData({action:o.PROTOCOL_ACTION.FILE_CLEAR_ACTION,seq:l.getSeq(),fids:t}),this.report.reportClearDraws(i)}},st.prototype.clearAll=function(){this.report.reportCleanAll(),this.addRealtimeData({action:o.PROTOCOL_ACTION.RESET_DATA_ACTION,seq:l.getSeq()}),this.sendRequest(),this.resetData()},st.prototype.addBackgroundPic=function(t){var e=this,i=t.boardIds,r=t.urls,s=t.type,a=void 0===s?n.BACKGROUND_TYPE.IMAGE:s,u=t.needReport,c=void 0===u||u,h=t.position,p=void 0===h?n.FILL_MODE.DEFAULT:h,f=[],g=[];if(Array.isArray(i)){if(!Array.isArray(r)||i.length!=r.length)return!1;f=i,g=r}else{if(Array.isArray(r))return!1;f=[i],g=[r]}var m=[];this.cancelSelect(),f.forEach(function(t,i){t===e.currentBoard&&c&&e.addRealtimeData({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:encodeURI(g[i]),time:d.getTimeStamp(),seq:l.getSeq(),mode:p,type:a,cleanBoard:0}),e.data[t]||e.addBoard(t),e.backgroundPic[t].url=g[i],e.backgroundPic[t].show=!0,e.backgroundPic[t].mode=p,e.backgroundPic[t].type=a,m.push({type:"image",seq:l.getSeq(),content:{fid:d.boardId2Fid(t),boardId:t,url:g[i],updateTime:d.getTimeStamp(),type:a,mode:p}})}),c&&this.report.reportImages(m),this.setNeedDraw(!0)},st.prototype.setBackgroundPic=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.FILL_MODE.DEFAULT,r=d.boardId2Fid(t);e&&r==o.COMMON_GROUP&&(this.cancelSelect(),this.addBackgroundPic({boardIds:t||this.currentBoard,urls:e,type:n.BACKGROUND_TYPE.IMAGE,needReport:!1,position:i}),this.sendRequest(t,[{action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:e,time:d.getTimeStamp(),seq:l.getSeq(),mode:i,type:n.BACKGROUND_TYPE.IMAGE,cleanBoard:0}]),this.report.reportImage(t||this.currentBoard,e,i))},st.prototype.setBackgroundH5=function(t){t&&this.currentGroup==o.COMMON_GROUP&&(this.cancelSelect(),this.addBackgroundPic({boardIds:this.currentBoard,urls:t,type:n.BACKGROUND_TYPE.H5,needReport:!1}),this.addRealtimeData({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:t,time:d.getTimeStamp(),seq:l.getSeq(),mode:n.FILL_MODE.DEFAULT,type:n.BACKGROUND_TYPE.H5,cleanBoard:0}),this.report.reportImage(this.currentBoard,t,n.FILL_MODE.DEFAULT,n.BACKGROUND_TYPE.H5))},st.prototype.updateCurrentFillMode=function(t){var e=this.backgroundPic[this.currentBoard];e&&e.url&&this.setBackgroundPic(this.currentBoard,e.url,t)},st.prototype.deleteBackgroundPic=function(t){this.cancelSelect(),this.backgroundPic[t].show=!1,this.setNeedDraw(!0)},st.prototype.cancelBackgroundPic=function(){this.cancelSelect(),this.deleteBackgroundPic(this.currentBoard),this.img.style.display="none",this.addRealtimeData({action:o.PROTOCOL_ACTION.DELETE_BG_IMG_ACTION,seq:this.getSeq()}),this.report.reportImage(this.currentBoard,"",0)},st.prototype.clearGlobalBgColor=function(){this.setGlobalBackgroundColor(this.options.globalBackgroundColor)},st.prototype.updateVideo=function(t,e,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=this.getFileInfo(t);this.cancelSelect(),e>=0&&(n.status=e),i>=0&&(n.progress=i);var s=d.getTimeStamp();n.timestamp=s,r&&(this.addRealtimeData({action:o.PROTOCOL_ACTION.VIDEO_EVENT_ACTION,time:s,seq:l.getSeq(),fid:t,status:n.status,progress:n.progress}),this.sendRequest(),this.report.reportAddFile(n))},st.prototype.switchPage=function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t=(e=this.getBoardByGroup(this.getCurrentFile()))[i=Math.min(i,e.length-1)],this.switchBoard(t)},st.prototype.switchH5Board=function(t){var e=t.fid,i=t.slideIndex,r=t.stepIndex,n=t.resetStep,s=t.usePrevNextStepMethod;this.cancelSelect();var a=this.getBoardByGroup(e),u=this.getFileInfo(e),c=a[i],h=!1;if(c!==this.currentBoard&&(h=!0),this.currentBoard=c,this.currentGroup=e,u.currentPageIndex===i&&u.currentPageStep==Math.max(0,r))return c;u.currentPageIndex=i,u.currentPageStep=Math.max(0,r),u.pageCount=a.length;var p=this.backgroundPic[this.currentBoard]?this.backgroundPic[this.currentBoard].url:"";p&&this.addRealtimeData({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:p,time:d.getTimeStamp(),seq:l.getSeq(),mode:this.backgroundPic[this.currentBoard].mode,type:this.backgroundPic[this.currentBoard].type,cleanBoard:0});var f=l.getSeq();return this.addRealtimeData({action:o.PROTOCOL_ACTION.SWITCH_ACTION,time:d.getTimeStamp(),seq:f,toBoardId:c,deleteBoards:[],deleteFiles:[],page:u.currentPageIndex,step:r,resetStep:n,usePrevNextStepMethod:s}),this.maxSeq=f,this.sendRequest(),this.report.reportSwitchBoard({boardId:c,fid:u.fid,url:u.downloadURL,type:u.type,page:u.currentPageIndex,step:u.currentPageStep,ratio:u.ratio,scale:u.scale}),this.report.reportAddFile(u),h&&this.event.fire(this,"TEB_GOTOBOARD",c,e),this.setNeedDraw(!0),c},st.prototype.switchBoard=function(t){if(this.cancelSelect(),t&&!this.data[t])return!1;t||(t=this.createBoardId(),this.addBoard(t)),this.currentBoard=t,this.currentGroup=d.boardId2Fid(t);var e=this.getBoardByGroup(this.currentGroup),i=this.getFileInfo(this.currentGroup),r=e.indexOf(t),n=i.currentPageStep;i.currentPageIndex=r,i.currentPageStep=n,i.pageCount=e.length;var s=this.backgroundPic[this.currentBoard]?this.backgroundPic[this.currentBoard].url:"";s&&this.addRealtimeData({action:o.PROTOCOL_ACTION.UPDATE_BG_IMG_ACTION,url:s,time:d.getTimeStamp(),seq:l.getSeq(),mode:this.backgroundPic[this.currentBoard].mode,type:this.backgroundPic[this.currentBoard].type,cleanBoard:0});var a=l.getSeq();return this.addRealtimeData({action:o.PROTOCOL_ACTION.SWITCH_ACTION,time:d.getTimeStamp(),seq:a,toBoardId:t,deleteBoards:[],deleteFiles:[],page:i.currentPageIndex,step:n}),this.maxSeq=a,this.sendRequest(),this.report.reportSwitchBoard({boardId:t,fid:i.fid,url:i.downloadURL,type:i.type,page:i.currentPageIndex,step:i.currentPageStep,ratio:i.ratio,scale:i.scale}),this.report.reportAddFile(i),this.event.fire(this,"TEB_GOTOBOARD",this.currentBoard,d.boardId2Fid(this.currentBoard)),this.setNeedDraw(!0),t},st.prototype.setGlobalBackgroundColor=function(t,e){var i=this;t||(t=n.COLOR.WHITE);var r=0;"number"==typeof t?(this.globalBackgroundColor=d.dealColor(t),r=t):"string"!=typeof t||0!=t.indexOf("#")||4!==t.length&&7!==t.length?"string"==typeof t&&t.startsWith("rgba(")&&(this.globalBackgroundColor=t,r=d.formatColor(t)):(this.globalBackgroundColor=d.hexToRgba(t),r=d.formatColor(d.hexToRgba(t))),this.boardList.forEach(function(t){i.backgroundColor[t]=i.globalBackgroundColor}),this.setNeedDraw(!0),e||(this.addRealtimeData({action:o.PROTOCOL_ACTION.UPDATE_BG_COLOR_ACTION,time:d.getTimeStamp(),seq:l.getSeq(),color:r,isGlobal:1}),this.report.reportGlobalBgColor(r))},st.prototype.getGlobalBackgroundColor=function(){return this.globalBackgroundColor},st.prototype.preloadBoard=function(){for(var t=[],e=0;e<this.groups.length;++e){var i=this.groups[e];if(i.type==o.FILE_TYPE.IMG){var r=this.getBoardByGroup(i.fid);t=t.concat(r)}else if(i.type==o.FILE_TYPE.H5&&!this.pptFilePreloaded[i.fid]){if(i.fid===this.currentGroup){this.pptFilePreloaded[i.fid]=!0;continue}!function(t,e){setTimeout(function(){var e=document.createElement("iframe");e.setAttribute("style","position:fixed;visibility:hidden;width:0px;height:0px;border:none;"),document.body.appendChild(e),e.onload=function(){setTimeout(function(){e.remove()},100)},e.setAttribute("src",t)},1e3)}(i.downloadURL+"?page=".concat(i.currentPageIndex,"&step=").concat(i.currentPageStep,"&fid=").concat(encodeURIComponent(i.fid))),this.pptFilePreloaded[i.fid]=!0}}if(0!==t.length)for(var s=t.indexOf(this.currentBoard),a=-this.preloadDepth;a<this.preloadDepth;++a){var l=s+a;if(!(l<0||l>=t.length)){var d=t[l],u=this.backgroundPic[d];if(u&&!u.preloaded&&void 0!==u.url&&""!==u.url){if(0===a){u.preloaded=!0;continue}u.type===n.BACKGROUND_TYPE.IMAGE?function(t,e){setTimeout(function(){var e=new Image;e.onload=function(){},e.onabort=function(){},e.onerror=function(){},e.src=t},e)}(u.url,200*(Math.abs(a)-1)):u.type===n.BACKGROUND_TYPE.H5&&function(t,e){setTimeout(function(){var e=document.createElement("iframe");e.setAttribute("style","position:fixed;visibility:hidden;width:0px;height:0px;border:none;"),document.body.appendChild(e),e.onload=function(){e.remove()},e.setAttribute("src",t)},e)}(u.url,200*(Math.abs(a)-1)),u.preloaded=!0}}}},st.prototype.resetOperation=function(){this.opData[this.currentBoard]=this.opData[this.currentBoard].slice(0,this.opIndex[this.currentBoard])},st.prototype.collectLineData=function(){var t=this;return{start:function(e,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=l.getSeq();t.belongLineSeq=n;var s=new h(t.identifier,{color:t.color,thin:t.thin,x:e,y:i,w:t.thin,writing:r,show:!0,seq:n,belongSeq:n});t.userData[t.currentBoard][t.identifier].push(s),t.data[t.currentBoard].push(s),t.opData[t.currentBoard].push(new u(t.identifier,{seq:s.seq,type:t.type})),t.opIndex[t.currentBoard]++;var a={action:o.PROTOCOL_ACTION.LINE_START_ACTION,color:d.formatColor(s.color),scale:100,thin:s.thin,time:d.getTimeStamp(),seq:s.seq,belongSeq:s.belongSeq,x:e,y:i,w:s.thin,writing:r?1:0};t.addRealtimeData(a)},draw:function(e,i,r){var n=t.userData[t.currentBoard][t.identifier].length,s=t.userData[t.currentBoard][t.identifier][n-1];s.setBorder(e,i);var a=l.getSeq();s.lines.push({x:e,y:i,w:r,seq:a});var d={action:o.PROTOCOL_ACTION.LINE_MOVE_ACTION,seq:a,belongSeq:t.belongLineSeq,x:e,y:i,w:r};t.addRealtimeData(d)},end:function(e,i,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=t.userData[t.currentBoard][t.identifier].length,a=t.userData[t.currentBoard][t.identifier][s-1];a.setBorder(e,i);var u=l.getSeq();if(a.lines.push({x:e,y:i,w:r,seq:u}),a.endSeq=u,t.smoothLevel>0){var c=[];a.lines.forEach(function(t){c.push([t.x,t.y])}),a.fitCurve=K(c,1e4*t.smoothLevel,null)}var h={action:o.PROTOCOL_ACTION.LINE_END_ACTION,belongSeq:t.belongLineSeq,seq:u,x:e,y:i,w:r};t.addRealtimeData(h);var p=[];a.lines.forEach(function(t){p.push({seq:t.seq,x:t.x,y:t.y,w:t.w})}),t.report.reportAddLine({belongSeq:t.belongLineSeq,boardId:t.currentBoard,uid:a.user,colorRGBA:d.formatColor(t.color),scale:100,width:t.thin,writing:n?1:0,time:a.time,updateTime:d.getTimeStamp(),seq:a.seq,hidden:0,points:p})},over:function(t,e){this.end(t,e,this.thin)}}},st.prototype.collectTextInputData=function(){var t=this;return{start:function(e,i){var r,o=l.getSeq();try{var n=t.data[t.currentBoard],s={seq:0,index:-1};if(n.forEach(function(r,o){if("inputtext"===r.type&&r.show&&r.user===t.identifier){var n=5/t.boardWidth*1e4,a=5/t.boardHeight*1e4,l=r.location.x-n,d=r.location.y-a,u=r.location.x+r.textWidth+n,c=r.location.y+r.textHeight+a;e>=l&&e<=u&&i>=d&&i<=c&&r.belongSeq>s.seq&&(s={seq:r.belongSeq,index:o})}}),s.index>-1){var a=t.data[t.currentBoard].splice(s.index,1)[0];a.show=!0,r=a,(t.userData[t.currentBoard][t.identifier]||[]).forEach(function(e,i){e.belongSeq===r.belongSeq&&t.userData[t.currentBoard][t.identifier].splice(i,1)})}}catch(t){}r||((r=new p(t.identifier,{x:e,y:i,belongSeq:o})).color=t.getTextColor(),r.textSize=t.getTextSize(),r.typeFace=t.getTextFontFamily(),r.fontStyle=t.getTextFontStyle()),t.userData[t.currentBoard][t.identifier].push(r),t.data[t.currentBoard].push(r);for(var d=!1,c=0,h=t.opData[t.currentBoard].length;c<h;c++)if(t.opData[t.currentBoard][c].seq===r.belongSeq){d=!0;break}return d||(t.opData[t.currentBoard].push(new u(t.identifier,{seq:r.belongSeq,type:t.type})),t.opIndex[t.currentBoard]++),clearInterval(t.textInputTask),t.textInputTask=null,t.lastInputActionData=null,r},inputting:function(e,i,r,n,s){var a=l.getSeq(),u=e.boardId||t.currentBoard;if(t.userData[u][t.identifier].length,i){i.text=r,i.seq=a,i.textWidth=n/t.boardWidth*1e4,i.textHeight=s/t.boardHeight*1e4;var c={action:o.PROTOCOL_ACTION.INPUT_TEXT_ACTION,seq:a,belongSeq:i.belongSeq,color:d.formatColor(i.color),scale:100,typeFace:i.typeFace,textSize:Math.floor(i.textSize),fontStyle:i.fontStyle,time:d.getTimeStamp(),x:i.location.x,y:i.location.y,text:encodeURI(escape(r)),textWidth:i.textWidth,textHeight:i.textHeight};t.realTimeData=t.realTimeData.filter(function(t){return t.action!==o.PROTOCOL_ACTION.INPUT_TEXT_ACTION||t.belongSeq!==i.belongSeq}),t.addRealtimeData(c),t.lastInputActionData=c,function(e){t.textInputTask||(t.textInputTask=setInterval(function(){if(e!=t.getCurrentBoard())return clearInterval(t.textInputTask),void(t.textInputTask=null);t.realTimeData=t.realTimeData.filter(function(e){return e.action!==o.PROTOCOL_ACTION.INPUT_TEXT_ACTION||e.belongSeq!==t.lastInputActionData.belongSeq}),t.lastInputActionData.seq=l.getSeq(),t.addRealtimeData(t.lastInputActionData)},3e3))}(u)}},draw:function(e,i,r,n,s){clearInterval(t.textInputTask),t.textInputTask=null,t.lastInputActionData=null;var a=e.boardId||t.currentBoard,u=t.userData[a][t.identifier].length;if(!r&&!r.trim()){for(var c=-1,h=0,p=t.opData[a].length;h<p;h++)if(t.opData[a][h].seq===i.belongSeq){c=h;break}return c>-1&&(t.opData[a].splice(c,1),t.opIndex[a]--),t.userData[a][t.identifier].splice(u-1,1),void t.data[a].splice(t.data[a].length-1,1)}if(i){var f=l.getSeq();i.seq=f,i.text=r,i.show=!0,i.textWidth=n/t.boardWidth*1e4,i.textHeight=s/t.boardHeight*1e4,t.report.reportAddText({belongSeq:i.belongSeq,time:i.time,boardId:a,uid:i.user,x:Math.floor(i.location.x),y:Math.floor(i.location.y),colorRGBA:d.formatColor(i.color),scale:100,updateTime:d.getTimeStamp(),hidden:0,typeface:i.typeFace,textSize:Math.floor(i.textSize),fontStyle:i.fontStyle,text:encodeURI(escape(r)),text_wh:"".concat(i.textWidth,",").concat(i.textHeight)});var g={action:o.PROTOCOL_ACTION.INPUT_TEXT_ACTION,seq:i.seq,belongSeq:i.belongSeq,color:d.formatColor(i.color),scale:100,typeFace:i.typeFace,textSize:Math.floor(i.textSize),fontStyle:i.fontStyle,time:d.getTimeStamp(),x:i.location.x,y:i.location.y,text:encodeURI(escape(r)),textWidth:i.textWidth,textHeight:i.textHeight};t.sendRequest(a,[g]),t.setNeedDraw(!0)}},clearTask:function(){clearInterval(t.textInputTask),t.textInputTask=null,t.lastInputActionData=null}}},st.prototype.collectEraserData=function(t,e){var i=this.eraserImpactCheck(t,e,this.thin/2);if(i.length>0){this.opData[this.currentBoard].push(new u(this.identifier,{seq:i,type:this.type})),this.opIndex[this.currentBoard]++;var r={action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),x:0,y:0,lines:i};i.length&&(this.addRealtimeData(r),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:i})),this.setNeedDraw(!0)}},st.prototype.collectRaserData=function(){var t=this;return{start:function(e,i,r){var s=new m(t.identifier,{color:d.dealColor(n.COLOR.RED),radius:t.thin/2,x:e,y:i,seq:l.getSeq(),toolType:r}),a={action:o.PROTOCOL_ACTION.RASER_SHOW_ACTION,r:s.radius,seq:s.seq,x:e,y:i,toolType:r};t.addRealtimeData(a),t.event.fire(t,"draw_laser",s)},draw:function(e,i,r){var s=new m(t.identifier,{color:d.dealColor(n.COLOR.RED),radius:t.thin/2,x:e,y:i,seq:l.getSeq(),toolType:r});t.event.fire(t,"draw_laser",s),t.addRealtimeData({action:o.PROTOCOL_ACTION.RASER_SHOW_ACTION,seq:s.seq,x:e,y:i,r:s.radius,toolType:r})},end:function(e,i,r){var s=new m(t.identifier,{color:d.dealColor(n.COLOR.RED),radius:t.thin/2,x:e,y:i,seq:l.getSeq(),toolType:r});s.status=0;var a={action:o.PROTOCOL_ACTION.RASER_HIDE_ACTION,seq:s.seq};t.addRealtimeData(a),t.event.fire(t,"draw_laser",s)},over:function(){this.end(0,0)}}},st.prototype.collectSelectData=function(){var t=this;return{start:function(e,i){t.beforeMoveType="select";var r=new g(t.identifier,{startx:e,starty:i,x:e,y:i});t.seq=r.seq,t.userData[t.currentBoard][t.identifier].push(r),t.data[t.currentBoard].push(r)},draw:function(e,i){var r=t.userData[t.currentBoard][t.identifier].length;t.userData[t.currentBoard][t.identifier][r-1].location={x:e,y:i},t.setNeedDraw(!0)},end:function(e,i,r,o){for(var n=0,s=e>r?e:r,a=i>o?i:o,l=e+r-s,d=i+o-a,u=1e4,c=1e4,h=0,p=0,f=t.data[t.currentBoard].length-1;f>=0;f--){var g=t.data[t.currentBoard][f];if(!(t.accessibleUsers&&t.accessibleUsers.length>0)||t.accessibleUsers.includes(g.user))if("line"==g.type&&g.show)s>=g.border.maxX&&a>=g.border.maxY&&l<=g.border.minX&&d<=g.border.minY&&(g.select=!0,t.selectedList.push(g),u=(u=u<g.border.minX?u:g.border.minX)<g.border.maxX?u:g.border.maxX,c=(c=c<g.border.minY?c:g.border.minY)<g.border.maxY?c:g.border.maxY,h=(h=h>g.border.minX?h:g.border.minX)>g.border.maxX?h:g.border.maxX,p=(p=p>g.border.minY?p:g.border.minY)>g.border.maxY?p:g.border.maxY);else if("graph"==g.type&&g.show)s>=g.endPoint.x&&a>=g.endPoint.y&&l<=g.startPoint.x&&d<=g.startPoint.y&&(g.select=!0,t.selectedList.push(g),u=(u=u<g.startPoint.x?u:g.startPoint.x-g.thin)<g.endPoint.x?u:g.endPoint.x-g.thin,c=(c=c<g.startPoint.y?c:g.startPoint.y-g.thin)<g.endPoint.y?c:g.endPoint.y-g.thin,h=(h=h>g.startPoint.x?h:g.startPoint.x+g.thin)>g.endPoint.x?h:g.endPoint.x+g.thin,p=(p=p>g.startPoint.y?p:g.startPoint.y+g.thin)>g.endPoint.y?p:g.endPoint.y+g.thin);else if("inputtext"==g.type&&g.show&&g.text){var m=g.location.x,y=g.location.y,_=g.location.x+g.textWidth,v=g.location.y+g.textHeight;s>=_&&a>=v&&l<=m&&d<=y&&(g.select=!0,t.selectedList.push(g),u=(u=u<g.location.x?u:g.location.x)<_?u:_,c=(c=c<g.location.y?c:g.location.y)<v?c:v,h=(h=h>g.location.x?h:g.location.x)>_?h:_,p=(p=p>g.location.y?p:g.location.y)>v?p:v)}else"imageElement"==g.type&&g.show&&s>=g.rectArea.maxX&&a>=g.rectArea.maxY&&l<=g.rectArea.minX&&d<=g.rectArea.minY&&(++n,t.selectedList.push(g))}t.selectedList.length>0&&(t.selectedList.length===n?t.selectArea={x:-10,y:-10,width:0,height:0}:t.selectArea={x:u,y:c,width:h-u,height:p-c}),t.userData[t.currentBoard][t.identifier][t.userData[t.currentBoard][t.identifier].length-1].show=!1,t.setNeedDraw(!0)}}},st.prototype.collectPointSelectData=function(t,e){this.beforeMoveType="pointselect";for(var i=!1,r=1e4,o=1e4,n=0,s=0,a=this.data[this.currentBoard].length-1;a>=0;a--){var l=this.data[this.currentBoard][a];if(!(this.accessibleUsers&&this.accessibleUsers.length>0)||this.accessibleUsers.includes(l.user))if("line"==l.type&&l.show){if(t<l.border.maxX&&t>l.border.minX&&e<l.border.maxY&&e>l.border.minY){i=!0,l.select=!0,this.selectedList=[l],r=(r=r<l.border.minX?r:l.border.minX)<l.border.maxX?r:l.border.maxX,o=(o=o<l.border.minY?o:l.border.minY)<l.border.maxY?o:l.border.maxY,n=(n=n>l.border.minX?n:l.border.minX)>l.border.maxX?n:l.border.maxX,s=(s=s>l.border.minY?s:l.border.minY)>l.border.maxY?s:l.border.maxY;break}}else if("graph"==l.type&&l.show){var d=l.endPoint.x,u=l.endPoint.y,c=l.startPoint.x,h=l.startPoint.y;if(d<c&&(d+=c,d-=c=d-c),u<h&&(u+=h,u-=h=u-h),u+=this.thin,d+=this.thin,c-=this.thin,h-=this.thin,t>=c&&t<=d&&e>=h&&e<=u){i=!0,l.select=!0,this.selectedList=[l],r=(r=r<l.startPoint.x?r:l.startPoint.x-l.thin)<l.endPoint.x?r:l.endPoint.x-l.thin,o=(o=o<l.startPoint.y?o:l.startPoint.y-l.thin)<l.endPoint.y?o:l.endPoint.y-l.thin,n=(n=n>l.startPoint.x?n:l.startPoint.x+l.thin)>l.endPoint.x?n:l.endPoint.x+l.thin,s=(s=s>l.startPoint.y?s:l.startPoint.y+l.thin)>l.endPoint.y?s:l.endPoint.y+l.thin;break}}else if("inputtext"===l.type&&l.show&&l.text){var p=5/this.boardWidth*1e4,f=5/this.boardHeight*1e4,g=l.location.x-p,m=l.location.y-f,y=l.location.x+l.textWidth+p,_=l.location.y+l.textHeight+f;if(t>=g&&t<=y&&e>=m&&e<=_){i=!0,l.select=!0,this.selectedList=[l],r=(r=r<l.location.x?r:l.location.x)<y?r:y,o=(o=o<l.location.y?o:l.location.y)<_?o:_,n=(n=n>l.location.x?n:l.location.x)>y?n:y,s=(s=s>l.location.y?s:l.location.y)>_?s:_;break}}else if("imageElement"===l.type&&l.show&&t<l.rectArea.maxX&&t>l.rectArea.minX&&e<l.rectArea.maxY&&e>l.rectArea.minY){i=!0,this.selectedList=[l],r=0,r=0,o=0,o=0,n=0,n=0,s=0,s=0;break}}i&&(this.selectArea={x:r,y:o,width:n-r,height:s-o},this.setNeedDraw(!0))},st.prototype.collectMoverData=function(){var t=this;return{beforeStart:function(e,i){if(0==t.selectedList.length)return!1;for(var r=!1,o=0;o<t.selectedList.length;o++){var n=t.selectedList[o];if("line"==n.type){var s=1.5*t.thin,a=1.5*t.thin;if(n.border.minX-s<=e&&n.border.maxX+s>=e&&n.border.minY-a<=i&&n.border.maxY+a>=i){r=!0;break}}else if("graph"==n.type){var l=n.startPoint.x,d=n.endPoint.x,u=n.startPoint.y,c=n.endPoint.y;if(d<l&&(d+=l,d-=l=d-l),c<u&&(c+=u,c-=u=c-u),c+=t.thin,d+=t.thin,u-=t.thin,(l-=t.thin)<=e&&d>=e&&u<=i&&c>=i){r=!0;break}}else if("inputtext"===n.type){var h=5/t.boardWidth*1e4,p=5/t.boardHeight*1e4,f=n.location.x-h,g=n.location.y-p,m=n.location.x+n.textWidth+h,y=n.location.y+n.textHeight+p;if(e>=f&&e<=m&&i>=g&&i<=y){r=!0;break}}}return!!r||(t.cancelSelect(),!1)},start:function(e,i){var r=[];t.selectedList.forEach(function(t){"line"==t.type?r.push({uid:t.user,seq:t.seq,x:t.lines[0].x,y:t.lines[0].y}):"graph"==t.type?r.push({uid:t.user,seq:t.startPoint.seq,x:t.startPoint.x,y:t.startPoint.y}):"inputtext"==t.type&&r.push({uid:t.user,seq:t.belongSeq,x:t.location.x,y:t.location.y})}),t.opData[t.currentBoard].push(new u(t.identifier,{seq:{origin:r,final:[]},type:"move"}))},draw:function(e,i,r,o){if(t.selectedList.length>0){for(var n=0;n<t.selectedList.length;n++){var s=t.selectedList[n],a=e-r,l=i-o;"line"==s.type?(s.border.maxX+=a,s.border.minX+=a,s.border.maxY+=l,s.border.minY+=l,s.lines.forEach(function(t){t.x+=a,t.y+=l}),0!==s.fitCurve.length&&s.fitCurve.forEach(function(t){t[1][0]+=a,t[1][1]+=l,t[2][0]+=a,t[2][1]+=l,t[3][0]+=a,t[3][1]+=l})):"graph"==s.type?(s.startPoint.x+=a,s.startPoint.y+=l,s.endPoint.x+=a,s.endPoint.y+=l):"inputtext"===s.type&&(s.location.x+=a,s.location.y+=l)}t.selectArea.x+=a,t.selectArea.y+=l,t.setNeedDraw(!0)}},end:function(){t.setNeedDraw(!0);var e=[];if(0!=t.selectedList.length){t.selectedList.forEach(function(t){"line"==t.type?e.push({seq:t.seq,x:t.lines[0].x,y:t.lines[0].y,uid:t.user}):"graph"==t.type?e.push({seq:t.startPoint.seq,x:t.startPoint.x,y:t.startPoint.y,uid:t.user}):"inputtext"===t.type&&e.push({seq:t.belongSeq,x:t.location.x,y:t.location.y,uid:t.user})});var i={action:o.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,seq:l.getSeq(),moves:e,time:d.getTimeStamp()};t.addRealtimeData(i);var r=[];t.selectedList.forEach(function(t){"line"==t.type?r.push({uid:t.user,seq:t.seq,x:t.lines[0].x,y:t.lines[0].y}):"graph"==t.type?r.push({uid:t.user,seq:t.startPoint.seq,x:t.startPoint.x,y:t.startPoint.y}):"inputtext"===t.type&&r.push({uid:t.user,seq:t.belongSeq,x:t.location.x,y:t.location.y})}),t.opData[t.currentBoard][t.opData[t.currentBoard].length-1].seq.final=r,t.opIndex[t.currentBoard]++;var n=[];e.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r];if("line"==o.type&&e.seq==o.seq){var s=[];o.lines.forEach(function(t){s.push({seq:t.seq,x:t.x,y:t.y})}),n.push({type:"addLine",seq:l.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:d.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:d.getTimeStamp(),seq:o.seq,hidden:0,points:s}})}else if("graph"==o.type&&e.seq==o.startPoint.seq){var a={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:l.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:d.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:d.getTimeStamp(),hidden:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}};"oval"==o.graph||"circle"==o.graph?a.content.fillRect=o.solid?1:0:"rect"==o.graph&&(a.content.fillRect=o.solid?1:0,a.content.cornerRadius=0),n.push(a)}else"inputtext"===o.type&&e.seq==o.belongSeq&&n.push({type:"addText",seq:l.getSeq(),content:{belongSeq:o.belongSeq,time:d.getTimeStamp(),boardId:t.currentBoard,uid:o.user,x:o.location.x,y:o.location.y,colorRGBA:d.formatColor(o.color),scale:o.scale,updateTime:d.getTimeStamp(),hidden:0,typeface:o.typeFace,textSize:o.textSize,fontStyle:o.fontStyle,text:encodeURI(escape(o.text)),text_wh:"".concat(o.textWidth,",").concat(o.textHeight)}})}}),t.report.reportGraphData(n)}}}},st.prototype.collectGraphData=function(){var t=this;return{start:function(e,i){var r=t.type.split("-")[1],o=new f(t.identifier,{graph:r,color:t.color,thin:t.thin,seq:l.getSeq(),beginPoint:{x:e,y:i,seq:l.getSeq()},endPoint:{x:e,y:i,seq:l.getSeq()},show:!0,solid:t.type.indexOf("solid")>-1});"line"==o.graph&&(o.style=Object.assign({},t.lineStyle)),"circle"!=o.graph&&"oval"!=o.graph||t.ovalDrawMode!=et.TEDU_BOARD_OVAL_DRAW_MODE_FIX_CENTER||(t.ovalCenterPoint=Object.assign({},o.startPoint)),t.seq=o.seq,t.userData[t.currentBoard][t.identifier].push(o),t.data[t.currentBoard].push(o),t.opData[t.currentBoard].push(new u(t.identifier,{seq:o.startPoint.seq,type:"graph"})),t.opIndex[t.currentBoard]++},draw:function(e,i){var r=t.userData[t.currentBoard][t.identifier].length,o=t.userData[t.currentBoard][t.identifier][r-1];o.endPoint.x=e,o.endPoint.y=i,"circle"!=o.graph&&"oval"!=o.graph||t.ovalDrawMode!=et.TEDU_BOARD_OVAL_DRAW_MODE_FIX_CENTER||(o.startPoint.x=2*t.ovalCenterPoint.x-e,o.startPoint.y=2*t.ovalCenterPoint.y-i),"circle"==o.graph&&t.circleFix(o),t.setNeedDraw(!0)},end:function(e,i){var r=t.userData[t.currentBoard][t.identifier].length,o=t.userData[t.currentBoard][t.identifier][r-1];o.endPoint.x=e,o.endPoint.y=i,"circle"==o.graph&&t.circleFix(o),"line"!=o.graph&&t.graphFix(o),t.setNeedDraw(!0);var n={seq:o.seq,time:d.getTimeStamp(),color:d.formatColor(t.color),scale:100,thin:t.thin,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}};n.action={line:10,oval:11,circle:11,rect:12}[o.graph];var s={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:l.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:d.formatColor(t.color),scale:100,width:t.thin,time:o.time,updateTime:d.getTimeStamp(),hidden:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}},a=t.type.indexOf("solid")>-1?1:0;10==n.action&&(n.style=Object.assign({},t.lineStyle),s.content.style=Object.assign({},t.lineStyle)),11==n.action&&(n.fillRect=a,s.content.fillRect=a),12==n.action&&(n.fillRect=a,s.content.fillRect=a,n.cornerRadius=0,s.content.cornerRadius=0),t.addRealtimeData(n),t.report.reportGraphData([s])},over:function(t,e){this.end(t,e)}}},st.prototype.collectDragData=function(){var t=this;return{start:function(t){var e=t.currentTarget.getElementsByClassName("tx_board_canvas_box")[0];getComputedStyle(e).getPropertyValue("transform"),e.style.left,e.style.top},draw:function(e,i,r,o,n){var s,a,l,d,u=e.currentTarget.getElementsByClassName("tx_board_canvas_box")[0],c=r-n,h=(i-o)/t.boardWidth*100,p=c/t.boardHeight*100;t.boardWidth/t.boardHeight>t.containerWidth/t.containerHeight?(t.boardHeight>t.containerHeight?(l=50+(t.boardHeight-t.containerHeight)/2/t.boardHeight*100,d=50-(t.boardHeight-t.containerHeight)/2/t.boardHeight*100):(l=50,d=50),s=50+(t.boardWidth-t.containerWidth)/2/t.boardWidth*100,a=50-(t.boardWidth-t.containerWidth)/2/t.boardWidth*100):(l=50+(t.boardHeight-t.containerHeight)/2/t.boardHeight*100,d=50-(t.boardHeight-t.containerHeight)/2/t.boardHeight*100,t.boardWidth>t.containerWidth?(s=50+(t.boardWidth-t.containerWidth)/2/t.boardWidth*100,a=50-(t.boardWidth-t.containerWidth)/2/t.boardWidth*100):(s=50,a=50));var f=1*u.style.left.replace("%","")+h;f=Math.min(s,Math.max(a,f)),u.style.left=f+"%";var g=1*u.style.top.replace("%","")+p;g=Math.min(l,Math.max(d,g)),u.style.top=g+"%";var m=u.getAttribute("style");-1===m.indexOf("-webkit-transform")&&(m+="-webkit-transform: translateX(-50%) translateY(-50%);"),u.setAttribute("style",m),t.dragDataList.getDragData(t.currentBoard)?t.dragDataList.updateDragData(t.currentBoard,{xOffset:f,yOffset:g}):t.dragDataList.addDragData(t.currentBoard,new $({scale:t.getBoardScale(),xOffset:f,yOffset:g})),t.addRealtimeData(t.dragDataList.getDragData(t.currentBoard).getRealTimeData())},scaleDraw:function(e,i){if(i.length){var r,n=t.dragDataList.getDragData(t.currentBoard);n||(n=new $({scale:o.SCALE,xOffset:50,yOffset:50}),t.dragDataList.addDragData(t.currentBoard,n)),r=parseInt(e*i[i.length-1]),r=Math.max(o.MIN_SCALE,Math.min(o.MAX_SCALE,r)),n.scale=r,t.setNeedDraw(!0)}},end:function(){t.report.reportDrag(Object.assign(t.dragDataList.getDragData(t.currentBoard).getReportData(),{boardId:t.currentBoard}))},touchEnd:function(e){if(e.length){var i=t.dragDataList.getDragData(t.currentBoard);t.setBoardScale(i.scale)}else t.report.reportDrag(Object.assign(t.dragDataList.getDragData(t.currentBoard).getReportData(),{boardId:t.currentBoard}))},over:function(){t.report.reportDrag(Object.assign(t.dragDataList.getDragData(t.currentBoard).getReportData(),{boardId:t.currentBoard}))}}},st.prototype.cancelSelect=function(){for(var t=this.selectedList.length,e=0;e<t;e++)this.selectedList[e].select=!1;this.selectedList=[],this.selectArea={x:0,y:0,width:0,height:0},t&&this.setNeedDraw(!0)},st.prototype.deleteSelectedData=function(){var t=[];this.selectedList.forEach(function(e){"line"===e.type?t.push({uid:e.user,seq:e.seq}):"graph"===e.type?t.push({uid:e.user,seq:e.startPoint.seq}):"inputtext"===e.type&&t.push({uid:e.user,seq:e.belongSeq}),e.show=!1}),this.opData[this.currentBoard].push(new u(this.identifier,{seq:t,type:"delete"})),this.opIndex[this.currentBoard]++;var e={action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),x:0,y:0,lines:t};origin.length&&(this.addRealtimeData(e),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:t})),this.cancelSelect()},st.prototype.deleteBoardData=function(){var t=this,e=[];this.data[this.currentBoard].forEach(function(i){t.accessibleUsers&&t.accessibleUsers.length>0&&!t.accessibleUsers.includes(i.user)||("line"===i.type?e.push({uid:i.user,seq:i.seq}):"graph"===i.type?e.push({uid:i.user,seq:i.startPoint.seq}):"inputtext"===i.type&&e.push({uid:i.user,seq:i.belongSeq}),i.show=!1)});var i={action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),x:0,y:0,lines:e};origin.length&&(this.addRealtimeData(i),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:e}))},st.prototype.eraserImpactCheck=function(t,e,i){var r=this,o=[];return this.data[this.currentBoard].forEach(function(n){if(!(r.accessibleUsers&&r.accessibleUsers.length>0)||r.accessibleUsers.includes(n.user)){var s=n.thin/2;if("line"==n.type&&n.show){var a=n.border.maxX+s,l=n.border.maxY+s,d=n.border.minX-s,u=n.border.minY-s,c=0;if(t+i<d||t-i>a||e+i<u||e-i>l)return;var h=!1;if(1===n.lines.length){var p=n.lines[0];r.getDistance(t,e,p.x,p.y,p.x,p.y)<=(i+s)*(i+s)&&(h=!0)}else for(var f=1;f<n.lines.length;f++){var g=n.lines[f-1],m=n.lines[f];if(r.getDistance(t,e,g.x,g.y,m.x,m.y)<=(i+s)*(i+s)){h=!0;break}}h&&(n.show=!1,o.push({uid:n.user,seq:n.seq}))}else if("graph"==n.type&&n.show){if("line"==n.graph)(c=r.getDistance(t,e,n.startPoint.x,n.startPoint.y,n.endPoint.x,n.endPoint.y))<=(i+s)*(i+s)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}));else if("rect"==n.graph)if(n.solid)t>n.startPoint.x&&e>n.startPoint.y&&t<n.endPoint.x&&e<n.endPoint.y&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}));else{var y=r.getDistance(t,e,n.startPoint.x,n.startPoint.y,n.startPoint.x,n.endPoint.y),_=r.getDistance(t,e,n.startPoint.x,n.startPoint.y,n.endPoint.x,n.startPoint.y),v=r.getDistance(t,e,n.endPoint.x,n.endPoint.y,n.startPoint.x,n.endPoint.y),T=r.getDistance(t,e,n.endPoint.x,n.endPoint.y,n.endPoint.x,n.startPoint.y);Math.min(y,_,v,T)<=(i+s)*(i+s)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}))}else if("circle"==n.graph){var S=(n.startPoint.x+n.endPoint.x)/2,E=(n.startPoint.y+n.endPoint.y)/2,b=Math.sqrt(Math.pow(n.startPoint.x-n.endPoint.x,2)+Math.pow(n.startPoint.y-n.endPoint.y,2))/2;c=Math.sqrt(Math.pow(t-S,2)+Math.pow(e-E,2)),n.solid?c<b+i&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq})):Math.abs(b-c)<=i+s&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}))}else if("oval"==n.graph){var O=(n.startPoint.x+n.endPoint.x)/2,x=(n.startPoint.y+n.endPoint.y)/2,D=Math.abs(n.startPoint.x-n.endPoint.x)/2,I=Math.abs(n.startPoint.y-n.endPoint.y)/2;if(D===I&&0===D)return;var A=Math.pow(t-O,2)/Math.pow(D,2)+Math.pow(e-x,2)/Math.pow(I,2),R=Math.pow(t-O+s,2)/Math.pow(D,2)+Math.pow(e-x+s,2)/Math.pow(I,2),w=Math.pow(t-O+s,2)/Math.pow(D,2)+Math.pow(e-x-s,2)/Math.pow(I,2),C=Math.pow(t-O-s,2)/Math.pow(D,2)+Math.pow(e-x+s,2)/Math.pow(I,2),P=Math.pow(t-O-s,2)/Math.pow(D,2)+Math.pow(e-x-s,2)/Math.pow(I,2);n.solid?(A<=1.2||R<=1.2||w<=1.2||C<=1.2||P<=1.2)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq})):(A<=1.2&&A>=.8||R<=1.2&&R>=.8||w<=1.2&&w>=.8||C<=1.2&&C>=.8||P<=1.2&&P>=.8)&&(n.show=!1,o.push({uid:n.user,seq:n.startPoint.seq}))}}else if("inputtext"==n.type&&n.show){var B=n.location.x-0,L=n.location.y-0,N=n.location.x+n.textWidth+0,M=n.location.y+n.textHeight+0;t>B&&e>L&&t<N&&e<M&&(n.show=!1,o.push({uid:n.user,seq:n.belongSeq}))}else"imageElement"==n.type&&n.show&&t>n.rectArea.minX&&e>n.rectArea.minY&&t<n.rectArea.maxX&&e<n.rectArea.maxY&&(n.show=!1,o.push({uid:n.user,seq:n.belongSeq}))}}),o},st.prototype.getDistance=function(t,e,i,r,o,n){var s,a,l=o-i,d=n-r,u=l*l+d*d,c=-1;0!=u&&(c=((t-i)*l+(e-r)*d)/u),c<0?(s=i,a=r):c>1?(s=o,a=n):(s=i+c*l,a=r+c*d);var h=t-s,p=e-a;return h*h+p*p},st.prototype.circleFix=function(t){var e=Math.abs(t.startPoint.x-t.endPoint.x)*this.boardWidth/1e4,i=Math.abs(t.startPoint.y-t.endPoint.y)*this.boardHeight/1e4;e>i?(t.endPoint.x=t.startPoint.x<t.endPoint.x?t.startPoint.x+1e4*i/this.boardWidth:t.startPoint.x-1e4*i/this.boardWidth,t.endPoint.x=parseInt(t.endPoint.x)):(t.endPoint.y=t.startPoint.y<t.endPoint.y?t.startPoint.y+1e4*e/this.boardHeight:t.startPoint.y-1e4*e/this.boardHeight,t.endPoint.y=parseInt(t.endPoint.y))},st.prototype.graphFix=function(t){var e=t.startPoint.x,i=t.startPoint.y,r=t.endPoint.x,o=t.endPoint.y;t.startPoint={x:e>r?r:e,y:i>o?o:i,seq:t.startPoint.seq},t.endPoint={x:e>r?e:r,y:i>o?i:o,seq:t.endPoint.seq}},st.prototype.sendRequest=function(t,e){if(this.permissions){var i=JSON.parse(JSON.stringify(e||this.realTimeData));t=t||this.currentBoard,i.forEach(function(e,i){e.boardId=t});var r={seq:l.getSeq(),timestamp:d.getTimeStamp(),value:{boardId:t,operator:this.identifier,actions:i}};e||(this.realTimeData=[]),i.length&&(this.addSendAckData(r,!1),this.event.fire(this,"TEB_SYNCDATA",r))}},st.prototype.addHistory=function(t,e){var i=this,r=this;this.sortBoard(),t.forEach(function(t){var e,s;i.seqFilter[t.seq+""]=!0;try{t.content=JSON.parse(t.content)}catch(t){}if("setGlobalBG"===t.type);else if("createBoards"===t.type)t.content&&t.content.createBoards.forEach(function(t){(e=t)&&!r.userData[e]&&r.addBoard(e,!1)});else if("addFile"===t.type){for(var a=t.content.fid,l=t.content.title,u=t.content.downloadURL,c=t.content.pageCount,g=t.content.currentPageIndex,m=t.content.currentPageStep||0,y=t.content.timestamp,v=(t.content.updateTime,t.content.uid),T=t.content.platform,S=t.content.type,E=t.content.ratio,b=t.content.scale,O=t.content.status,x=t.content.progress,D=!!t.content.isTranscodeFile,I=!1,A=0,R=r.groups.length;A<R;A++){var w=r.groups[A];if(w.fid==a){w.title=l,w.downloadURL=u,w.pageCount=c,w.currentPageIndex=g,w.currentPageStep=m,w.timestamp=y,w.uid=v,w.type=S,w.ratio=E,w.scale=b,w.isTranscodeFile=D,w.status=O,w.progress=x,I=!0;break}}if(I?I&&a===o.COMMON_GROUP&&r.event.fire(i,"TEB_ADDFILE",a):r.addGroupNotReport(a,l,v,u,c,g,y,T,S,m,E,b,D,O,x),!y&&!v)return;if(a!=o.COMMON_GROUP){var C=[],P=r.createBoardIdForFile(a,v,y,c,T),B=[],L="";S==o.FILE_TYPE.IMG&&(L=u?d.fileDownLoadUrlToPreviewUrl(u):"");for(var N=0;N<c;N++)e=P[N],L&&S==o.FILE_TYPE.IMG&&(L.endsWith("/")?B.push("".concat(L).concat(N+1,".jpg")):B.push(L+(N+1))),e&&!r.userData[e]&&C.push(e);if(r.addBoard(C,!1),u)if(S==o.FILE_TYPE.IMG)r.addBackgroundPic({boardIds:P,urls:B,type:n.BACKGROUND_TYPE.IMAGE,needReport:!1});else if(S==o.FILE_TYPE.IMAGESFILE){var M=(new Date).getTime(),q=d.decompress(u),F=(new Date).getTime();B=JSON.parse(q),r.addBackgroundPic({boardIds:P,urls:B,type:n.BACKGROUND_TYPE.IMAGE,needReport:!1});var k=F-M;_.report("add_images_file_history",{extra_info:JSON.stringify({urls:q,urls_length:q.length,elapse:k})})}}r.sortGroup()}else e=t.content.boardId,s=t.content.uid,e&&!r.userData[e]&&r.addBoard(e,!1),e&&!r.userData[e][s]&&(r.userData[e][s]=[]);if(t.content.colorRGBA&&(t.content.color=d.dealColor(t.content.colorRGBA)),t.content.width&&(t.content.thin=t.content.width),"addLine"==t.type){for(var U,H=0;H<t.content.points.length;H++){var G=t.content.points[H].x,V=t.content.points[H].y,W=t.content.points[H].w,Y=t.content.points[0].seq;0==H?U=new h(s,{color:t.content.color,thin:t.content.thin,x:G,y:V,w:W||t.content.thin,seq:t.content.points[H].seq,belongSeq:Y,writing:t.content.writing,show:!t.content.hidden}):(U.lines.push({x:G,y:V,w:W||t.content.thin,belongSeq:Y,seq:t.content.points[H].seq}),H==t.content.points.length-1&&(U.sort(),U.endSeq=t.content.points[H].seq)),U.setBorder(G,V)}if(U){var X=!1;r.userData[e][s].forEach(function(t,i){t.seq===U.seq&&(r.userData[e][s][i]=U,X=!0)}),X||r.userData[e][s].push(U),X=!1,r.data[e].forEach(function(t,i){t.seq===U.seq&&(r.data[e][i]=U,X=!0)}),X||r.data[e].push(U)}}else if("addText"==t.type){var j=new p(s,{belongSeq:t.content.belongSeq,x:t.content.x,y:t.content.y});j.seq=t.content.belongSeq,j.scale=t.content.scale,j.color=t.content.color,j.typeFace=t.content.typeface,j.textSize=t.content.textSize,j.fontStyle=t.content.fontStyle,j.time=t.content.time,j.show=!t.content.hidden;try{j.text=unescape(decodeURI(t.content.text))}catch(e){j.text=t.content.text}try{var z=t.content.text_wh.split(",");j.textWidth=parseFloat(z[0]),j.textHeight=parseFloat(z[1])}catch(t){j.textWidth=0,j.textHeight=0}r.userData[e][s].filter(function(t){return t.seq===j.seq}).length||r.userData[e][s].push(j),r.data[e].filter(function(t){return t.seq===j.seq}).length||r.data[e].push(j)}else if("displayLine"==t.type)t.content.lines.forEach(function(e){for(var i=0;i<r.userData[r.currentBoard][s].length;i++){var o=r.userData[r.currentBoard][s][i];"line"==o.type&&o.startSeq==e.seq?o.show=!!t.content.display:"graph"==o.type&&o.startPoint.seq==e.seq?o.show=!!t.content.display:"inputtext"==o.type&&o.belongSeq==e.seq?o.show=!!t.content.display:"imageElement"==o.type&&o.belongSeq==e.seq&&(o.show=!!t.content.display)}});else if("addPatternLine"==t.type||"addPatternCircle"==t.type||"addPatternRectangle"==t.type){t.content.graph={addPatternLine:"line",addPatternCircle:"oval",addPatternRectangle:"rect"}[t.type],t.content.seq=t.content.beginPoint.seq,t.content.show=!t.content.hidden,t.content.solid=!!t.content.fillRect;var J=new f(s,t.content);r.userData[e][s].filter(function(t){return t.seq===J.seq}).length||r.userData[e][s].push(J),r.data[e].filter(function(t){return t.seq===J.seq}).length||r.data[e].push(J)}else if("image"==t.type)t.content.url?r.addBackgroundPic({boardIds:t.content.boardId,urls:t.content.url,type:t.content.type,needReport:!1,position:t.content.mode}):r.deleteBackgroundPic(t.content.boardId);else if("clean"==t.type)r.clearBoard(!0,!1,!0);else if("cleanDraws"==t.type)r.clearBoard(!1,!1,!0);else if("switchBoard"==t.type){if(!e)return;(1*t.seq||0)>r.maxSeq?(r.maxSeq=t.seq,r.data[e]||r.addBoard(e,!1),r.currentBoard=e,e===o.COMMON_DEFAULT_BOARD?r.currentGroup=o.COMMON_GROUP:r.currentGroup=e.match(/\d+_#\w+$/)[0].split("_")[1]):_.report("throw_seq",{extra_info:JSON.stringify({seq:t.seq,maxSeq:r.maxSeq,boardId:e,method:"addHistory"})})}else if("setBoardBG"==t.type)r.setBackgroundColor({boardId:e,color:t.content.colorRGBA},!0);else if("setGlobalBG"==t.type)r.setGlobalBackgroundColor(t.content.colorRGBA,!0);else if("drag"==t.type)i.dragDataList.addDragData(e,new $({scale:t.content.scale,xOffset:t.content.xOffset,yOffset:t.content.yOffset}));else if("setRatio"==t.type){var K=t.content||{};for(var Z in K)i.boardRatio[Z]=K[Z]}else if("imageElement"==t.type){var Q=new ot({user:s,url:t.content.url,belongSeq:t.content.belongSeq,seq:t.content.seq,time:t.content.time,width:t.content.width,height:t.content.height,x:t.content.x,y:t.content.y,boardId:e,show:!t.content.hidden});i.userData[e][s].push(Q),i.data[e].push(Q)}}),e?r.event.fire(r,"TEB_DRAW_FACE"):r.setNeedDraw(!0)},st.prototype.undo=function(){var t=this;this.cancelSelect();var e=this.opData[this.currentBoard][this.opIndex[this.currentBoard]-1];if(e){if("line"==e.type)for(var i=0;i<this.userData[this.currentBoard][e.user].length;i++){var r=this.userData[this.currentBoard][e.user][i];if(e.seq==r.seq){r.show=!1,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:[{uid:e.user,seq:e.seq}]});break}}else if("eraser"==e.type)e.seq.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r];"line"==o.type&&e.seq==o.seq?o.show=!0:"graph"==o.type&&e.seq==o.startPoint.seq?o.show=!0:"inputtext"==o.type&&e.seq==o.belongSeq?o.show=!0:"imageElement"==o.type&&e.seq==o.belongSeq&&(o.show=!0)}}),this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:d.getTimeStamp(),seq:l.getSeq(),lines:e.seq}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:1,lines:e.seq});else if("graph"==e.type)for(var n=0;n<this.userData[this.currentBoard][e.user].length;n++){var s=this.userData[this.currentBoard][e.user][n];if("graph"==s.type&&e.seq==s.startPoint.seq){s.show=!1,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:[{uid:e.user,seq:e.seq}]});break}}else if("inputtext"==e.type)for(var a=0;a<this.userData[this.currentBoard][e.user].length;a++){var u=this.userData[this.currentBoard][e.user][a];if("inputtext"==u.type&&e.seq==u.belongSeq){u.show=!1,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:[{uid:e.user,seq:e.seq}]});break}}else if("move"==e.type){var c=[];e.seq.origin.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r],n=0,s=0;"line"==o.type&&e.seq==o.seq?(n=e.x-o.lines[0].x,s=e.y-o.lines[0].y,o.border.maxX+=n,o.border.minX+=n,o.border.maxY+=s,o.border.minY+=s,o.lines.forEach(function(t){t.x+=n,t.y+=s}),0!==o.fitCurve.length&&o.fitCurve.forEach(function(t){t[1][0]+=n,t[1][1]+=s,t[2][0]+=n,t[2][1]+=s,t[3][0]+=n,t[3][1]+=s}),c.push({uid:i,seq:e.seq,x:e.x,y:e.y})):"graph"==o.type&&e.seq==o.startPoint.seq?(n=e.x-o.startPoint.x,s=e.y-o.startPoint.y,o.startPoint.x+=n,o.startPoint.y+=s,o.endPoint.x+=n,o.endPoint.y+=s,c.push({uid:i,seq:e.seq,x:e.x,y:e.y})):"inputtext"==o.type&&e.seq==o.belongSeq&&(o.location.x=e.x,o.location.y=e.y,c.push({uid:i,seq:o.belongSeq,x:e.x,y:e.y}))}}),this.addRealtimeData({action:o.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,time:d.getTimeStamp(),seq:l.getSeq(),moves:c});var h=[];e.seq.origin.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r];if("line"==o.type&&e.seq==o.seq){var n=[];o.lines.forEach(function(t){n.push({seq:t.seq,x:t.x,y:t.y})}),h.push({type:"addLine",seq:l.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:d.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:d.getTimeStamp(),seq:o.seq,hidden:0,points:n}})}else if("graph"==o.type&&e.seq==o.startPoint.seq){var s={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:l.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:d.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:d.getTimeStamp(),hidden:0,fillRect:o.solid?1:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}};"rect"==o.graph&&(s.content.cornerRadius=0),h.push(s)}else"inputtext"===o.type&&e.seq==o.belongSeq&&h.push({type:"addText",seq:l.getSeq(),content:{belongSeq:o.belongSeq,time:d.getTimeStamp(),boardId:t.currentBoard,uid:o.user,x:o.location.x,y:o.location.y,colorRGBA:d.formatColor(o.color),scale:o.scale,updateTime:d.getTimeStamp(),hidden:0,typeface:o.typeFace,textSize:o.textSize,fontStyle:o.fontStyle,text:encodeURI(escape(o.text)),text_wh:"".concat(o.textWidth,",").concat(o.textHeight)}})}}),this.report.reportGraphData(h)}else if("delete"==e.type)e.seq.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r];"line"==o.type&&e.seq==o.seq?o.show=!0:"graph"==o.type&&e.seq==o.startPoint.seq?o.show=!0:"inputtext"==o.type&&e.seq==o.belongSeq&&(o.show=!0)}}),this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:d.getTimeStamp(),seq:l.getSeq(),lines:e.seq}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:1,lines:e.seq});else if("imageElement"==e.type)for(var p=0;p<this.userData[this.currentBoard][e.user].length;p++){var f=this.userData[this.currentBoard][e.user][p];if("imageElement"==f.type&&e.seq==f.belongSeq){f.show=!1,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:[{uid:e.user,seq:e.seq}]});break}}this.opIndex[this.currentBoard]--,this.setNeedDraw(!0),this.event.fire(this,"TEB_OPERATE_CANREDO_STATUS_CHANGED",this.canRedo()),this.event.fire(this,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",this.canUndo())}},st.prototype.canUndo=function(){return 0!=this.opIndex[this.currentBoard]},st.prototype.redo=function(){var t=this;this.cancelSelect();var e=this.opData[this.currentBoard][this.opIndex[this.currentBoard]];if(e){if("line"==e.type)for(var i=0;i<this.userData[this.currentBoard][e.user].length;i++){var r=this.userData[this.currentBoard][e.user][i];if(e.seq==r.seq){r.show=!0,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:1,lines:[{uid:e.user,seq:e.seq}]});break}}else if("inputtext"==e.type)for(var n=0;n<this.userData[this.currentBoard][e.user].length;n++){var s=this.userData[this.currentBoard][e.user][n];if("inputtext"==s.type&&e.seq==s.belongSeq){s.show=!0,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:1,lines:[{uid:e.user,seq:e.seq}]});break}}else if("eraser"==e.type)e.seq.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r];"line"==o.type&&e.seq==o.seq?o.show=!1:"graph"==o.type&&e.seq==o.startPoint.seq?o.show=!1:"inputtext"===o.type&&e.seq==o.belongSeq?o.show=!1:"imageElement"===o.type&&e.seq==o.belongSeq&&(o.show=!1)}}),this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),lines:e.seq}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:e.seq});else if("graph"==e.type)for(var a=0;a<this.userData[this.currentBoard][e.user].length;a++){var u=this.userData[this.currentBoard][e.user][a];if("graph"==u.type&&e.seq==u.startPoint.seq){u.show=!0,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:1,lines:[{uid:e.user,seq:e.seq}]});break}}else if("move"==e.type){var c=[];e.seq.final.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r],n=0,s=0;"line"==o.type&&e.seq==o.seq?(n=e.x-o.lines[0].x,s=e.y-o.lines[0].y,o.border.maxX+=n,o.border.minX+=n,o.border.maxY+=s,o.border.minY+=s,o.lines.forEach(function(t){t.x+=n,t.y+=s}),0!==o.fitCurve.length&&o.fitCurve.forEach(function(t){t[1][0]+=n,t[1][1]+=s,t[2][0]+=n,t[2][1]+=s,t[3][0]+=n,t[3][1]+=s}),c.push({uid:i,seq:e.seq,x:e.x,y:e.y})):"graph"==o.type&&e.seq==o.startPoint.seq?(n=e.x-o.startPoint.x,s=e.y-o.startPoint.y,o.startPoint.x+=n,o.startPoint.y+=s,o.endPoint.x+=n,o.endPoint.y+=s,c.push({uid:i,seq:e.seq,x:e.x,y:e.y})):"inputtext"==o.type&&e.seq==o.belongSeq&&(o.location.x=e.x,o.location.y=e.y,c.push({uid:i,seq:o.belongSeq,x:e.x,y:e.y}))}}),this.addRealtimeData({action:o.PROTOCOL_ACTION.MOVE_LINE_GRAPH_ACTION,time:d.getTimeStamp(),seq:l.getSeq(),moves:c});var h=[];e.seq.final.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r];if("line"==o.type&&e.seq==o.seq){var n=[];o.lines.forEach(function(t){n.push({seq:t.seq,x:t.x,y:t.y})}),h.push({type:"addLine",seq:l.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:d.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:d.getTimeStamp(),seq:o.seq,hidden:0,points:n}})}else if("graph"==o.type&&e.seq==o.startPoint.seq){var s={type:{line:"addPatternLine",oval:"addPatternCircle",circle:"addPatternCircle",rect:"addPatternRectangle"}[o.graph],seq:l.getSeq(),content:{boardId:t.currentBoard,uid:o.user,colorRGBA:d.formatColor(o.color),scale:100,width:o.thin,time:o.time,updateTime:d.getTimeStamp(),hidden:0,beginPoint:{x:o.startPoint.x,y:o.startPoint.y,seq:o.startPoint.seq},endPoint:{x:o.endPoint.x,y:o.endPoint.y,seq:o.endPoint.seq}}};"oval"==o.graph||"circle"==o.graph?s.content.fillRect=0:"rect"==o.graph&&(s.content.fillRect=0,s.content.cornerRadius=0),h.push(s)}else"inputtext"===o.type&&e.seq==o.belongSeq&&h.push({type:"addText",seq:l.getSeq(),content:{belongSeq:o.belongSeq,time:d.getTimeStamp(),boardId:t.currentBoard,uid:o.user,x:o.location.x,y:o.location.y,colorRGBA:d.formatColor(o.color),scale:o.scale,updateTime:d.getTimeStamp(),hidden:0,typeface:o.typeFace,textSize:o.textSize,fontStyle:o.fontStyle,text:encodeURI(escape(o.text)),text_wh:"".concat(o.textWidth,",").concat(o.textHeight)}})}}),this.report.reportGraphData(h)}else if("delete"==e.type)e.seq.forEach(function(e){for(var i=e.uid,r=0;r<t.userData[t.currentBoard][i].length;r++){var o=t.userData[t.currentBoard][i][r];"line"==o.type&&e.seq==o.seq?o.show=!1:"graph"==o.type&&e.seq==o.startPoint.seq?o.show=!1:"inputtext"==o.type&&e.seq==o.belongSeq&&(o.show=!1)}}),this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:0,time:d.getTimeStamp(),seq:l.getSeq(),lines:e.seq}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:0,lines:e.seq});else if("imageElement"==e.type)for(var p=0;p<this.userData[this.currentBoard][e.user].length;p++){var f=this.userData[this.currentBoard][e.user][p];if("imageElement"==f.type&&e.seq==f.belongSeq){f.show=!0,this.addRealtimeData({action:o.PROTOCOL_ACTION.ERASER_ACTION,display:1,time:d.getTimeStamp(),seq:l.getSeq(),lines:[{uid:e.user,seq:e.seq}]}),this.report.reportDisplayLine({boardId:this.currentBoard,updateTime:d.getTimeStamp(),display:1,lines:[{uid:e.user,seq:e.seq}]});break}}this.opIndex[this.currentBoard]++,this.setNeedDraw(!0),this.event.fire(this,"TEB_OPERATE_CANREDO_STATUS_CHANGED",this.canRedo()),this.event.fire(this,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",this.canUndo())}},st.prototype.canRedo=function(){return this.opIndex[this.currentBoard]!=this.opData[this.currentBoard].length},st.prototype.syncHistroyData=function(){var t=this,e=this,i=[],r=[],o=[],n=[],s=0,a=!1;return new Promise(function(l,u){!function l(u,c,h){var p=d.getTimeStamp();new Promise(function(i,r){t.request.getBoardData(u,function(t,o){t.error_code?(_.report("getBoardData",{action_result:t.error_code,action_info:t.error_msg,time_consume:d.getTimeStamp()-p,extra_info:JSON.stringify(t)}),r("error_code:".concat(t.error_code," error_msg:").concat(t.error_msg)),e.event.fire(this,"TEB_ERROR",N.TEDU_BOARD_ERROR_HISTORYDATA,"sync data error")):(_.report("getBoardData",{time_consume:d.getTimeStamp()-p,extra_info:JSON.stringify(t)}),i({res:t,oresp:o}))},function(t){r("error_code:".concat(t," error_msg:HTTPè¯·æ±éè¯¯ï¼è¯·éè¯")),e.event.fire(this,"TEB_ERROR",N.TEDU_BOARD_ERROR_HISTORYDATA,"sync data error")})}).then(function(d){var u=d.res,p=d.oresp;JSON.parse(p.config.data).first_time&&(i=[],r=[],o=[],n=[],s=0,a=!1,e.clearBoard(!0,!1,!0),e.resetData()),(u.board_data_list||[]).forEach(function(s){if("switchBoard"===s.type){if(a)return;a=!0,e.faceData.push(s);var l=JSON.parse(s.content).fid;o=o.filter(function(t){return JSON.parse(t.content).fid!=l||(n.push(t),!1)}),t.renderFace(n,e.faceData,i)}else"setGlobalBG"===s.type?i.push(s):"addFile"===s.type?o.push(s):a?r.push(s):e.faceData.push(s)}),s++,!u.is_finish&&s<50?l(!1,c,h):c()}).catch(function(i){e.event.fire(t,"TEB_ERROR",N.TEDU_BOARD_ERROR_HISTORYDATA,i.message),_.report("getBoardData",{action_result:-3,action_info:i.message,time_consume:0,extra_info:JSON.stringify({stack:i.stack,message:i.message})})})}(!0,function(){var t=this;a||(e.addHistory(i),r=r.concat(e.faceData),e.faceData=[]),e.addHistory(o),e.addHistory(r),e.fixBoardData(),e.sortBoard(),e.syncBoardSeq(),setTimeout(function(){e.event.fire(t,"TEB_HISTROYDATA_SYNCCOMPLETED")},200)})})},st.prototype.renderFace=function(t,e,i){this.addHistory(i),this.addHistory(t),this.addHistory(e,!0)},st.prototype.fixBoardData=function(){var t=this;try{var e=[];this.getGroup().forEach(function(t){e.push(t.fid)});var i=[];this.boardList.forEach(function(r,n){var s=d.boardId2Fid(r);s!=o.COMMON_GROUP&&-1===e.indexOf(s)&&(i.push(n),delete t.userData[r],delete t.data[r],delete t.opData[r],delete t.opIndex[r],delete t.backgroundPic[r],delete t.backgroundColor[r])}),i.sort(function(t,e){return e-t}),i.forEach(function(e){t.boardList.splice(e,1)})}catch(t){}},st.prototype.sortBoard=function(){this.boardList=this.boardList.sort(function(t,e){var i=t===o.COMMON_DEFAULT_BOARD?0:t.match(/\d+_\d+_#\w+$/)[0].split("_")[0],r=e===o.COMMON_DEFAULT_BOARD?0:e.match(/\d+_\d+_#\w+$/)[0].split("_")[0];return i!=r?i-r:(t===o.COMMON_DEFAULT_BOARD?0:t.match(/\d+_#\w+$/)[0].split("_")[0])-(e===o.COMMON_DEFAULT_BOARD?0:e.match(/\d+_#\w+$/)[0].split("_")[0])})},st.prototype.syncBoardSeq=function(){1==this.boardList.length&&this.boardList[0]===o.COMMON_DEFAULT_BOARD?this.boardIdSeq=1:this.boardList[this.boardList.length-1]&&(this.boardIdSeq=1*this.boardList[this.boardList.length-1].match(/\d+_#\w+$/)[0].split("_")[0]+1)},st.prototype.sortGroup=function(){this.groups=this.groups.sort(function(t,e){return t.fid===o.COMMON_GROUP?-1:e.fid===o.COMMON_GROUP?1:1*t.fid.replace(/\D*/,"")-1*e.fid.replace(/\D*/,"")})},st.prototype.addData=function(t){var e=this;if(this.permissions){if(t)try{var i=[6,7],r=t.value.actions.filter(function(t){return-1===i.indexOf(t.action)});r.length&&_.report("addData",{extra_info:JSON.stringify({seq:t.seq,timestamp:t.timestamp,value:{boardId:t.value.boardId,operator:t.value.operator,actions:r}})})}catch(t){}var n=t.value.operator,s=t.value.actions,a=t.value.boardId;this.userData[a]||this.addBoard(a,!1),this.userData[a][n]||(this.userData[a][n]=[]),this.userData[a][n].length;var u=null,c=0,g=!1;s.forEach(function(t,i){var r;if(a=t.boardId||a,t.color&&(t.color=d.dealColor(t.color)),!e.seqFilter[t.seq+""])if(e.seqFilter[t.seq+""]=!0,1==t.action){if((r=e.findLine(a,n,t))?(r.color=t.color,r.thin=t.thin,r.show=!0,r.lines.push({x:t.x,y:t.y,w:t.w||t.thin,belongSeq:t.belongSeq,seq:t.seq}),r.sort(),r.setBorder(t.x,t.y)):((r=new h(n,t)).show=!0,e.userData[a][n].push(r),e.data[a].push(r)),0!==r.endSeq&&e.smoothLevel>0){var y=[];r.lines.forEach(function(t){y.push([t.x,t.y])}),r.fitCurve=K(y,1e4*e.smoothLevel,null)}}else if(2==t.action||3==t.action){if((r=e.findLine(a,n,t))?(r.lines.push({x:t.x,y:t.y,w:t.w||t.thin,belongSeq:t.belongSeq,seq:t.seq}),r.sort(),r.setBorder(t.x,t.y)):(r=new h(n,t),e.userData[a][n].push(r),e.data[a].push(r)),3==t.action&&(r.endSeq=t.seq,function(t,i){setTimeout(function(){t.color&&t.thin||e.request.getLineData({boardId:i,owner:t.user,seq:t.belongSeq},function(t){t.error_code||(e.addHistory([{content:t.content,type:t.type}]),e.sortBoard(),e.syncBoardSeq())})},500)}(r,a)),0!==r.endSeq&&e.smoothLevel>0){var v=[];r.lines.forEach(function(t){v.push([t.x,t.y])}),r.fitCurve=K(v,1e4*e.smoothLevel,null)}}else if(6==t.action){if(c++,(1*t.seq||0)>e.maxLaserSeq){if(e.maxLaserSeq=t.seq,i%3==0){var T=new m(e.user,{color:t.color,radius:t.r,x:t.x,y:t.y,seq:l.getSeq(),toolType:t.toolType});e.laserData.push(T)}u=new m(e.user,{color:t.color,radius:t.r,x:t.x,y:t.y,seq:l.getSeq(),toolType:t.toolType})}}else if(7==t.action){c++,e.maxLaserSeq=t.seq;var S=new m(e.user,{color:t.color,radius:t.r,x:t.x,y:t.y,seq:l.getSeq(),toolType:t.toolType});S.status=0,e.laserData.push(S)}else if(8==t.action){if(!t.lines)return;t.lines.forEach(function(i){for(var r=0;r<e.userData[a][i.uid].length;r++){var o=e.userData[a][i.uid][r];"line"==o.type&&o.startSeq==i.seq?o.show=!!t.display:"graph"==o.type&&o.startPoint.seq==i.seq?o.show=!!t.display:"inputtext"==o.type&&o.belongSeq==i.seq?o.show=!!t.display:"imageElement"==o.type&&o.belongSeq==i.seq&&(o.show=!!t.display)}})}else if(9==t.action){if(!t.moves)return;t.moves.forEach(function(t){for(var i=0;i<e.userData[a][t.uid].length;i++){var r=e.userData[a][t.uid][i],o=0,n=0;"line"==r.type&&r.startSeq==t.seq?(o=t.x-r.lines[0].x,n=t.y-r.lines[0].y,r.border.maxX+=o,r.border.minX+=o,r.border.maxY+=n,r.border.minY+=n,r.lines.forEach(function(t){t.x+=o,t.y+=n}),0!==r.fitCurve.length&&r.fitCurve.forEach(function(t){t[1][0]+=o,t[1][1]+=n,t[2][0]+=o,t[2][1]+=n,t[3][0]+=o,t[3][1]+=n})):"graph"==r.type&&r.startPoint.seq==t.seq?(o=t.x-r.startPoint.x,n=t.y-r.startPoint.y,r.startPoint.x+=o,r.startPoint.y+=n,r.endPoint.x+=o,r.endPoint.y+=n):"inputtext"==r.type&&r.belongSeq==t.seq&&(r.location.x=t.x,r.location.y=t.y)}})}else if(10==t.action||11==t.action||12==t.action||14==t.action||15==t.action){t.graph={10:"line",11:"oval",12:"rect"}[t.action],t.solid=!!t.fillRect,t.show=!0;var E=new f(n,t);e.userData[a][n].push(E),e.data[a].push(E)}else if(13==t.action)if((1*t.seq||0)>e.maxAddTextSeq){e.maxAddTextSeq=t.seq;for(var b=null,O=0;O<e.data[a].length;O++){var x=e.data[a][O];if(x.belongSeq===t.belongSeq){t.seq>x.seq&&(x.seq=t.seq),b=x;break}}b?b.text==unescape(decodeURI(t.text))&&b.textWidth==t.textWidth&&b.textHeight==t.textHeight&&b.color==t.color&&b.typeFace==t.typeFace&&b.textSize==t.textSize&&b.fontStyle==t.fontStyle?1===s.length&&(g=!0):(b.text=unescape(decodeURI(t.text)),b.textWidth=t.textWidth,b.textHeight=t.textHeight,b.color=t.color,b.scale=t.scale,b.typeFace=t.typeFace,b.textSize=t.textSize,b.fontStyle=t.fontStyle):((b=new p(n,{x:t.x,y:t.y,belongSeq:t.belongSeq})).color=t.color,b.scale=t.scale,b.typeFace=t.typeFace,b.textSize=t.textSize,b.fontStyle=t.fontStyle,b.time=t.time,b.text=unescape(decodeURI(t.text)),b.textWidth=t.textWidth,b.textHeight=t.textHeight,e.userData[a][n].push(b),e.data[a].push(b))}else _.report("throw_seq",{extra_info:JSON.stringify({seq:t.seq,maxAddTextSeq:e.maxAddTextSeq,boardId:a,method:"addData"})});else if(t.action==o.PROTOCOL_ACTION.IMAGE_ELEMENT){if((1*t.seq||0)<e.maxImageElementSeq)return void _.report("throw_seq",{extra_info:JSON.stringify({seq:t.seq,maxImageElementSeq:e.maxImageElementSeq,boardId:a,method:"addData"})});var I;e.maxImageElementSeq=t.seq;for(var A=e.data[a]||[],R=0,w=A.length;R<w;R++){var C=A[R];if(C.belongSeq===t.belongSeq){I=C;break}}I?(I.seq=t.seq,I.width=t.width,I.height=t.height,I.x=t.x,I.y=t.y,I.show=t.show):(I=new ot({user:n,url:t.url,belongSeq:t.belongSeq,seq:t.seq,time:t.time,width:t.width,height:t.height,x:t.x,y:t.y,boardId:a,show:t.show}),e.userData[a][n].push(I),e.data[a].push(I))}else if(101==t.action)e.clearBoard(!0,!1,!0);else if(102==t.action)e.clearBoard(!1,!1,!0);else if(103==t.action)try{e.clearFileDrawData(t.fids)}catch(t){}else if(104==t.action)e.resetData();else if(t.action==o.PROTOCOL_ACTION.SET_BOARD_RATIO_ACTION)e.setBoardRatio(a,t.ratio,!1);else if(201==t.action)e.addBackgroundPic({boardIds:a,urls:t.url,type:t.type,needReport:!1,position:t.mode});else if(202==t.action)e.deleteBackgroundPic(a);else if(203==t.action)t.color&&(t.color=d.formatColor(t.color)),t.isGlobal?e.setGlobalBackgroundColor(t.color,!0):e.setBackgroundColor(t.color,!0);else if(t.action==o.PROTOCOL_ACTION.BOARD_MOVE_SCALE_ACTION)if((1*t.seq||0)>e.maxMoveSeq){e.maxMoveSeq=t.seq;var P=e.dragDataList.getDragData(a);P?e.dragDataList.updateDragData(a,{scale:t.scale,xOffset:t.xOffset,yOffset:t.yOffset}):(P=new $({scale:t.scale,xOffset:t.xOffset,yOffset:t.yOffset}),e.dragDataList.addDragData(a,P)),e.event.fire(e,"TEB_ZOOM_DRAG_STATUS",{fid:d.boardId2Fid(a),scale:t.scale,xOffset:t.xOffset,yOffset:t.yOffset})}else _.report("throw_seq",{extra_info:JSON.stringify({seq:t.seq,maxMoveSeq:e.maxMoveSeq,boardId:a,method:"addData"})});else 401==t.action?e.resolveSwitchBoardAction(t):501==t.action?e.resolveAddFileAction(t.file):t.action===o.PROTOCOL_ACTION.PPT_EVENT_ACTION?D.pptAction(e.iframeDom,t.data):t.action===o.PROTOCOL_ACTION.VIDEO_EVENT_ACTION&&e.resolveUpdateVideoAction(t)}),c!==s.length&&(g||this.setNeedDraw(!0),setTimeout(function(){u&&e.event.fire(e,"draw_laser",u)},100))}},st.prototype.resolveSwitchBoardAction=function(t){var e=this,i=t.toBoardId,r=[],n=[];if((1*t.seq||0)>this.maxSeq){this.maxSeq=t.seq,r=t.deleteFiles||[],n=t.deleteBoards||[],r.forEach(function(t){e.deleteGroup(t,!1),n=n.concat(e.getBoardByGroup(t))}),n.forEach(function(t){e.removeBoard(t)}),this.data[i]||this.addBoard(i,!1),this.currentBoard=i;var s=d.boardId2Fid(i);this.currentGroup=s;var a=Math.max(t.page,0),l=Math.max(t.step,0),u=this.getFileInfo(s);u?(u.type===o.FILE_TYPE.H5PPT&&D.gotoTimestampNew(this.iframeDom,{slideIndex:a,stepIndex:l,resetStep:t.resetStep,usePrevNextStepMethod:t.usePrevNextStepMethod,isPassive:!0}),this.updateFileInfo({fid:s,pageCount:this.getBoardByGroup(s).length,currentPageIndex:a||0,currentPageStep:l||0}),this.event.fire(this,"TEB_GOTOBOARD",i,d.boardId2Fid(i))):this.request.getFileInfo({fid:s},function(r){r&&0==r.error_code&&(u=JSON.parse(r.content),e.resolveAddFileAction(u),e.setNeedDraw(!0),setTimeout(function(){u.type===o.FILE_TYPE.H5PPT&&D.gotoTimestampNew(e.iframeDom,{slideIndex:a,stepIndex:l,resetStep:t.resetStep,usePrevNextStepMethod:t.usePrevNextStepMethod,isPassive:!0}),e.updateFileInfo({fid:s,pageCount:e.getBoardByGroup(s).length,currentPageIndex:a||0,currentPageStep:l||0}),e.event.fire(e,"TEB_GOTOBOARD",i,d.boardId2Fid(i))},200))},function(t){})}else r=t.deleteFiles||[],n=t.deleteBoards||[],r.forEach(function(t){e.deleteGroup(t,!1),n=n.concat(e.getBoardByGroup(t))}),n.forEach(function(t){e.removeBoard(t)}),_.report("throw_seq",{extra_info:JSON.stringify({seq:t.seq,maxSeq:this.maxSeq,boardId:i,method:"addData"})})},st.prototype.resolveAddFileAction=function(t){var e=null,i=[];if(t.type===o.FILE_TYPE.H5PPT){i=[];for(var r=0;r<t.pageCount;r++)e="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(r+1,"_").concat(t.fid),i.push(e);this.addBoard(i,!1),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,o.FILE_TYPE.H5PPT,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress)}else if(t.type==o.FILE_TYPE.IMG){var s=t.downloadURL,a=s?d.fileDownLoadUrlToPreviewUrl(s):"",l=[];i=[];for(var u=0;u<t.pageCount;u++)e="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(u+1,"_").concat(t.fid),i.push(e),a.endsWith("/")?l.push("".concat(a).concat(u+1,".jpg")):l.push(a+(u+1));this.addBoard(i,!1),s&&this.addBackgroundPic({boardIds:i,urls:l,type:n.BACKGROUND_TYPE.IMAGE,needReport:!1}),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,o.FILE_TYPE.IMAGE,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress)}else if(t.type==o.FILE_TYPE.IMAGESFILE){if(t.downloadURL){var c=(new Date).getTime(),h=d.decompress(t.downloadURL),p=(new Date).getTime();l=JSON.parse(h);var f=p-c;_.report("add_images_file_peer",{extra_info:JSON.stringify({urls:h,urls_length:h.length,elapse:f})}),this.addImagesToBoard(t,l)}}else if(t.type==o.FILE_TYPE.VOD||t.type==o.FILE_TYPE.VODFILE||t.type==o.FILE_TYPE.LIVE||t.type==o.FILE_TYPE.H5FILE){i=[];for(var g=0;g<t.pageCount;g++)e="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(g+1,"_").concat(t.fid),i.push(e);this.addBoard(i,!1),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,t.type,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress)}},st.prototype.addImagesToBoard=function(t,e){for(var i=null,r=[],o=0;o<t.pageCount;o++)i="".concat(t.platform,"_").concat(t.uid,"_").concat(t.timestamp,"_").concat(o+1,"_").concat(t.fid),r.push(i);this.addBoard(r,!1),e&&e.length>0&&this.addBackgroundPic({boardIds:r,urls:e,type:n.BACKGROUND_TYPE.IMAGE,needReport:!1}),this.addGroupNotReport(t.fid,t.title,t.uid,t.downloadURL,t.pageCount,0,t.timestamp,t.platform,t.type,0,t.ratio,t.scale,t.isTranscodeFile,t.status,t.progress)},st.prototype.resolveUpdateVideoAction=function(t){if((1*t.seq||0)>this.maxVideoSeq){this.maxVideoSeq=t.seq;var e=t.status,i=t.progress,r=t.fid,o=t.time;this.updateFileInfo({fid:r,status:e,progress:i,timestamp:o})}},st.prototype.addFile=function(t,e,i,r,n,s,a){var u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];if(!Array.isArray(e))return"";t=t||"#".concat(d.getTimeStamp());var c,h,p,f,g,m=d.getSecondTime();if(c=this.createBoardIdForFile(t,this.user,m,e.length,o.PLATFORM)||[],n=(p=(h=2===this.boardContentFitMode||1===this.boardContentFitMode?d.calcRatioWidthHeight(n,o.RATIO):d.calcRatioWidthHeight(this.ratio,o.RATIO)).ratioWidth)+":"+(f=h.ratioHeight),2===this.boardContentFitMode){var y=this.containerWidth/p,_=this.containerHeight/f,v=Math.min(y,_);g=Math.max(y,_)/v*100}else this.boardContentFitMode,g=100;this.addGroup(t,i,this.user,r,e.length,0,m,o.PLATFORM,a,0,n,g,s),this.addBoard(c),this.addBackgroundPic({boardIds:c,urls:e});var T={action:o.PROTOCOL_ACTION.ADD_FILE_ACTION,time:d.getTimeStamp(),seq:l.getSeq(),file:{fid:t,title:i,downloadURL:r,pageCount:e.length,uid:this.identifier,timestamp:m,platform:o.PLATFORM,type:a,ratio:n,scale:g,isTranscodeFile:s}};return this.addRealtimeData(T),c.length&&u&&this.switchFile(t),t},st.prototype.addH5PPTFile=function(t,e,i,r,n,s,a){for(var u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],c=!1,h=this.getGroup()||[],p=0,f=h.length;p<f;p++)if(h[p].downloadURL==e){c=!0;break}if(!c){t=t||"#".concat(d.getTimeStamp());var g,m=d.getSecondTime();g=this.createBoardIdForFile(t,this.user,m,r,o.PLATFORM)||[];var y,_,v,T,S=null;if(n&&s){var E=d.maxCommonDivisor(n,s);S=n/E+":"+s/E}else S=this.ratio;if(S=(_=(y=2===this.boardContentFitMode||1===this.boardContentFitMode?d.calcRatioWidthHeight(S,o.RATIO):d.calcRatioWidthHeight(this.ratio,o.RATIO)).ratioWidth)+":"+(v=y.ratioHeight),2===this.boardContentFitMode){var b=this.containerWidth/_,O=this.containerHeight/v,x=Math.min(b,O);T=Math.max(b,O)/x*100}else this.boardContentFitMode,T=100;var D={action:o.PROTOCOL_ACTION.ADD_FILE_ACTION,time:d.getTimeStamp(),seq:l.getSeq(),file:{fid:t,title:i,downloadURL:e,pageCount:r,uid:this.identifier,timestamp:m,platform:o.PLATFORM,type:o.FILE_TYPE.H5PPT,ratio:S,scale:T,isTranscodeFile:a}};return this.addRealtimeData(D),this.addGroup(t,i,this.user,e,r,0,m,o.PLATFORM,o.FILE_TYPE.H5PPT,0,S,T,a),this.addBoard(g),g.length&&u&&this.switchFile(t),t}},st.prototype.addH5File=function(t,e,i,r){this.addVideoFile(t,e,i,r,o.FILE_TYPE.H5FILE)},st.prototype.addVideoFile=function(t,e,i,r,n){for(var s=!1,a=this.getGroup()||[],u=0,c=a.length;u<c;u++)if(a[u].downloadURL==e){s=!0;break}if(!s){t=t||"#".concat(d.getTimeStamp());var h,p=d.getSecondTime();h=this.createBoardIdForFile(t,this.user,p,1,o.PLATFORM)||[];var f,g,m,y,_=null;if(i&&r){var v=d.maxCommonDivisor(i,r);_=i/v+":"+r/v}else _=this.ratio;if(_=(g=(f=2===this.boardContentFitMode||1===this.boardContentFitMode?d.calcRatioWidthHeight(_,o.RATIO):d.calcRatioWidthHeight(this.ratio,o.RATIO)).ratioWidth)+":"+(m=f.ratioHeight),2===this.boardContentFitMode){var T=this.containerWidth/g,S=this.containerHeight/m,E=Math.min(T,S);y=Math.max(T,S)/E*100}else this.boardContentFitMode,y=100;this.addGroup(t,"",this.user,e,1,0,p,o.PLATFORM,n,0,_,y,!1),this.addBoard(h);var b={action:o.PROTOCOL_ACTION.ADD_FILE_ACTION,time:d.getTimeStamp(),seq:l.getSeq(),file:{fid:t,title:"",downloadURL:e,pageCount:1,uid:this.identifier,timestamp:p,platform:o.PLATFORM,type:n,ratio:_,scale:y,isTranscodeFile:!1,status:0,progress:0}};return this.addRealtimeData(b),h.length&&this.switchFile(t),t}},st.prototype.deleteFile=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getCurrentFile();if(t===o.COMMON_GROUP)return!1;var e=this.deleteGroup(t);return this.switchFile(o.COMMON_GROUP),this.event.fire(this,"TEB_DELETEFILE",t),!(!e||!e.length||(this.deleteBoard(e,t),0))},st.prototype.switchFile=function(t,e,i){for(var r=!1,n=0,s=this.groups.length;n<s;n++)if(this.groups[n].fid==t){r=!0;break}if(r){this.currentGroup=t;var a=this.getBoardByGroup(this.currentGroup),l=this.getFileInfo(this.currentGroup),d=a.indexOf(e);return 0<=d&&d<=l.pageCount&&(l.currentPageIndex=d),d=Math.max(0,l.currentPageIndex),isNaN(d)&&(d=l.currentPageIndex||0),l.currentPageIndex=d,l.fid!==o.COMMON_GROUP&&(i=Math.max(0,i),isNaN(i)&&(i=l.currentPageStep||0),l.currentPageStep=i),e=a[d],this.event.fire(this,"TEB_SWITCHFILE",t),this.switchBoard(e),t}return!1},st.prototype.setBoardSize=function(t,e){this.boardWidth=t,this.boardHeight=e},st.prototype.setContainerSize=function(t,e){this.containerWidth=t,this.containerHeight=e},st.prototype.setIframeDom=function(t){this.iframeDom=t},st.prototype.setBoardRatio=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.boardRatio[t]=e;var r={};r[t]=e,i&&this.addRealtimeData({action:o.PROTOCOL_ACTION.SET_BOARD_RATIO_ACTION,seq:l.getSeq(),ratio:e}),i&&this.report.reportsetBoardRatio(r)},st.prototype.getBoardRatio=function(){if(this.getCurrentFile()===o.COMMON_GROUP)return this.boardRatio[this.currentBoard]||this.ratio;var t=this.boardRatio[this.currentBoard];if(t)return t;var e=this.getFileInfo(this.getCurrentFile());return e&&e.ratio?e.ratio:this.ratio},st.prototype.addDragData=function(t,e){var i=new $(e);this.dragDataList.addDragData(t,i)},st.prototype.getDragData=function(){return this.dragDataList.getDragData(this.currentBoard)},st.prototype.setBoardScale=function(t){t||(t=o.SCALE),t=Math.max(o.MIN_SCALE,Math.min(o.MAX_SCALE,t));var e=this.dragDataList.getDragData(this.currentBoard);e?this.dragDataList.updateDragData(this.currentBoard,{scale:t}):(e=new $({scale:t,xOffset:50,yOffset:50}),this.dragDataList.addDragData(this.currentBoard,e)),this.addRealtimeData(e.getRealTimeData()),this.report.reportDrag(Object.assign(e.getReportData(),{boardId:this.currentBoard})),this.setNeedDraw(!0)},st.prototype.getBoardScale=function(){var t,e=this.dragDataList.getDragData(this.currentBoard);if(e)t=e.scale;else{var i=this.getFileInfo(this.getCurrentFile());i&&(t=i.scale),t||(t=this.scale)}return t},st.prototype.setBoardContentFitMode=function(t){this.boardContentFitMode=t||M.TEDU_BOARD_FILE_FIT_MODE_NONE},st.prototype.getBoardContentFitMode=function(){return this.boardContentFitMode||M.TEDU_BOARD_FILE_FIT_MODE_NONE},st.prototype.updateFileInfo=function(t){for(var e=t.fid,i=!1,r=0,o=this.groups.length;r<o;r++){var n=this.groups[r];if(n.fid==e){n.title=n.title||t.title,n.pageCount=t.pageCount||n.pageCount,n.currentPageIndex=void 0===t.currentPageIndex?n.currentPageIndex:t.currentPageIndex,n.currentPageStep=void 0===t.currentPageStep?n.currentPageStep:t.currentPageStep,n.downloadURL=n.downloadURL||t.downloadURL,n.uid=n.uid||t.uid,n.timestamp=t.timestamp||n.timestamp,n.ratio=t.ratio||n.ratio,n.scale=t.scale||n.scale,n.status=void 0===t.status?n.status:t.status,n.progress=void 0===t.progress?n.progress:t.progress,i=!0;break}}i||this.groups.push({fid:t.fid,title:t.title,pageCount:t.pageCount,currentPageIndex:t.currentPageIndex||0,currentPageStep:t.currentPageStep||0,downloadURL:t.downloadURL,uid:t.uid,timestamp:t.timestamp,type:t.type||0,ratio:t.ratio||0,scale:t.scale,status:t.status||0,progress:t.progress||0})},st.prototype.isFileUrlExist=function(t){for(var e=!1,i=this.getGroup()||[],r=0,o=i.length;r<o;r++)if(i[r].downloadURL==t){e=!0;break}return e},st.prototype.getFileInfoByUrl=function(t){for(var e={},i=this.getGroup()||[],r=0,o=i.length;r<o;r++)if(i[r].downloadURL==t){e=i[r];break}return e},st.prototype.setLineStyle=function(t){"object"==nt(t)&&(this.lineStyle=Object.assign(this.lineStyle,t))},st.prototype.getLineStyle=function(){return this.lineStyle},st.prototype.setOvalDrawMode=function(t){this.ovalDrawMode=t},st.prototype.getOvalDrawMode=function(){return this.ovalDrawMode},st.prototype.setCursorIcon=function(t,e){var i,r,n;"[object Object]"===Object.prototype.toString.call(e)&&Object.assign(o.ICONS,(n=e,(r=t)in(i={})?Object.defineProperty(i,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[r]=n,i))},st.prototype.getCursorIcons=function(){return o.ICONS},st.prototype.pptAction=function(t){this.addRealtimeData({action:o.PROTOCOL_ACTION.PPT_EVENT_ACTION,data:t})},st.prototype.createTranscode=function(t){return this.request.createTranscode(t)},st.prototype.describeTranscode=function(t){return this.request.describeTranscode(t)},st.prototype.destroy=function(){this.heartbeat&&this.heartbeat.destroy(),this.textInputTask&&clearInterval(this.textInputTask),this.drawRaserTask&&clearInterval(this.drawRaserTask),this.sendInterval&&clearInterval(this.sendInterval)},st.prototype.addImageElement=function(t,e){var i=this,r=l.getSeq(),o=new ot({belongSeq:r,seq:r,user:this.identifier,url:e,boardId:t,show:!0});o.getImageSize(this.boardWidth,this.boardHeight,this.getBoardScale(),function(e){i.userData[t][i.identifier].push(o),i.data[t].push(o),i.opData[t].push(new u(i.identifier,{seq:o.belongSeq,type:"imageElement"})),i.opIndex[t]++,i.event.fire(i,"TEB_OPERATE_CANREDO_STATUS_CHANGED",i.canRedo()),i.event.fire(i,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",i.canUndo()),i.setNeedDraw(!0),i.addRealtimeData(o.getRealTimeData()),i.report.reportImageElement(o.getReportData())})},st.prototype.updateImageElements=function(t){var e=this,i=[];t.forEach(function(t){e.addRealtimeData(t.getRealTimeData()),i.push(t.getReportData())}),this.report.reportImageElement(i)},st.prototype.updateDragDataFromTextTool=function(t,e,i){var r=!1;if(this.dragDataList.getDragData(this.currentBoard)){var n=this.getDragData();i=Math.floor(i?n.scale/i:n.scale),i=Math.max(o.MIN_SCALE,Math.min(o.MAX_SCALE,i)),(t||e||n.scale!==i)&&(r=!0),this.dragDataList.updateDragData(this.currentBoard,{scale:i,xOffset:n.xOffset-t,yOffset:n.yOffset-e})}else this.dragDataList.addDragData(this.currentBoard,new $({scale:this.getBoardScale(),xOffset:50-t,yOffset:50-e})),(t||e)&&(r=!0);r&&(this.addRealtimeData(this.dragDataList.getDragData(this.currentBoard).getRealTimeData()),this.report.reportDrag(Object.assign(this.dragDataList.getDragData(this.currentBoard).getReportData(),{boardId:this.currentBoard})))},st.prototype.machineNotify=function(t,e){this.request.machineNotify(t,e)},st.prototype.addRealtimeData=function(t){this.dataSyncEnable&&(t.boardId=this.currentBoard,this.realTimeData.push(t))},st.prototype.addSendAckData=function(t){!(arguments.length>1&&void 0!==arguments[1])||arguments[1]},st.prototype.addReportAckData=function(t){!(arguments.length>1&&void 0!==arguments[1])||arguments[1]},st.prototype.syncAndRefresh=function(){var t=this;if(this.permissions){var e=Object.keys(this.reportAckDatas).length;e?(this.request.reportMsg(Object.values(this.reportAckDatas),function(e,i){t.syncHistroyData()}),_.report("sync_report_failed",{extra_info:JSON.stringify({count:e})}),this.reportAckDatas={}):this.syncHistroyData();var i=Object.keys(this.sendAckDatas).length;if(i>0){var r=null;Object.values(this.sendAckDatas).forEach(function(t,e){null==r?r=t:(t.timestamp>r.timestamp&&(r.timestamp=t.timestamp,r.seq=t.seq),r.value.actions.push.apply(r.value.actions,t.value.actions))}),this.event.fire(this,"TEB_SYNCDATA",r),_.report("sync_send_failed",{extra_info:JSON.stringify({count:i})}),this.sendAckDatas={}}}},st.prototype.setImageTimeout=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.IMAGE_TIMEOUT;"[object Number]"!==Object.prototype.toString.call(t)&&(t=o.IMAGE_TIMEOUT),this.imageTimeout=t,_.report("call_method",{extra_info:JSON.stringify({method:"setImageTimeout",data:t})})},st.prototype.getImageTimeout=function(){return this.imageTimeout},st.prototype.setVisible=function(t){this.heartbeat.setVisible(t)};var at=st,lt=1,dt=2,ut=3,ct=4,ht=5,pt=6,ft=1,gt=2,mt={TEDU_BOARD_H5_FILE_STATUS_LOADING:1,TEDU_BOARD_H5_FILE_STATUS_LOADED:2};function yt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _t=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.progressTemplate='<div class="tic_board_bg_progress lds-css ng-scope" style="display:none; position:absolute;left: 50%;top: 50%;-webkit-transform: translateX(-50%) translateY(-50%);transform: translateX(-50%) translateY(-50%);overflow:hidden;width:70px;height:70px"><div style="width:100%;height:100%" class="lds-ellipsis"><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div></div><style type="text/css">@keyframes lds-ellipsis3 {\n      0%, 25% {\n        left: 32px;\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n      50% {\n        left: 32px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      75% {\n        left: 100px;\n      }\n      100% {\n        left: 168px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n    }\n    @-webkit-keyframes lds-ellipsis3 {\n      0%, 25% {\n        left: 32px;\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n      50% {\n        left: 32px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      75% {\n        left: 100px;\n      }\n      100% {\n        left: 168px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n    }\n    @keyframes lds-ellipsis2 {\n      0% {\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      25%, 100% {\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n    }\n    @-webkit-keyframes lds-ellipsis2 {\n      0% {\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      25%, 100% {\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n    }\n    @keyframes lds-ellipsis {\n      0% {\n        left: 32px;\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n      25% {\n        left: 32px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      50% {\n        left: 100px;\n      }\n      75% {\n        left: 168px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      100% {\n        left: 168px;\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n    }\n    @-webkit-keyframes lds-ellipsis {\n      0% {\n        left: 32px;\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n      25% {\n        left: 32px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      50% {\n        left: 100px;\n      }\n      75% {\n        left: 168px;\n        -webkit-transform: scale(1);\n        transform: scale(1);\n      }\n      100% {\n        left: 168px;\n        -webkit-transform: scale(0);\n        transform: scale(0);\n      }\n    }\n    .lds-ellipsis {\n      position: relative;\n    }\n    .lds-ellipsis > div {\n      position: absolute;\n      -webkit-transform: translate(-50%, -50%);\n      transform: translate(-50%, -50%);\n      width: 40px;\n      height: 40px;\n    }\n    .lds-ellipsis div > div {\n      width: 40px;\n      height: 40px;\n      border-radius: 50%;\n      background: #f00;\n      position: absolute;\n      top: 100px;\n      left: 32px;\n      -webkit-animation: lds-ellipsis 1s cubic-bezier(0, 0.5, 0.5, 1) infinite forwards;\n      animation: lds-ellipsis 1s cubic-bezier(0, 0.5, 0.5, 1) infinite forwards;\n    }\n    .lds-ellipsis div:nth-child(1) div {\n      -webkit-animation: lds-ellipsis2 1s cubic-bezier(0, 0.5, 0.5, 1) infinite forwards;\n      animation: lds-ellipsis2 1s cubic-bezier(0, 0.5, 0.5, 1) infinite forwards;\n      background: #ce64a6;\n    }\n    .lds-ellipsis div:nth-child(2) div {\n      -webkit-animation-delay: -0.5s;\n      animation-delay: -0.5s;\n      background: #bda0b2;\n    }\n    .lds-ellipsis div:nth-child(3) div {\n      -webkit-animation-delay: -0.25s;\n      animation-delay: -0.25s;\n      background: #45aee7;\n    }\n    .lds-ellipsis div:nth-child(4) div {\n      -webkit-animation-delay: 0s;\n      animation-delay: 0s;\n      background: #0055a5;\n    }\n    .lds-ellipsis div:nth-child(5) div {\n      -webkit-animation: lds-ellipsis3 1s cubic-bezier(0, 0.5, 0.5, 1) infinite forwards;\n      animation: lds-ellipsis3 1s cubic-bezier(0, 0.5, 0.5, 1) infinite forwards;\n      background: #ce64a6;\n    }\n    .lds-ellipsis {\n      width: 70px !important;\n      height: 70px !important;\n      -webkit-transform: translate(-35px, -35px) scale(0.35) translate(35px, 35px);\n      transform: translate(-35px, -35px) scale(0.35) translate(35px, 35px);\n    }\n    .muted-button {\n      border-radius: 2px;\n      background-color: white;\n      position: absolute;\n      display: none;\n      z-index: 999;\n      padding: 3px;\n      border-color: white;\n      margin: 8px;\n    }\n    </style></div>'}var e,i;return e=t,(i=[{key:"getTemplate",value:function(){return'<canvas style="z-index:10;position:absolute; top:0; left:0;line-height:1;"></canvas>\n    <canvas style="z-index:15;position:absolute; top:0; left:0;line-height:1;"></canvas>\n    <div id="tic_video_wrap" style="z-index:20;position:absolute; top:0; left:0; display:none;"></div>\n    <div class="tic_board__imagewrap" style="position:absolute;z-index:7;width:100%;height:100%;"></div>\n    <div class="tic_board_textbox" style="position:absolute;z-index:10;width:100%;height:100%;"></div>\n    <div class="tic_cursorlayer__wrap" style="position:absolute;z-index:0;width:100%;height:100%;"></div>\n    <div class="tx_board_canvas_box" style="position: absolute;">'.concat(this.progressTemplate,'<img class="tic_board_img_bg" style="display:none; position:absolute; top:0; left:0;z-index:5;" />\n      <div class="tic_board_bg" style="z-index:4;position:absolute; top:0; left:0;"></div>\n      <textarea maxlength="').concat(o.TEXT_MAX_LENGTH,'" style="display:none;" rows="1"></textarea>\n      <iframe class="tic_iframe_H5" style="border:none;" scrolling="no"></iframe>\n    </div>')}}])&&yt(e.prototype,i),t}(),vt=i(93),Tt=i.n(vt);function St(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Et=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.src=e,this.dom=null,this.isRepeatLoad=!1}var e,i;return e=t,(i=[{key:"createElement",value:function(t,e,i){var r=this.remove(t,e);r?(this.dom=r,this.isRepeatLoad=!0):(this.isRepeatLoad=!1,this.dom=document.createElement("iframe"),this.dom.classList.add("tic_board_h5_bg"),this.dom.style.display="none",this.dom.style.border="none",this.dom.style.position="absolute",this.dom.style.top=0,this.dom.style.left=0,this.dom.style.zIndex=5,this.dom.src=e,this.dom.scrolling="no",this.dom.onload=function(){i&&i(this.src)},t.appendChild(this.dom))}},{key:"render",value:function(t){this.isRepeatLoad||t&&t(),this.dom.style.display="block"}},{key:"layout",value:function(t,e){this.dom.width=t,this.dom.height=e}},{key:"remove",value:function(t,e){for(var i=null,r=t.getElementsByClassName("tic_board_h5_bg"),o=0,n=r.length;o<n;o++){var s=r[o],a=s.getAttribute("src");!e||a!=e&&a!=encodeURI(e)?s.remove():i=s}return i}}])&&St(e.prototype,i),t}();function bt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ot=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.src=e,this.dom=null,this.isRepeatLoad=!1}var e,i;return e=t,(i=[{key:"createElement",value:function(t,e,i){var r=this.remove(t,e);r?(this.dom=r,this.isRepeatLoad=!0):(this.isRepeatLoad=!1,this.dom=document.createElement("iframe"),this.dom.classList.add("tic_board_h5_file"),this.dom.style.display="none",this.dom.style.border="none",this.dom.style.position="absolute",this.dom.style.top=0,this.dom.style.left=0,this.dom.style.zIndex=25,this.dom.src=e,this.dom.scrolling="auto",this.dom.onload=function(){i&&i()},t.appendChild(this.dom))}},{key:"render",value:function(t){this.isRepeatLoad||t&&t(),this.dom.style.display="block"}},{key:"layout",value:function(t,e){this.dom&&(this.dom.width=t,this.dom.height=e)}},{key:"remove",value:function(t,e){for(var i=null,r=t.getElementsByClassName("tic_board_h5_file"),o=0,n=r.length;o<n;o++){var s=r[o],a=s.getAttribute("src");!e||a!=e&&a!=encodeURI(e)?s.remove():i=s}return i}}])&&bt(e.prototype,i),t}();function xt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i;return e=t,i=[{key:"createElement",value:function(){var t=document.createElement("iframe");return t.classList.add("tic_iframe_H5"),t.style.border="none",t.scrolling="no",t.id=parseInt(1e7*Math.random()),t}}],null&&xt(e.prototype,null),i&&xt(e,i),t}();function It(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var At=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i;return e=t,(i=[{key:"onCompositionstart",value:function(){this.compositionLock=!0}},{key:"onCompositionupdate",value:function(){}},{key:"onCompositionend",value:function(){this.compositionLock=!1,this.compositionEndCallback&&this.compositionEndCallback()}}])&&It(e.prototype,i),t}();function Rt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wt=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this.listener=i,this._createElement(),this.isTouchDown=!1,this.touchId=null}var e,i;return e=t,(i=[{key:"_createElement",value:function(){var t=this.cursorPositionLayer=document.createElement("div");t.setAttribute("style","position:relative;left:0;top:0;width:100%;height:100%;border:1px dotted red;cursor:move;visibility: hidden;");var e=this.leftTopScaleEl=this._createScaleElement("left:-1px;top:-1px;cursor:nwse-resize;");t.appendChild(e);var i=this.rightTopScaleEl=this._createScaleElement("right:-1px;top:-1px;cursor:nesw-resize;");t.appendChild(i);var r=this.leftBottomScaleEl=this._createScaleElement("left:-1px;bottom:-1px;cursor:nesw-resize;");t.appendChild(r);var o=this.rightBottomScaleEl=this._createScaleElement("right:-1px;bottom:-1px;cursor:nwse-resize;");t.appendChild(o),this.container.appendChild(t)}},{key:"_createScaleElement",value:function(t){var e=document.createElement("div");return e.setAttribute("style","position:absolute;".concat(t,";width:12px;height:12px;background:red;")),e}},{key:"showSelectLayer",value:function(t){var e=this;this.imageElements=t,this._showSelectLayer(),this.cursorPositionLayer.style.visibility="visible",this.cursorPositionLayer.onmousedown=function(t){e.moveScaleAction(t,e.cursorPositionLayer)},this.leftTopScaleEl.onmousedown=function(t){e.moveScaleAction(t,e.leftTopScaleEl)},this.rightTopScaleEl.onmousedown=function(t){e.moveScaleAction(t,e.rightTopScaleEl)},this.leftBottomScaleEl.onmousedown=function(t){e.moveScaleAction(t,e.leftBottomScaleEl)},this.rightBottomScaleEl.onmousedown=function(t){e.moveScaleAction(t,e.rightBottomScaleEl)},this.cursorPositionLayer.ontouchstart=function(t){e.isTouchDown=!0,e.moveScaleAction(t,e.cursorPositionLayer),e.listener.ontouchstart&&e.listener.ontouchstart()},this.leftTopScaleEl.ontouchstart=function(t){e.moveScaleAction(t,e.leftTopScaleEl)},this.rightTopScaleEl.ontouchstart=function(t){e.moveScaleAction(t,e.rightTopScaleEl)},this.leftBottomScaleEl.ontouchstart=function(t){e.moveScaleAction(t,e.leftBottomScaleEl)},this.rightBottomScaleEl.ontouchstart=function(t){e.moveScaleAction(t,e.rightBottomScaleEl)}}},{key:"moveScaleAction",value:function(t,e){var i=this;t.stopPropagation(),t.preventDefault();var r=0,o=0,n=this._getEventPageXY(t);r=n.pageX,o=n.pageY,-1e6===r&&-1e6===o||(this.container.onmousemove=function(t){t.preventDefault(),t.stopPropagation();var n=i._getEventPageXY(t);if(-1e6!==n.pageX||-1e6!==n.pageY){if(e===i.cursorPositionLayer)i.setSize(0,0),i.setPosition(e,n.pageX-r,n.pageY-o);else if(e===i.leftTopScaleEl){var s=(i.borderWidth-(n.pageX-r))/i.borderWidth,a=(i.borderHeight-(n.pageY-o))/i.borderHeight;i.setPositionSize(e,s,a)}else if(e===i.rightTopScaleEl){var l=(i.borderWidth+n.pageX-r)/i.borderWidth,d=(i.borderHeight-(n.pageY-o))/i.borderHeight;i.setPositionSize(e,l,d)}else if(e===i.leftBottomScaleEl){var u=(i.borderWidth-(n.pageX-r))/i.borderWidth,c=(i.borderHeight+(n.pageY-o))/i.borderHeight;i.setPositionSize(e,u,c)}else if(e===i.rightBottomScaleEl){var h=(i.borderWidth+n.pageX-r)/i.borderWidth,p=(i.borderHeight+n.pageY-o)/i.borderHeight;i.setPositionSize(e,h,p)}r=n.pageX,o=n.pageY,i.listener.onmousemove&&i.listener.onmousemove(i.imageElements),i._showSelectLayer()}},this.container.onmouseleave=function(t){t.stopPropagation(),t.preventDefault(),i.container.onmousemove=null,i.container.onmouseleave=null,i.container.onmouseup=null,r=0,o=0},this.container.onmouseup=function(t){t.stopPropagation(),t.preventDefault(),i.container.onmousemove=null,i.container.onmouseleave=null,i.container.onmouseup=null,r=0,o=0},this.container.ontouchmove=function(t){t.stopPropagation(),t.preventDefault();var n=i._getEventPageXY(t);if(-1e6!==n.pageX||-1e6!==n.pageY){if(e===i.cursorPositionLayer)i.setSize(0,0),i.setPosition(e,n.pageX-r,n.pageY-o);else if(e===i.leftTopScaleEl){var s=(i.borderWidth-(n.pageX-r))/i.borderWidth,a=(i.borderHeight-(n.pageY-o))/i.borderHeight;i.setPositionSize(e,s,a)}else if(e===i.rightTopScaleEl){var l=(i.borderWidth+n.pageX-r)/i.borderWidth,d=(i.borderHeight-(n.pageY-o))/i.borderHeight;i.setPositionSize(e,l,d)}else if(e===i.leftBottomScaleEl){var u=(i.borderWidth-(n.pageX-r))/i.borderWidth,c=(i.borderHeight+(n.pageY-o))/i.borderHeight;i.setPositionSize(e,u,c)}else if(e===i.rightBottomScaleEl){var h=(i.borderWidth+n.pageX-r)/i.borderWidth,p=(i.borderHeight+n.pageY-o)/i.borderHeight;i.setPositionSize(e,h,p)}r=n.pageX,o=n.pageY,i.listener.onmousemove&&i.listener.onmousemove(i.imageElements),i._showSelectLayer()}},this.container.ontouchend=function(t){var e=i._getEventPageXY(t);-1e6===e.pageX&&-1e6===e.pageY||(i.isTouchDown=!1,i.touchId=null,t.stopPropagation(),t.preventDefault(),i.container.ontouchmove=null,i.container.ontouchend=null,i.container.ontouchcancel=null,r=0,o=0,i.listener.ontouchend&&i.listener.ontouchend())},this.container.ontouchcancel=function(t){var e=i._getEventPageXY(t);-1e6===e.pageX&&-1e6===e.pageY||(i.isTouchDown=!1,i.touchId=null,t.stopPropagation(),t.preventDefault(),i.container.ontouchmove=null,i.container.ontouchend=null,i.container.ontouchcancel=null,r=0,o=0,i.listener.ontouchcancel&&i.listener.ontouchcancel())})}},{key:"setPositionSize",value:function(t,e,i){var r=this;this.imageElements.forEach(function(o){var n,s,a=o.getRealSize();t===r.leftTopScaleEl?(n=a.left-r.borderLeft-r.borderWidth,s=a.top-r.borderTop-r.borderHeight):t===r.rightTopScaleEl?(n=a.left-r.borderLeft,s=a.top-r.borderTop-r.borderHeight):t===r.leftBottomScaleEl?(n=a.left-r.borderLeft-r.borderWidth,s=a.top-r.borderTop):t===r.rightBottomScaleEl&&(n=a.left-r.borderLeft,s=a.top-r.borderTop),o.setSize(a.width*(e-1),a.height*(i-1)),o.setPosition(!1,n*(e-1),s*(i-1))})}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.moveX+=e,this.moveY+=i,this.imageElements.forEach(function(t){t.setPosition(!0,e,i)})}},{key:"setSize",value:function(t,e){this.imageElements.forEach(function(i){i.setSize(t,e)})}},{key:"_showSelectLayer",value:function(){for(var t=1e4,e=1e4,i=0,r=0,o=0,n=this.imageElements.length;o<n;o++){var s=this.imageElements[o].getRealSize();t=Math.min(t,s.left),e=Math.min(e,s.top),i=Math.max(i,s.left+s.width),r=Math.max(r,s.top+s.height)}i-=t,r-=e,this.borderWidth=i,this.borderHeight=r,this.borderLeft=t,this.borderTop=e,this.cursorPositionLayer.style.left=t+"px",this.cursorPositionLayer.style.top=e+"px",this.cursorPositionLayer.style.width=i+"px",this.cursorPositionLayer.style.height=r+"px"}},{key:"setListener",value:function(t){this.listener=t}},{key:"_getEventPageXY",value:function(t){if(t.changedTouches){var e=null;if(null==this.touchId)this.touchId=t.changedTouches[0].identifier,e=t.changedTouches[0];else{for(var i=0,r=t.changedTouches.length;i<r;i++){var o=t.changedTouches[i];if(this.touchId===o.identifier){e=o;break}}e||(e={pageX:-1e6,pageY:-1e6})}return{pageX:e.pageX,pageY:e.pageY}}return{pageX:t.pageX,pageY:t.pageY}}}])&&Rt(e.prototype,i),t}();function Ct(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}i(127);var Pt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boardId=e.boardId,this.lineHeight=1,this.measureTextElement=document.getElementById("tic_measuretext__tool"),this.dpr=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||1,this.board=e.board}var e,i;return e=t,(i=[{key:"createElement",value:function(t){this.textContainer=t,this.dom=document.createElement("textarea"),this.dom.setAttribute("spellcheck",!1),t.appendChild(this.dom),this.initStyle()}},{key:"initStyle",value:function(){Object.assign(this.dom.style,{position:"absolute","z-index":9,"box-sizing":"content-box",outline:"none",resize:"none","word-break":"break-all",overflow:"hidden",background:"transparent","line-height":this.lineHeight+"px",border:"1px dotted transparent","font-family":"customFontFamily",margin:0,padding:0,"white-space":"pre-wrap","border-radius":0})}},{key:"initEvent",value:function(t){var e=this;this.eventConfig=t,this.dom.ontouchstart=function(t){t.stopPropagation()},this.dom.ontouchmove=function(t){t.stopPropagation()},this.dom.ontouchend=function(t){t.stopPropagation()},this.dom.ontouchcancel=function(t){t.stopPropagation()},this.dom.onmousedown=function(t){t.stopPropagation()},this.dom.onmousemove=function(t){t.stopPropagation()},this.dom.onmouseup=function(t){t.stopPropagation()},this.dom.onmouseleave=function(t){t.stopPropagation()},this.dom.onfocus=null,this.dom.onfocus=function(){if(e.maxHeight-2<=e.fontSize||e.maxWidth-2<=2*e.fontSize)e.dom.blur();else if(11==e.board.getToolType()){e.initStyle();var i=e._calcShowFullText(),r=i.scale,o=i.dragOffsetX,n=i.dragOffsetY;t.onfocus&&t.onfocus(e,o,n,r);var s=e._calcShowFullText(),a=s.scale,l=s.dragOffsetX,d=s.dragOffsetY;t.onfocus&&t.onfocus(e,l,d,a),e.showBorder(!0)}else e.dom.blur()},this.dom.compositionLock=!1,this.dom.addEventListener("compositionstart",function(){e.dom.compositionLock=!0}),this.dom.addEventListener("compositionend",function(t){d.isIOS8910()?setTimeout(function(){e.smartPaintText(t)},0):e.smartPaintText(t)}),this.dom.oninput=null,this.dom.oninput=function(t){e.dom.compositionLock||e.smartPaintText(t)},this.dom.onblur=null,this.dom.onblur=function(){e.showBorder(!1),""!==e.dom.value&&""!==e.dom.value.trim()||(e.textItem.show=!1,e.remove()),t.onblur&&t.onblur(e)}}},{key:"smartPaintText",value:function(t){var e=this,i=d.isIOS8910()?this.dom.selectionEnd:this.dom.selectionStart,r=!1;this.dom.compositionLock=!1;var o=0;if(this.dom.value.indexOf("\n\f")>-1){var n=new RegExp("\n\f","g");this.dom.value=this.dom.value.replace(n,function(t,e){return e<i&&(o+="\n\f".length),""})}i-=o,"\n"==this.dom.value.substr(this.dom.value.length-1)?(this.dom.value=this.dom.value+" ",this.measureTextElement.textContent=this.dom.value,r=!0):this.measureTextElement.textContent=this.dom.value;for(var s=0,a=0;a<this.dom.value.length;a++){var l=this.dom.value[a];if("\n"===l||"\n\f"===l);else if(this.measureTextElement.textContent=this.dom.value.substring(s,a+1),this.getMeasureTextToolComputedStyle("width")>this.dom.style.maxWidth.replace("px","")-this.fontSize&&(a<i&&(i+="\n\f".length),s=a+1,this.dom.value=this.dom.value.substring(0,a)+"\n\f"+this.dom.value.substring(a),this.measureTextElement.textContent=this.dom.value),this.measureTextElement.textContent=this.dom.value.substring(0,a+1),this.getMeasureTextToolComputedStyle("height")>1*this.dom.style.maxHeight.replace("px","")){this.dom.value=this.dom.value.substring(0,Math.max(this.dom.value.lastIndexOf("\n"),this.dom.value.lastIndexOf("\n\f"))),this.measureTextElement.textContent=this.dom.value,r=!1;break}}this.setSize(),r&&" "==this.dom.value.charAt(this.dom.value.length-1)&&(this.dom.value=this.dom.value.substring(0,this.dom.value.length-1)),this.dom.setSelectionRange?this.dom.setSelectionRange(i,i):(this.dom.selectionStart=i,this.dom.selectionEnd=i);var u=this._calcShowFullText(),c=u.scale,h=u.dragOffsetX,p=u.dragOffsetY;this.eventConfig.oninput&&this.eventConfig.oninput(this,h,p,c);var f=this._calcShowFullText(),g=f.scale,m=f.dragOffsetX,y=f.dragOffsetY;this.eventConfig.oninput&&this.eventConfig.oninput(this,m,y,g),setTimeout(function(){e.dom.scrollTop&&e.smartPaintText(t)},0)}},{key:"setTextItem",value:function(t){this.dom.id="tic-textarea__".concat(t.belongSeq),this.dom.value=t.text,this.textItem=t,this.setTextStyle()}},{key:"setFontSize",value:function(t){this.fontSize=t,this.lineHeight=this.fontSize,this.dom.style.fontSize=t+"px",this.dom.style.minWidth=this.fontSize+"px",this.dom.style.minHeight=this.fontSize+"px",this.dom.style.lineHeight=this.fontSize+"px",this.measureTextElement.style.fontSize=(this.fontSize/this.dpr).toFixed(4)+"px",this.measureTextElement.style.lineHeight=(this.fontSize/this.dpr).toFixed(4)+"px"}},{key:"setMaxSize",value:function(){var t=d.calcPointAndBoardRightBorderDistance(this.boardWidth,this.containerWidth,this.boardHeight,this.containerHeight,this.textItem.location.x,this.textItem.location.y),e=t.distanceX,i=t.distanceY;this.maxWidth=e-2,this.maxHeight=i-2,this.dom.style.maxWidth=this.maxWidth+"px",this.dom.style.maxHeight=this.maxHeight+"px"}},{key:"setPosition",value:function(t,e){this.dom.style.left=t+"px",this.dom.style.top=e+"px"}},{key:"showBorder",value:function(t){this.dom.style.border="1px dashed ".concat(t?"red":"transparent")}},{key:"focus",value:function(){this.dom.focus()}},{key:"setFontScale",value:function(t){this.fontScale=t,this.dom.style.transformOrigin="0 0",this.dom.style.transform="scale(".concat(t,")"),this.dom.style.webkitTransformOrigin="0 0",this.dom.style.webkitTransform="scale(".concat(t,")"),this.dom.style.maxWidth=this.maxWidth/t+"px",this.dom.style.maxHeight=this.maxHeight/t+"px",this.measureTextElement.style.transformOrigin="0 0",this.measureTextElement.style.transform="scale(".concat(t,")"),this.measureTextElement.style.webkitTransformOrigin="0 0",this.measureTextElement.style.webkitTransform="scale(".concat(t,")")}},{key:"setTextStyle",value:function(){var t={color:this.textItem.color},e=this.textItem.fontStyle;for(var i in 0===e?(t.fontStyle="normal",t.fontWeight="normal"):1===e?(t.fontStyle="normal",t.fontWeight="bold"):2===e?(t.fontStyle="italic",t.fontWeight="normal"):3===e&&(t.fontStyle="italic",t.fontWeight="bold"),t)this.dom.style[i]=t[i]}},{key:"setSize",value:function(t){var e,i;"\n"==(t=t||this.dom.value).substr(t.length-1)?this.measureTextElement.textContent=t+" ":this.measureTextElement.textContent=t,e=d.isIOS()?this.getMeasureTextToolComputedStyle("width")+6+"px":this.getMeasureTextToolComputedStyle("width","px"),i=this.getMeasureTextToolComputedStyle("height","px"),this.dom.style.width!=e&&(this.dom.style.width=e),this.dom.style.height!=i&&(this.dom.style.height=i),this.textItem.textWidth=(2+1*this.dom.style.width.replace("px",""))/this.boardWidth*1e4*this.fontScale,this.textItem.textHeight=this.dom.style.height.replace("px","")/this.boardHeight*1e4*this.fontScale,this.eventConfig&&this.eventConfig.onresize&&this.eventConfig.onresize(this)}},{key:"remove",value:function(){this.dom&&this.dom.remove()}},{key:"getMeasureTextToolComputedStyle",value:function(t,e){var i=window.getComputedStyle(this.measureTextElement),r=1*i[t].replace("px",""),o=1*i.fontSize.replace("px",""),n=1*i.lineHeight.replace("px","");return"width"===t?o>(this.fontSize/this.dpr).toFixed(4)&&o>=12||(r=12*r/o):"height"===t?r=n*this.measureTextElement.textContent.split("\n").length*this.dpr:r*=this.dpr,r=Math.ceil(r),e?r+e:r}},{key:"setBoardContainerSize",value:function(t,e,i,r){this.boardWidth=t,this.containerWidth=e,this.boardHeight=i,this.containerHeight=r}},{key:"_calcShowFullText",value:function(){var t=d.calcPointAndContainerRightBorderDistance(this.boardWidth,this.containerWidth,this.boardHeight,this.containerHeight,this.textContainer.style.left.replace("%",""),this.textContainer.style.top.replace("%",""),this.textItem.location.x,this.textItem.location.y),e=t.distanceX,i=t.distanceY,r=d.calcPointAndContainerLeftBorderDistance(this.boardWidth,this.containerWidth,this.boardHeight,this.containerHeight,this.textContainer.style.left.replace("%",""),this.textContainer.style.top.replace("%",""),this.textItem.location.x,this.textItem.location.y),o=r.distanceX,n=r.distanceY,s=this.dom.style.width.replace("px","")*this.fontScale+12*this.fontScale,a=this.dom.style.height.replace("px","")*this.fontScale+12*this.fontScale,l=0,u=0,c=0,h=0;return s>this.containerWidth?c=(s+12*this.fontScale)/this.containerWidth:l=o<0?(o-12*this.fontScale)/this.boardWidth*100:e<s?(s-e)/this.boardWidth*100:0,a>this.containerHeight?h=(a+12*this.fontScale)/this.containerHeight:u=n<0?(n-12*this.fontScale)/this.boardHeight*100:i<a?(a-i)/this.boardHeight*100:0,{scale:c>0&&h>0?Math.max(c,h):0==c&&0==h?0:Math.max(c,h),dragOffsetX:l,dragOffsetY:u}}}])&&Ct(e.prototype,i),t}();function Bt(t){var e=this;if(!(this instanceof Bt))return new Bt(t);this.option=Object.assign({},t),this.event=this.option.event,this.container=document.getElementById(this.option.id),this.container?(this.classId=this.option.classId,this.pinchScale=[],this.beforePinchScale,this.isMoving=!1,this.laserLineStatus=0,this.minLineWidth=t.minLineWidth||o.MIN_LINE_WIDTH,this.isRenderFace=!1,this.backgroundIFrameManager=new Et,this.h5Iframe=null,this.store=new at(t),this.execRenderLaserSeq=0,this.isTouchType="mouse",this.textInputStatus=0,this.touchID=null,this.resetVideoStatus(),this.isSyncVideoStatus=!0,this.isShowVideoControl=!0,this.syncVideoStatusTimer=null,this.syncVideoStatusPrecision=o.SYNC_VIDEO_STATUS_PRECISION,this.drawInterval=null,this.userTime={},this.enableSyncTime=!0,this.compositionEvent=new At,this.taskIdTitleMap={},this.textAreaComponentMap={},this.imageElementMapData={},this.textAreaFocusBlurStatus={},this.addFileNeedSwitchMap={},this.enableHandwriting=!1,this.enableLineOptimization=!0,this.boardImageLoadStatus={backgrounds:{},elements:{}},this.init(),this.initFont(),this.updateCursorIcons(),this.initMeasureTextElement(),this.initPermission()):setTimeout(function(){e.event.fire(e,"TEB_ERROR",N.TEDU_BOARD_ERROR_INIT,"not found id:"+e.option.id+" Node")},10)}Bt.prototype.initPermission=function(){Bt.hasVideoPermission()?_.report("has_video_permission",{}):(_.report("init_video_permission",{}),Bt.applyVideoPermission())},Bt.hasVideoPermission=function(){return!(!Bt.videoPermissionDiv||0==Bt.videoPermissionDiv.getElementsByTagName("video").length)},Bt.applyVideoPermission=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;if(Bt.hasVideoPermission())_.report("has_apply_video_permission",{});else{Bt.videoPermissionDiv=document.createElement("div"),Bt.videoPermissionDiv.id="board_permission_videos",Bt.videoPermissionDiv.style.display="none";for(var e=[],i=0;i<t;i++){var r=document.createElement("video");r.setAttribute("class","video-js"),r.setAttribute("x5-video-player-type","h5-page"),r.setAttribute("controlsList","nodownload nofullscreen"),r.setAttribute("disablePictureInPicture","disablePictureInPicture"),r.setAttribute("webkit-playsinline","webkit-playsinline"),r.setAttribute("playsinline","playsinline"),r.setAttribute("style","height:100%; width:100%;"),Bt.videoPermissionDiv.appendChild(r),e.push(r)}document.body.appendChild(Bt.videoPermissionDiv),e.forEach(function(t){try{t.play().catch(function(){})}catch(t){}}),_.report("apply_video_permission",{extra_info:JSON.stringify({count:t})})}},Bt.prototype.updateCursorIcons=function(){this.penIcon=new Image,this.penIcon.onerror=function(){this.src.indexOf("try=true")>-1||(-1==this.src.indexOf("?")?this.src=this.src+"?try=true":this.src=this.src+"&try=true")},this.penIcon.src=o.ICONS[1].url,this.laserIcon=new Image,this.laserIcon.onerror=function(){this.src.indexOf("try=true")>-1||(-1==this.src.indexOf("?")?this.src=this.src+"?try=true":this.src=this.src+"&try=true")},this.laserIcon.src=o.ICONS[3].url},Bt.prototype.initMeasureTextElement=function(){var t=document.createElement("div");t.id="tic_measuretext__tool",t.style.position="fixed",t.style.left="-10000px",t.style.fontFamily="customFontFamily",t.style.visibility="hidden",t.style.boxSizing="content-box",t.style.display="inline-block",t.style.margin=0,t.style.padding=0,t.style.whiteSpace="pre-wrap",t.style.lineHeight=1,document.body.appendChild(t)},Bt.prototype.initFont=function(){var t=document.createElement("style");t.type="text/css",t.innerHTML="@font-face {font-family: 'customFontFamily';src: url(".concat(o.fontUrl,") format('truetype');}");var e=document.createElement("div");e.style.fontFamily="customFontFamily",e.style.position="fixed",e.style.left="-10000px",e.style.width="1px",e.innerHTML="&nbsp;",document.body.appendChild(t),document.body.appendChild(e)},Bt.prototype.resize=function(){this.draw()},Bt.prototype.getEventLocation=function(t){var e,i,r={x:0,y:0,ox:0,oy:0},o=t.currentTarget.getElementsByClassName("tx_board_canvas_box")[0],n=o.getBoundingClientRect();if(t.changedTouches){var s=null,a={x:-1e6,y:-1e6,ox:-1e6,oy:-1e6};if("touchstart"==t.type){if(null!=this.touchID&&1!==t.touches.length)return a;this.touchID=t.changedTouches[0].identifier,s=t.changedTouches[0]}else if("touchmove"==t.type){for(var l=0;l<t.changedTouches.length;l++)if(t.changedTouches[l].identifier==this.touchID){s=t.changedTouches[l];break}if(!s)return a}else if("touchend"==t.type||"touchcancel"==t.type){for(var d=0;d<t.changedTouches.length;d++)if(t.changedTouches[d].identifier==this.touchID){s=t.changedTouches[d];break}if(!s&&0!==t.touches.length)return a;this.touchID=null}e=s.pageX-n.left-o.ownerDocument.defaultView.pageXOffset,i=s.pageY-n.top-o.ownerDocument.defaultView.pageYOffset,r.clientX=parseInt(s.clientX),r.clientY=parseInt(s.clientY)}else e=t.pageX-n.left-o.ownerDocument.defaultView.pageXOffset,i=t.pageY-n.top-o.ownerDocument.defaultView.pageYOffset,r.clientX=parseInt(t.clientX),r.clientY=parseInt(t.clientY);return r.x=parseInt(e/this.width*1e4),r.y=parseInt(i/this.height*1e4),r.ox=parseInt(e),r.oy=parseInt(i),r},Bt.prototype.draw=function(){if(this.store.getCurrentBoard()){var t=this.store.getCurrentBoardData(),e=t.backgroundPic;if(this.layout()){var i=this.el.getContext("2d");i.clearRect(0,0,this.width,this.height),this.preloadTriggered=!1;var r=this.getFileInfo(this.getCurrentFile());r&&(this.renderVideo(r),this.renderH5PPT(r),this.renderH5File(r),this.renderBackgroundImageAndH5(e),this.renderBackgroundColor(t.backgroundColor,r),this.drawData(t.data,i),this.preloadTriggered||this.store.preloadBoard())}else this.store.setNeedDraw(!0)}},Bt.prototype.drawFace=function(){if(this.store.getCurrentBoard()){var t=this.store.getFaceData();if(t.fileInfo&&this.layout(t.fileInfo)){var e=this.el.getContext("2d");this.laserCanvas&&this.laserCanvas.getContext("2d"),e.clearRect(0,0,this.width,this.height),this.preloadTriggered=!1,this.renderH5PPT(t.fileInfo),this.renderBackgroundImageAndH5(t.currentPic),this.renderBackgroundColor(t.backgroundColor,t.fileInfo),this.drawData(t.data,e),this.preloadTriggered||this.store.preloadBoard()}}},Bt.prototype._displayImage=function(){this.img.removeAttribute("src"),this.img.removeAttribute("width"),this.img.removeAttribute("height"),this.img.style.display="none"},Bt.prototype.renderBackgroundImageAndH5=function(t){var e=this,i=this,r=this.getCurrentBoard(),s=this.boardImageLoadStatus.backgrounds,a=!0;if(s?s.boardId!=r?"start"===s.status&&(this.event.fire(this,"TEB_IMAGE_STATUS_CHANGED",pt,{currentBoardId:s.boardId,imgUrl:s.url,currentImgUrl:this.img.currentSrc}),this._displayImage(),s.status="cancel",_.report("load_cancel_img",{time_consume:d.getTimeStamp()-c,image_url:s.url,boardid:s.boardId,extra_info:JSON.stringify({image_url:s.url,boardid:s.boardId,currentSrc:this.img.currentSrc})})):"cancel"!==s.status&&"timeout"!==s.status&&"start"!==s.status||(a=!1):(s={boardId:r,status:null,url:null},this.boardImageLoadStatus.backgrounds[r]=s),t.url&&t.show)if(t.type===n.BACKGROUND_TYPE.IMAGE){if(!a)return;var l=t.mode||n.FILL_MODE.DEFAULT,u=t.url!==i.img.src&&encodeURI(t.url)!==i.img.src&&decodeURI(t.url)!==decodeURI(i.img.src);if(navigator.userAgent.toLocaleLowerCase().indexOf("iphone os 8")>-1&&decodeURI(t.url)==decodeURI(i.img.src).replace(/(&|\?)imgtime=\d+_imgtime/g,"")&&(u=!1),u){var c=d.getTimeStamp();i.img.onload=function(){s.status="loaded";var e=i.img.naturalWidth,r=i.img.naturalHeight;i.width/i.height>e/r?(i.img.setAttribute("height",i.height),l===n.FILL_MODE.DEFAULT?i.img.setAttribute("style","display:none; position:absolute !important; top:0 !important; left:50% !important;transform: translateX(-50%) !important;-webkit-transform: translateX(-50%) !important;z-index:5 !important;"):l===n.FILL_MODE.LEFT?i.img.setAttribute("style","display:none; position:absolute !important; top:0 !important; left:0 !important;z-index:5 !important;"):l===n.FILL_MODE.TOP?i.img.setAttribute("style","display:none; position:absolute !important; top:0 !important; left:50% !important;transform: translateX(-50%) !important;-webkit-transform: translateX(-50%) !important;z-index:5 !important;"):l===n.FILL_MODE.RIGHT?i.img.setAttribute("style","display:none; position:absolute !important; top:0 !important; right:0 !important;z-index:5 !important;"):(n.FILL_MODE.BOTTOM,i.img.setAttribute("style","display:none; position:absolute !important; top:0 !important; left:50% !important;transform: translateX(-50%) !important;-webkit-transform: translateX(-50%) !important;z-index:5 !important;")),i.img.removeAttribute("width")):(i.img.setAttribute("width",i.width),l===n.FILL_MODE.DEFAULT?i.img.setAttribute("style","display:none; position:absolute !important; top:50% !important; left:0 !important;transform: translateY(-50%) !important;-webkit-transform: translateY(-50%) !important;z-index:5 !important;"):l===n.FILL_MODE.LEFT?i.img.setAttribute("style","display:none; position:absolute !important; top:50% !important; left:0 !important;transform: translateY(-50%) !important;-webkit-transform: translateY(-50%) !important;z-index:5 !important;"):l===n.FILL_MODE.TOP?i.img.setAttribute("style","display:none; position:absolute !important; top:0 !important; left:0 !important;z-index:5 !important;"):l===n.FILL_MODE.RIGHT?i.img.setAttribute("style","display:none; position:absolute !important; top:50% !important; left:0 !important;transform: translateY(-50%) !important;-webkit-transform: translateY(-50%) !important;z-index:5 !important;"):l===n.FILL_MODE.BOTTOM?i.img.setAttribute("style","display:none; position:absolute !important; bottom:0 !important; left:0 !important;z-index:5 !important;"):i.img.setAttribute("style","display:none; position:absolute !important; top:50% !important; left:0 !important;transform: translateY(-50%) !important;-webkit-transform: translateY(-50%) !important;z-index:5 !important;"),i.img.removeAttribute("height")),i.img.style.display="block",i.img.onload=null,clearTimeout(i.pregressTask),i.progress.style.display="none",i.event.fire(this,"TEB_IMAGE_STATUS_CHANGED",dt,{currentBoardId:i.getCurrentBoard(),imgUrl:t.url,currentImgUrl:i.img.currentSrc}),_.report("load_succ_img",{time_consume:d.getTimeStamp()-c,image_url:t.url,boardid:i.getCurrentBoard(),extra_info:JSON.stringify({image_url:t.url,boardid:i.getCurrentBoard(),currentSrc:i.img.currentSrc})}),i.store.preloadBoard()},i.img.onabort=function(){s.status="abort",i.img.onabort=null,clearTimeout(i.pregressTask),i.progress.style.display="none",i.event.fire(this,"TEB_IMAGE_STATUS_CHANGED",ut,{currentBoardId:i.getCurrentBoard(),imgUrl:t.url,currentImgUrl:i.img.currentSrc}),_.report("load_abort_img",{time_consume:d.getTimeStamp()-c,image_url:t.url,boardid:i.getCurrentBoard(),extra_info:JSON.stringify({image_url:t.url,boardid:i.getCurrentBoard(),currentSrc:i.img.currentSrc})}),i.store.preloadBoard()},i.img.onerror=function(){if(s.status="error",i.img.currentSrc.endsWith("try=1"))i.img.style.display="none",i.img.onerror=null,clearTimeout(i.pregressTask),i.progress.style.display="none",i.event.fire(this,"TEB_IMAGE_STATUS_CHANGED",ct,{currentBoardId:i.getCurrentBoard(),imgUrl:t.url,currentImgUrl:i.img.currentSrc}),_.report("load_error_img",{time_consume:d.getTimeStamp()-c,image_url:t.url,boardid:i.getCurrentBoard(),extra_info:JSON.stringify({image_url:t.url,boardid:i.getCurrentBoard(),currentSrc:i.img.currentSrc})});else{var e=t.url;t.url.indexOf("?")>-1?e+="&try=1":e+="?try=1",i.img.src=e,_.report("load_try_img",{time_consume:d.getTimeStamp()-c,image_url:e,boardid:i.getCurrentBoard(),extra_info:JSON.stringify({image_url:e,boardid:i.getCurrentBoard(),currentSrc:i.img.currentSrc})})}i.store.preloadBoard()},i.event.fire(this,"TEB_IMAGE_STATUS_CHANGED",lt,{currentBoardId:i.getCurrentBoard(),imgUrl:t.url,currentImgUrl:i.img.currentSrc}),_.report("start_load_img",{image_url:t.url,boardid:i.getCurrentBoard(),extra_info:JSON.stringify({image_url:t.url,boardid:i.getCurrentBoard(),currentSrc:i.img.currentSrc})}),i.img.style.display="none",navigator.userAgent.toLocaleLowerCase().indexOf("iphone os 8")>-1?t.url.indexOf("?")>-1?i.img.src=t.url+"&imgtime="+Date.now()+"_imgtime":i.img.src=t.url+"?imgtime="+Date.now()+"_imgtime":i.img.src=t.url,s.status="start",s.boardId=r,s.url=t.url,clearTimeout(this.checkImageStatusTask),this.checkImageStatusTask=setTimeout(function(){"start"===s.status&&(e.event.fire(e,"TEB_IMAGE_STATUS_CHANGED",ht,{currentBoardId:s.boardId,imgUrl:s.url,currentImgUrl:e.img.currentSrc}),e._displayImage(),s.status="timeout",_.report("load_timeout_img",{time_consume:d.getTimeStamp()-c,image_url:s.url,boardid:s.boardId,extra_info:JSON.stringify({image_url:s.url,boardid:s.boardId,currentSrc:e.img.currentSrc})}))},1e3*this.store.getImageTimeout()),i.preloadTriggered=!0,clearTimeout(this.pregressTask),i.pregressTask=setTimeout(function(){i.store.isProgressEnable()&&(i.progress.style.display="block")},o.PROGRESS_SHOW_DELAY)}else{i.img.style.display="none";var h=i.img.naturalWidth,p=i.img.naturalHeight;i.width/i.height>h/p?(i.img.setAttribute("height",i.height),l===n.FILL_MODE.DEFAULT?i.img.setAttribute("style","display:none; position:absolute; top:0; left:50%;transform: translateX(-50%);-webkit-transform: translateX(-50%);z-index:5;"):l===n.FILL_MODE.LEFT?i.img.setAttribute("style","display:none; position:absolute; top:0; left:0;z-index:5;"):l===n.FILL_MODE.TOP?i.img.setAttribute("style","display:none; position:absolute; top:0; left:50%;transform: translateX(-50%);-webkit-transform: translateX(-50%);z-index:5;"):l===n.FILL_MODE.RIGHT?i.img.setAttribute("style","display:none; position:absolute; top:0; right: 0;z-index:5;"):(n.FILL_MODE.BOTTOM,i.img.setAttribute("style","display:none; position:absolute; top:0; left:50%;transform: translateX(-50%);-webkit-transform: translateX(-50%);z-index:5;")),i.img.removeAttribute("width")):(i.img.setAttribute("width",i.width),l===n.FILL_MODE.DEFAULT?i.img.setAttribute("style","display:none; position:absolute; top:50%; left:0;transform: translateY(-50%);-webkit-transform: translateY(-50%);z-index:5;"):l===n.FILL_MODE.LEFT?i.img.setAttribute("style","display:none; position:absolute; top:50%; left:0;transform: translateY(-50%);-webkit-transform: translateY(-50%);z-index:5;"):l===n.FILL_MODE.TOP?i.img.setAttribute("style","display:none; position:absolute; top:0; left:0;z-index:5;"):l===n.FILL_MODE.RIGHT?i.img.setAttribute("style","display:none; position:absolute; top:50%; left:0;transform: translateY(-50%);-webkit-transform: translateY(-50%);z-index:5;"):l===n.FILL_MODE.BOTTOM?i.img.setAttribute("style","display:none; position:absolute; bottom:0; left:0;z-index:5;"):i.img.setAttribute("style","display:none; position:absolute; top:50%; left:0;transform: translateY(-50%);-webkit-transform: translateY(-50%);z-index:5;"),i.img.removeAttribute("height")),i.img.style.display="block"}i.preloadTriggered=!0,this.backgroundIFrameManager.remove(this.boardBox)}else this._displayImage(),this.backgroundIFrameManager.createElement(this.boardBox,t.url,function(t){t&&(i.event.fire(i,"TEB_H5BACKGROUND_STATUS_CHANGED",gt,{currentBoardId:i.getCurrentBoard(),url:t}),_.report("iframe_load_done",{boardid:i.getCurrentBoard(),extra_info:"H5_Background",image_url:t})),clearTimeout(i.pregressTask),i.progress.style.display="none",i.store.preloadBoard()}),this.backgroundIFrameManager.layout(i.width,i.height),this.backgroundIFrameManager.render(function(){e.preloadTriggered=!0,clearTimeout(e.pregressTask),e.pregressTask=setTimeout(function(){e.store.isProgressEnable()&&(e.progress.style.display="block")},o.PROGRESS_SHOW_DELAY),e.event.fire(e,"TEB_H5BACKGROUND_STATUS_CHANGED",ft,{currentBoardId:e.getCurrentBoard(),url:t.url}),_.report("iframe_start_load",{boardid:e.getCurrentBoard(),extra_info:"H5_Background",image_url:t.url})});else this._displayImage(),this.backgroundIFrameManager.remove(this.boardBox)},Bt.prototype.renderH5File=function(t){var e=this,i=t.fid,r=t.type,n=t.downloadURL;if(r==o.FILE_TYPE.H5FILE&&n){if(!this.h5Iframe||this.h5Iframe.src!=n){var s=this;this.h5Iframe&&(this.h5Iframe.remove(this.boardWrap),this.h5Iframe=null),this.h5Iframe=new Ot(n),this.h5Iframe.createElement(this.boardWrap,n,function(){n&&(s.event.fire(s,"TEB_H5FILE_STATUS_CHANGED",{fileId:i,status:mt.TEDU_BOARD_H5_FILE_STATUS_LOADED}),_.report("iframe_load_done",{file_id:i,extra_info:"H5_FILE",url:n}))});var a=this.boardWrap.clientWidth,l=this.boardWrap.clientHeight;this.h5Iframe.layout(a,l),this.h5Iframe.render(function(){e.event.fire(e,"TEB_H5FILE_STATUS_CHANGED",{fileId:i,status:mt.TEDU_BOARD_H5_FILE_STATUS_LOADING}),_.report("iframe_start_load",{fid:i,extra_info:"H5_FILE",image_url:n})})}}else this.h5Iframe&&(this.h5Iframe.remove(this.boardWrap),this.h5Iframe=null)},Bt.prototype.getVideoFormat=function(t){var e=t.split(":"),i=o.VIDEO_FORMAT.NONE;return 0!=e.length&&"rtmp"==e[0].toLocaleLowerCase()?i=o.VIDEO_FORMAT.RTMP:0!=(e=t.split(".")).length&&("m3u8"==(i=e[e.length-1].toLocaleLowerCase())?i=o.VIDEO_FORMAT.M3U8:"flv"==i?i=o.VIDEO_FORMAT.FLV:"mp4"==i&&(i=o.VIDEO_FORMAT.MP4)),i},Bt.prototype.getVideoType=function(t){var e=this.getVideoFormat(t);return e==o.VIDEO_FORMAT.MP4?o.FILE_TYPE.VOD:e==o.VIDEO_FORMAT.M3U8||e==o.VIDEO_FORMAT.RTMP||e==o.VIDEO_FORMAT.FLV?o.FILE_TYPE.LIVE:o.FILE_TYPE.NONE},Bt.prototype.videoPlayed=function(t){if(""===this.videoStatus.fid)return _.report("video_palyed_null"),this.videoStatus.actions.pause=o.VIDEO_ACTION.PASSIVE,void this.videoPlayer.pause();if(this.videoStatus.preStatus=o.VIDEO_STATUS.PLAY,!this.isShowVideoControl&&this.videoStatus.actions.play==o.VIDEO_ACTION.EXCEPTIOIN||document.hidden)_.report("video_played_exception",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.play,hidden:document.hidden})}),this.store.setNeedDraw();else if(this.videoStatus.actionTimes.play=0,this.videoStatus.isLoaded){var e=this.videoPlayer.currentTime()||0,i=this.videoStatus.duration,r=this.videoStatus.fid,n=this.isSyncVideoStatus;this.videoStatus.actions.play==o.VIDEO_ACTION.PASSIVE&&(n=!1);var s=o.VIDEO_STATUS.PLAY;this.store.updateVideo(r,s,-1,n),this.store.setNeedDraw(),this.videoStatus.isFixed.play?(_.report("video_played",{file_id:r,extra_info:JSON.stringify({url:this.videoStatus.url,progress:e,duration:i,needSync:n})}),this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:r,status:it.TEDU_BOARD_VIDEO_STATUS_PLAYED,progress:e,duration:i})):(this.videoStatus.isFixed.play=!0,_.report("video_played_fixed",{file_id:r,extra_info:JSON.stringify({url:this.videoStatus.url})}),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded())}else this.store.setNeedDraw();this.videoStatus.actions.play=o.VIDEO_ACTION.EXCEPTIOIN},Bt.prototype.videoLoaded=function(){_.report("video_loaded",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,progress:this.videoPlayer.currentTime(),duration:this.videoPlayer.duration()})}),this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:this.videoStatus.fid,status:it.TEDU_BOARD_VIDEO_STATUS_LOADED,progress:this.videoPlayer.currentTime(),duration:this.videoPlayer.duration()})},Bt.prototype.videoCreated=function(){if(""!==this.videoStatus.fid){if(!this.isShowVideoControl&&this.videoStatus.actions.create==o.VIDEO_ACTION.EXCEPTIOIN||document.hidden)_.report("video_created_exception",{file_id:e,extra_info:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.create,hidden:document.hidden})}),this.store.setNeedDraw();else if(1!=this.videoStatus.isLoaded){this.videoDiv.setAttribute("style","z-index:20; position:absolute; top:0; left:0; height:".concat(this.height,"px; width:").concat(this.width,"px; display:block; outline:none;")),this.showVideoControl(this.isShowVideoControl);var t=this.videoPlayer.duration()||0,e=this.videoStatus.fid,i=this.videoStatus.url,r=this.videoStatus.type;this.videoStatus.duration=t,this.videoStatus.actions.create==o.VIDEO_ACTION.PASSIVE||this.store.addVideoFile(e,i,this.width,this.height,r),this.videoStatus.isLoaded=!0,_.report("video_created",{file_id:e,extra_info:JSON.stringify({url:this.videoStatus.url,duration:t})});var n=this.getFileInfo(this.videoStatus.fid),s=0;if(n){s=n.progress;var a=d.getTimeStamp();n.status==o.VIDEO_STATUS.PLAY&&(s=Math.floor((a-n.timestamp)/1e3+s))}this.store.updateVideo(e,-1,s,!1),this.store.setNeedDraw(),n.status!=o.VIDEO_STATUS.STOP&&n.status!=o.VIDEO_STATUS.PAUSE||this.videoStatus.preStatus==o.VIDEO_STATUS.PAUSE||(this.videoStatus.isFixed.pause=!1),n.status==o.VIDEO_STATUS.PLAY&&this.videoStatus.preStatus!=o.VIDEO_STATUS.PLAY&&(this.videoStatus.isFixed.play=!1),Math.floor(n.progress)!=Math.floor(this.videoStatus.preProgress)&&(this.videoStatus.isFixed.seek=!1),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded()}this.videoStatus.actions.create=o.VIDEO_ACTION.EXCEPTIOIN}else _.report("video_created_null")},Bt.prototype.videoPaused=function(t){if(this.videoStatus.preStatus=o.VIDEO_STATUS.PAUSE,!this.isShowVideoControl&&this.videoStatus.actions.pause==o.VIDEO_ACTION.EXCEPTIOIN||document.hidden)_.report("video_paused_exception",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.pause,hidden:document.hidden})}),this.store.setNeedDraw();else{this.videoStatus.actionTimes.pause=0;var e=document.querySelector("div.tx_board_canvas_box");if(e&&e.parentNode)if(this.videoStatus.isLoaded){var i=this.videoPlayer.currentTime()||0,r=this.videoStatus.duration,n=this.videoStatus.fid,s=this.isSyncVideoStatus;this.videoStatus.actions.pause==o.VIDEO_ACTION.PASSIVE&&(s=!1);var a=o.VIDEO_STATUS.PAUSE;this.store.updateVideo(n,a,-1,s),this.store.setNeedDraw(),this.videoStatus.isFixed.pause?(_.report("video_paused",{file_id:n,extra_info:JSON.stringify({url:this.videoStatus.url,progress:i,duration:r,needSync:s})}),this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:n,status:it.TEDU_BOARD_VIDEO_STATUS_PAUSED,progress:i,duration:r})):(this.videoStatus.isFixed.pause=!0,_.report("video_paused_fixed",{file_id:n,extra_info:JSON.stringify({url:this.videoStatus.url})}),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded())}else this.store.setNeedDraw()}this.videoStatus.actions.pause=o.VIDEO_ACTION.EXCEPTIOIN},Bt.prototype.videoTimeUpdate=function(t){if(!document.hidden)if(""!==this.videoStatus.fid){if(this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoStatus.preStatus==o.VIDEO_STATUS.PLAY){var e=this.videoStatus.fid,i=this.videoStatus.duration,r=this.videoPlayer.currentTime()||0;this.videoStatus.preProgress=r,this.store.updateVideo(e,-1,r,!1),this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:e,status:it.TEDU_BOARD_VIDEO_STATUS_TIMEUPDATE,progress:r,duration:i})}}else _.report("video_videoTimeUpdate_null")},Bt.prototype.videoEnded=function(){var t=this.videoStatus.fid,e=this.videoPlayer.duration();this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:t,status:it.TEDU_BOARD_VIDEO_STATUS_ENDED,progress:e,duration:e}),this.videoStatus.preProgress=e,this.videoStatus.preStatus=o.VIDEO_STATUS.STOP,_.report("video_ended",{file_id:t,extra_info:JSON.stringify({url:this.videoStatus.url,needSync:!1})}),this.store.updateVideo(t,o.VIDEO_STATUS.STOP,e,!1)},Bt.prototype.videoSeeked=function(){if(!this.isShowVideoControl&&this.videoStatus.actions.seek==o.VIDEO_ACTION.EXCEPTIOIN||document.hidden)_.report("video_seeked_exception",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,isShowVideoControl:this.isShowVideoControl,videoAction:this.videoStatus.actions.seek,hidden:document.hidden})}),this.store.setNeedDraw();else if(this.videoStatus.actionTimes.seek=0,this.videoStatus.isLoaded){var t=this.videoPlayer.currentTime()||0,e=this.videoStatus.duration,i=this.videoStatus.fid;this.videoStatus.preProgress=t;var r=this.isSyncVideoStatus;this.videoStatus.actions.seek==o.VIDEO_ACTION.PASSIVE&&(r=!1),this.videoStatus.preStatus,this.store.updateVideo(i,-1,t,r),this.store.setNeedDraw(),this.videoStatus.isFixed.seek?(_.report("video_seeked",{file_id:i,extra_info:JSON.stringify({url:this.videoStatus.url,progress:t,duration:e,needSync:r})}),this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:i,status:it.TEDU_BOARD_VIDEO_STATUS_SEEKED,progress:t,duration:e})):(this.videoStatus.isFixed.seek=!0,_.report("video_seeked_fixed",{file_id:i,extra_info:JSON.stringify({url:this.videoStatus.url})}),this.videoStatus.isFixed.play&&this.videoStatus.isFixed.pause&&this.videoStatus.isFixed.seek&&this.videoLoaded())}else this.store.setNeedDraw();this.videoStatus.actions.seek=o.VIDEO_ACTION.EXCEPTIOIN},Bt.prototype.videoMetaDataLoaded=function(){_.report("video_metadata_loaded",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})})},Bt.prototype.videoWaiting=function(){this.videoStatus.waitingTime=d.getTimeStamp(),this.videoStatus.isWaiting=!0,_.report("video_waiting",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})})},Bt.prototype.videoPlaying=function(){if(this.videoStatus.isWaiting){this.videoStatus.isWaiting=!1;var t=d.getTimeStamp()-this.videoStatus.waitingTime;_.report("video_playing",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,cost:t})})}},Bt.prototype.videoError=function(){this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:this.videoStatus.fid,status:it.TEDU_BOARD_VIDEO_STATUS_ERROR,progress:0,duration:0});var t=this.videoPlayer.error();_.report("video_error",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,code:t.code,msg:t.message})})},Bt.prototype.visibilityChange=function(){"hidden"===document.visibilityState?(this.store.setVisible(!1),_.report("move_background",{})):(this.store.setVisible(!0),_.report("move_foreground",{}),d.isMobile()&&this.store.setNeedDraw())},Bt.prototype.createVideo=function(t,e){var i=this.boardWrap.clientWidth,r=this.boardWrap.clientHeight;this.videoDiv.setAttribute("style","z-index:20; position:absolute; top:0; left:0; height:".concat(r,"px; width:").concat(i,"px; display:none;")),this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:t,status:it.TEDU_BOARD_VIDEO_STATUS_LOADING,progress:0,duration:0});var n=this;if(this.videoTag)this.videoPlayer.src([{src:e}]),this.videoPlayer.load(e),setTimeout(function(){d.isMobile()&&(window.WeixinJSBridge?window.WeixinJSBridge.invoke("getNetworkType",{},function(t){n.videoStatus.actions.play=o.VIDEO_ACTION.PASSIVE,n.videoPlayer.play()},!1):(n.videoStatus.actions.play=o.VIDEO_ACTION.PASSIVE,n.videoPlayer.play()))},500);else{if(!Bt.hasVideoPermission())return;if(this.videoTag=Bt.videoPermissionDiv.getElementsByTagName("video")[0],this.videoTag.setAttribute("data-fid",t),this.videoTag.addEventListener("mousedown",function(t){t.stopPropagation()}),this.videoTag.addEventListener("touchstart",function(t){t.stopPropagation()}),this.videoTag.pause(),!this.videoTag)return void _.report("no_auth_video",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})});var s=Math.floor(1e6*Math.random());this.videoTag.id="tic_video_".concat(s),this.videoDiv.appendChild(this.videoTag),this.videoPlayer=window.videojs(this.videoTag.id,{width:i,height:r,preload:"auto"},function(){this.src([{src:e}]),this.on("loadstart",function(){}),this.on("loadedmetadata",function(){n.videoMetaDataLoaded(),n.videoStatus.isLoaded||d.isMobile()||n.videoCreated()}),this.on("loadeddata",function(){}),this.on("canplay",function(){_.report("video_canplay",{file_id:n.videoStatus.fid,extra_info:JSON.stringify({url:n.videoStatus.url,duration:this.duration()})})}),this.on("durationchange",function(){_.report("video_durationchange",{file_id:n.videoStatus.fid,extra_info:JSON.stringify({url:n.videoStatus.url,duration:this.duration()})})}),this.on("play",function(){n.videoPlayed(),n.videoStatus.isLoaded||d.isMobile()&&n.videoCreated()}),this.on("pause",function(){n.videoPaused()}),this.on("ended",function(){n.videoEnded()}),this.on("seeked",function(){n.videoSeeked()}),this.on("timeupdate",function(){n.videoTimeUpdate()}),this.on("waiting",function(){n.videoWaiting()}),this.on("playing",function(){n.videoPlaying()}),this.on("error",function(){n.videoError()}),setTimeout(function(){if(d.isMobile())if(window.WeixinJSBridge)window.WeixinJSBridge.invoke("getNetworkType",{},function(t){var e=d.getTimeStamp();n.videoStatus.actionTimes.play=e,n.videoStatus.actions.play=o.VIDEO_ACTION.PASSIVE,n.videoPlayer.play(),setTimeout(function(){n&&n.videoStatus.actionTimes.play==e&&(_.report("wxcreate_play_miss_callback",{file_id:n.videoStatus.fid,extra_info:JSON.stringify({url:n.videoStatus.url})}),n.videoPlayer.play())},2e3)},!1);else{var t=d.getTimeStamp();n.videoStatus.actionTimes.play=t,n.videoStatus.actions.play=o.VIDEO_ACTION.PASSIVE,n.videoPlayer.play(),setTimeout(function(){n&&n.videoStatus.actionTimes.play==t&&(_.report("create_play_miss_callback",{file_id:n.videoStatus.fid,extra_info:JSON.stringify({url:n.videoStatus.url})}),n.videoPlayer.play())},2e3)}},500)})}},Bt.prototype.splitVodVideoOption=function(t){var e=t.split("_");return 3!=e.length?{appId:0,vodId:0,hasExt:"false"}:{appId:e[0],vodId:e[1],hasExt:e[2]}},Bt.prototype.createVodVideo=function(t,e){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.videoPlayer){var n=this.boardWrap.clientWidth,s=this.boardWrap.clientHeight;this.videoDiv.setAttribute("style","z-index:20; position:absolute; top:0; left:0; height:".concat(s,"px; width:").concat(n,"px; display:none"));var a=document.createElement("video"),l="tic_video_".concat(d.getTimeStamp());a.setAttribute("style","width:100%; height:100%"),a.setAttribute("id",l),this.videoDiv.appendChild(a),this.event.fire(this,"TEB_VIDEO_STATUS_CHANGED",{fileId:t,status:it.TEDU_BOARD_VIDEO_STATUS_LOADING,progress:0,duration:0});var u=this.splitVodVideoOption(e),c={appID:u.appId,fileID:u.vodId,width:n,height:s};if(r)for(var h in r)c[h]=r[h];this.videoPlayer=new window.TCPlayer(l,c),this.videoPlayer.on("error",function(){i.event.fire(i,"TEB_VIDEO_STATUS_CHANGED",{fileId:t,status:it.TEDU_BOARD_VIDEO_STATUS_ERROR,progress:0,duration:0})}),this.videoPlayer.on("loadstart",function(){var t=i.container.getElementsByTagName("video")[0];t&&(t.setAttribute("x5-video-player-type","h5-page"),t.setAttribute("controlsList","nodownload"),t.setAttribute("disablePictureInPicture",""),i.removeTCPlayerControl())}),this.videoPlayer.on("loadedmetadata",function(){i.videoMetaDataLoaded()}),this.videoPlayer.on("play",function(){i.videoPlayed(),d.isMobile()&&(i.videoStatus.isLoaded||setTimeout(function(){window.WeixinJSBridge||d.isMobile()&&"ios"!=o.PLATFORM.toLowerCase()&&"android"!=o.PLATFORM.toLowerCase()||i.videoPlayer.mute(!1),i.videoCreated(n,s)},500))}),this.videoPlayer.on("pause",function(){i.videoPaused()}),this.videoPlayer.on("ended",function(){i.videoEnded()}),this.videoPlayer.on("seeked",function(){i.videoSeeked()}),this.videoPlayer.on("seeking",function(){d.isAndroid()&&d.isTBS()&&i.videoSeeked()}),this.videoPlayer.on("timeupdate",function(){i.videoTimeUpdate()}),this.videoPlayer.on("loadeddata",function(){d.isMobile()||i.videoCreated(n,s)})}},Bt.prototype.setVODExtParam=function(t,e){this.videoStatus.fid==t&&(this.videoStatus.extParam=e,this.createVodVideo(t,this.videoStatus.url,e))},Bt.prototype.resetVideoTag=function(){this.videoTag=this.videoDiv.getElementsByTagName("video")[0],this.videoTag&&(this.videoTag.setAttribute("x5-video-player-type","h5-page"),this.videoTag.setAttribute("controlsList","nodownload nofullscreen"),this.videoTag.setAttribute("disablePictureInPicture","disablePictureInPicture"),this.videoTag.setAttribute("webkit-playsinline","webkit-playsinline"),this.videoTag.setAttribute("playsinline","playsinline"),this.videoTag.setAttribute("style","height:100%; width:100%;"),this.isShowVideoControl&&this.videoTag.setAttribute("controls","controls"),this.videoTag.addEventListener("mousedown",function(t){t.stopPropagation()}),this.videoTag.addEventListener("touchstart",function(t){t.stopPropagation()}))},Bt.prototype.resetVideoStatus=function(){this.videoStatus={fid:"",url:"",type:o.FILE_TYPE.VOD,format:o.VIDEO_FORMAT.MP4,duration:0,isLoaded:!1,isFixed:{play:!0,pause:!0,seek:!0},isWaiting:!1,waitingTime:0,preStatus:-1,preProgress:0,actions:{play:o.VIDEO_ACTION.EXCEPTIOIN,pause:o.VIDEO_ACTION.EXCEPTIOIN,seek:o.VIDEO_ACTION.EXCEPTIOIN,create:o.VIDEO_ACTION.EXCEPTIOIN},actionTimes:{play:0,pause:0,seek:0}}},Bt.prototype.updateVideoStatus=function(t,e,i){var r=this,n=!1;if(t==this.videoStatus.preStatus?1e3*Math.abs(parseInt(this.videoStatus.preProgress)-parseInt(e))>this.syncVideoStatusPrecision&&(n=!0):1e3*Math.abs(parseInt(this.videoStatus.preProgress)-parseInt(e))>0&&(n=!0),n){var s=d.getTimeStamp();this.videoStatus.actionTimes.seek=s,this.videoStatus.actions.seek=o.VIDEO_ACTION.PASSIVE,this.videoPlayer.currentTime(e),setTimeout(function(){r&&r.videoStatus.actionTimes.seek==s&&(_.report("seek_miss_callback",{file_id:r.videoStatus.fid,extra_info:JSON.stringify({url:r.videoStatus.url,progress:e,duration:r.videoStatus.duration})}),r.store.setNeedDraw())},2e3),_.report("video_status_update_seek",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,progress:e,duration:this.videoStatus.duration})})}var a=this.videoDiv.getElementsByTagName("video")[0],l=a&&a.paused,u=!l,c=null,h=d.getTimeStamp();t!=o.VIDEO_STATUS.STOP||l?t==o.VIDEO_STATUS.PLAY&&l?(this.videoStatus.actionTimes.play=h,this.videoStatus.actions.play=o.VIDEO_ACTION.PASSIVE,this.videoPlayer.play(),setTimeout(function(){r&&r.videoStatus.actionTimes.play==h&&(_.report("play_miss_callback",{file_id:r.videoStatus.fid,extra_info:JSON.stringify({url:r.videoStatus.url,progress:e,duration:r.videoStatus.duration})}),r.store.setNeedDraw())},2e3),c="video_status_update_play"):t==o.VIDEO_STATUS.PAUSE&&u&&(this.videoStatus.actionTimes.pause=h,this.videoStatus.actions.pause=o.VIDEO_ACTION.PASSIVE,this.videoPlayer.pause(),setTimeout(function(){r&&r.videoStatus.actionTimes.pause==h&&(_.report("pause_miss_callback",{file_id:r.videoStatus.fid,extra_info:JSON.stringify({url:r.videoStatus.url,progress:e,duration:r.videoStatus.duration})}),r.store.setNeedDraw())},2e3),c="video_status_update_pause"):(this.videoStatus.actionTimes.pause=h,this.videoStatus.actions.pause=o.VIDEO_ACTION.PASSIVE,this.videoPlayer.pause(),setTimeout(function(){r&&r.videoStatus.actionTimes.pause==h&&(_.report("stop_miss_callback",{file_id:r.videoStatus.fid,extra_info:JSON.stringify({url:r.videoStatus.url,progress:e,duration:r.videoStatus.duration})}),r.store.setNeedDraw())},2e3),c="video_status_update_stop"),null!=c&&_.report(c,{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,progress:e,duration:this.videoStatus.duration})})},Bt.prototype.showVideoControl=function(t){this.isShowVideoControl=t;var e=this.videoDiv.getElementsByTagName("video")[0];e&&(e.controls=t)},Bt.prototype.removeTCPlayerControl=function(){var t=this.videoDiv.getElementsByClassName("vcp-controls-panel")[0];t&&t.remove();var e=this.videoDiv.getElementsByClassName("vcp-bigplay")[0];e&&e.remove();var i=this.videoDiv.getElementsByClassName("vcp-loading")[0];i&&i.remove();var r=this.videoDiv.getElementsByClassName("vcp-volume")[0];r&&r.remove();var o=this.videoDiv.getElementsByClassName("vjs-control-bar")[0];o&&o.remove();var n=this.videoDiv.getElementsByClassName("vjs-big-play-button")[0];n&&n.remove();var s=this.videoDiv.getElementsByClassName("vjs-error-display")[0];s&&s.remove()},Bt.prototype.playVideo=function(){this.videoStatus.actions.play=o.VIDEO_ACTION.API,this.videoPlayer&&this.videoPlayer.play(),_.report("play_video",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})})},Bt.prototype.pauseVideo=function(){this.videoStatus.actions.pause=o.VIDEO_ACTION.API,this.videoPlayer&&this.videoPlayer.pause(),_.report("pause_video",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})})},Bt.prototype.seekVideo=function(t){this.videoStatus.actions.seek=o.VIDEO_ACTION.API,this.videoPlayer&&this.videoPlayer.currentTime(t),_.report("seek_video",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})})},Bt.prototype.muteVideo=function(t){this.videoTag&&(this.videoTag.muted=t),_.report("mute_video",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})})},Bt.prototype.setSyncVideoStatusEnable=function(t){this.isSyncVideoStatus=t},Bt.prototype.startSyncVideoStatus=function(t){var e=this;this.videoStatus.isLoaded&&(this.syncVideoStatusTimer&&(clearInterval(this.syncVideoStatusTimer),this.syncVideoStatusTimer=null),this.syncVideoStatusTimer=setInterval(function(){e.store.updateVideo(e.videoStatus.fid,e.videoStatus.preStatus,e.videoPlayer.currentTime())},1e3*t),_.report("start_video_sync_timer",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,interval:t})}))},Bt.prototype.stopSyncVideoStatus=function(){this.syncVideoStatusTimer&&clearInterval(this.syncVideoStatusTimer),_.report("stop_video_sync_timer",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})})},Bt.prototype.renderVideo=function(t){var e=this,i=t.fid,r=t.type,n=t.downloadURL,s=r==o.FILE_TYPE.VODFILE&&null!=n,a=(r==o.FILE_TYPE.VOD||r==o.FILE_TYPE.LIVE)&&null!=n;if(s||a){var l=t.status||0,u=t.progress||0;if(this.videoStatus.isLoaded&&l==o.VIDEO_STATUS.PLAY){var c=u,h=d.getTimeStamp();u=Math.floor((h-t.timestamp)/1e3+u),Math.floor(c)!=Math.floor(u)&&_.report("video_fix_progress",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,before:c,beforeTime:t.timestamp,after:u,currentTime:h})})}if(this.videoStatus.fid!=i){if(this.resetVideoStatus(),this.stopSyncVideoStatus(),a)this.videoStatus.fid=i,this.videoStatus.url=n,this.videoStatus.format=this.getVideoFormat(n),this.videoStatus.type=this.getVideoType(n),this.videoStatus.actions.create=o.VIDEO_ACTION.PASSIVE,this.createVideo(i,n);else if(s){this.videoStatus.fid=i,this.videoStatus.url=n,this.videoStatus.type=o.FILE_TYPE.VODFILE,this.videoStatus.actions.create=o.VIDEO_ACTION.PASSIVE;var p=this.splitVodVideoOption(n);"true"==p.hasExt?this.event.fire(this,"TEB_VODEXTPARAM",{fileId:i,appId:p.appId,vodId:p.vodId}):this.createVodVideo(i,n)}}else this.videoDiv.style.display="block";if(!this.videoStatus.isLoaded)return;if(this.videoStatus.preStatus==l&&parseInt(this.videoStatus.preProgress)==parseInt(u))return;if(0==this.videoStatus.duration&&(_.report("video_get_duration",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url})}),this.videoStatus.duration=this.videoPlayer.duration()||0,0==this.videoStatus.duration))return void setTimeout(function(){e.store.setNeedDraw()},500);l==o.VIDEO_STATUS.PLAY&&parseInt(u)>=parseInt(this.videoStatus.duration)&&(u=parseInt(this.videoStatus.duration),l=o.VIDEO_STATUS.PAUSE,_.report("video_fix_progress",{file_id:this.videoStatus.fid,extra_info:JSON.stringify({url:this.videoStatus.url,progress:u})})),this.updateVideoStatus(l,u,r)}else this.videoPlayer&&(this.videoDiv.style.display="none",this.videoStatus.actions.pause=o.VIDEO_ACTION.PASSIVE,this.videoPlayer.pause())},Bt.prototype.renderH5PPT=function(t){var e=t.type||o.FILE_TYPE.IMG,i=t.downloadURL,r=t.currentPageIndex,n=t.currentPageStep,s=t.fid;if(this.getCurrentFile()!=o.COMMON_GROUP){var a=this.iframeDOM.getAttribute("src")||"";if(e==o.FILE_TYPE.H5PPT&&i){if((a&&a.indexOf("?")>-1?a.substring(0,a.indexOf("?")):a)!=(i.indexOf("?")>-1?i.substring(0,i.indexOf("?")):i)){this.iframeDOM.removeAttribute("src");var l=t.downloadURL;l.indexOf("?")>-1?l+="&page=".concat(r,"&step=").concat(n,"&fid=").concat(encodeURIComponent(s)):l+="?page=".concat(r,"&step=").concat(n,"&fid=").concat(encodeURIComponent(s)),_.report("iframe_start_load",{file_id:s,extra_info:l}),this.iframeDOM.setAttribute("src",l),this.isRenderFace=!0,this.preloadTriggered=!0}}else this.iframeDOM.remove(),this.iframeDOM=Dt.createElement(),this.store.setIframeDom(this.iframeDOM),this.iframeDOM.onload=this.pptIframeOnLoad.bind(this),this.boardBox.appendChild(this.iframeDOM)}else this.iframeDOM.remove(),this.iframeDOM=Dt.createElement(),this.store.setIframeDom(this.iframeDOM),this.iframeDOM.onload=this.pptIframeOnLoad.bind(this),this.boardBox.appendChild(this.iframeDOM)},Bt.prototype.renderBackgroundColor=function(t,e){o.FILE_TYPE.IMG,e&&e.type,t?this.bgDiv.setAttribute("style","z-index:4 !important;position:absolute !important; top:0 !important; left:0 !important;background-color:".concat(t," !important;width:").concat(this.width,"px !important;height:").concat(this.height,"px !important;")):this.bgDiv.setAttribute("style","z-index:4 !important;position:absolute !important; top:0 !important; left:0 !important;")},Bt.prototype.drawData=function(t,e){var i=this,r=this;if((t=t.sort(function(t,e){return t.seq-e.seq})).forEach(function(t){var o,s,a=t.thin/1e4*r.height;if("line"==t.type&&t.show)r.drawLine(e,t);else if("raser"==t.type&&t.status);else if("select"==t.type&&t.show)e.setLineDash&&e.setLineDash([15,5]),e.lineWidth=1,e.strokeStyle=d.dealColor(n.COLOR.RED),e.strokeRect(t.startInfo.x/1e4*r.width,t.startInfo.y/1e4*r.height,(t.location.x-t.startInfo.x)/1e4*r.width,(t.location.y-t.startInfo.y)/1e4*r.height),e.setLineDash&&e.setLineDash([]);else if("graph"==t.type&&t.show){if("line"==t.graph)t.style?function(t,e,i,o,n,s,a,l){if(t.beginPath(),t.moveTo(e,i),t.lineTo(o,n),t.strokeStyle=a,t.lineWidth=s,t.lineCap="round",l.lineType==q.TEDU_BOARD_LINE_TYPE_DOTTED){var d=.01*r.width+s;t.setLineDash&&t.setLineDash([d,d])}if(t.stroke(),t.setLineDash&&t.setLineDash([]),l.startArrowType!=F.TEDU_BOARD_ARROW_TYPE_NONE||l.endArrowType!=F.TEDU_BOARD_ARROW_TYPE_NONE){var u=s+.02*r.width,c=180*Math.atan2(n-i,o-e)/Math.PI,h=(c-25)*Math.PI/180,p=(c+25)*Math.PI/180,f=u*Math.cos(h),g=u*Math.sin(h),m=u*Math.cos(p),y=u*Math.sin(p);l.endArrowType==F.TEDU_BOARD_ARROW_TYPE_NORMAL?(t.beginPath(),t.moveTo(o-f,n-g),t.lineTo(o,n),t.lineTo(o-m,n-y),t.stroke()):l.endArrowType==F.TEDU_BOARD_ARROW_TYPE_SOLID&&(t.beginPath(),t.moveTo(o-f,n-g),t.lineTo(o,n),t.lineTo(o-m,n-y),t.closePath(),t.fillStyle=a,t.fill(),t.stroke()),l.startArrowType==F.TEDU_BOARD_ARROW_TYPE_NORMAL?(t.beginPath(),t.moveTo(e+f,i+g),t.lineTo(e,i),t.lineTo(e+m,i+y),t.stroke()):l.startArrowType==F.TEDU_BOARD_ARROW_TYPE_SOLID&&(t.beginPath(),t.moveTo(e+f,i+g),t.lineTo(e,i),t.lineTo(e+m,i+y),t.closePath(),t.fillStyle=a,t.fill(),t.stroke())}}(e,t.startPoint.x/1e4*r.width,t.startPoint.y/1e4*r.height,t.endPoint.x/1e4*r.width,t.endPoint.y/1e4*r.height,Math.max(a,r.minLineWidth),t.color,t.style):(e.beginPath(),e.moveTo(t.startPoint.x/1e4*r.width,t.startPoint.y/1e4*r.height),e.lineTo(t.endPoint.x/1e4*r.width,t.endPoint.y/1e4*r.height),e.strokeStyle=t.color,e.lineWidth=Math.max(a,r.minLineWidth),e.lineCap="round",e.stroke());else if("rect"==t.graph)o=t.startPoint.x>t.endPoint.x?t.endPoint.x:t.startPoint.x,s=t.startPoint.y>t.endPoint.y?t.endPoint.y:t.startPoint.y,e.strokeStyle=t.color,e.lineWidth=Math.max(a,r.minLineWidth),t.solid?(e.fillStyle=t.color,e.fillRect(o/1e4*r.width,s/1e4*r.height,Math.abs(t.startPoint.x-t.endPoint.x)/1e4*r.width,Math.abs(t.startPoint.y-t.endPoint.y)/1e4*r.height)):e.strokeRect(o/1e4*r.width,s/1e4*r.height,Math.abs(t.startPoint.x-t.endPoint.x)/1e4*r.width,Math.abs(t.startPoint.y-t.endPoint.y)/1e4*r.height);else if("circle"==t.graph||"oval"==t.graph){o=(t.startPoint.x+t.endPoint.x)/2/1e4*r.width,s=(t.startPoint.y+t.endPoint.y)/2/1e4*r.height;var l=Math.abs(t.startPoint.x-t.endPoint.x)/2/1e4*r.width,u=Math.abs(t.startPoint.y-t.endPoint.y)/2/1e4*r.height;e.strokeStyle=t.color,e.lineWidth=Math.max(a,r.minLineWidth),function(t,e,i,r,o,n,s){var a=.5522848,l=r*a,d=o*a;t.beginPath(),t.moveTo(e-r,i),t.bezierCurveTo(e-r,i-d,e-l,i-o,e,i-o),t.bezierCurveTo(e+l,i-o,e+r,i-d,e+r,i),t.bezierCurveTo(e+r,i+d,e+l,i+o,e,i+o),t.bezierCurveTo(e-l,i+o,e-r,i+d,e-r,i),t.closePath(),t.stroke(),n&&(t.fillStyle=s,t.fill())}(e,o,s,l,u,t.solid,t.color),e.stroke()}}else"inputtext"==t.type?i.renderTextTool(t):"imageElement"==t.type&&i.renderImageElement(t)}),r.store.getSelectList().length>0){for(var o=[],s=0,a=r.store.getSelectList().length;s<a;s++){var l=r.store.getSelectList()[s];"imageElement"===l.type&&o.push(l)}o.length?(this.cursorLayerWrap.style.zIndex=100,this.teduBoardCursorLayer.showSelectLayer(o)):this.cursorLayerWrap.style.zIndex=0;var u=r.store.getSelectArea();e.strokeStyle=d.dealColor(n.COLOR.RED),e.setLineDash&&e.setLineDash([15,5]),e.lineWidth=1,e.strokeRect(u.x/1e4*r.width,u.y/1e4*r.height,u.width/1e4*r.width,u.height/1e4*r.height),e.setLineDash&&e.setLineDash([])}else this.cursorLayerWrap.style.zIndex=0;this.removeImageElement(),this.removeTextTool()},Bt.prototype.renderImageElement=function(t){t.show?(this.imageElementMapData[""+t.belongSeq]=t,t.setBoardSize(this.width,this.height),t.renderTo(this.imageElementWrap)):(t.remove(),delete this.imageElementMapData[""+t.belongSeq])},Bt.prototype.removeImageElement=function(){var t=this.getCurrentBoard();for(var e in this.imageElementMapData){var i=this.imageElementMapData[e];i.boardId!=t&&(i.remove(),delete this.imageElementMapData[""+i.belongSeq])}},Bt.prototype.renderTextTool=function(t){var e=this;if(t.show){var i,r=document.getElementById("tic-textarea__".concat(t.belongSeq)),o=t.textSize/1e4*this.height/12;r?i=this.textAreaComponentMap[t.belongSeq]:((i=new Pt({boardId:this.getCurrentBoard(),board:this})).createElement(this.textAreaBox),i.initEvent({onfocus:function(t,i,r,o){e.textAreaFocusBlurStatus.focus=t,e.textInputStatus=1,e.store.updateDragDataFromTextTool(i,r,o),e.draw()},oninput:function(t,i,r,o){e.textInputStatus=1;var n=t.dom.value;e.store.collectTextInputData().inputting(t,t.textItem,n,t.dom.clientWidth,t.dom.clientHeight),e.store.updateDragDataFromTextTool(i,r,o),e.draw()},onblur:function(t){var i;e.textAreaFocusBlurStatus.focus===t&&(e.textAreaFocusBlurStatus.focus=null),e.textInputStatus=0,e.store.cancelSelect(),t.dom&&(i=t.dom.value),i?e.store.collectTextInputData().draw(t,t.textItem,i,t.dom.clientWidth+12,t.dom.clientHeight):(delete e.textAreaComponentMap[t.textItem.belongSeq],e.store.collectTextInputData().clearTask())},onresize:function(t){t.textItem}})),this.textAreaComponentMap[t.belongSeq]=i,i&&(i.setBoardContainerSize(this.width,this.container.offsetWidth,this.height,this.container.offsetHeight),i.setTextItem(t),i.setPosition(t.location.x/1e4*this.width,t.location.y/1e4*this.height),i.setFontSize(12),i.setMaxSize(),i.setFontScale(o),i.setSize())}else this.textAreaComponentMap[t.belongSeq]&&(this.textAreaComponentMap[t.belongSeq].dom.blur(),this.textAreaComponentMap[t.belongSeq].remove()),delete this.textAreaComponentMap[t.belongSeq]},Bt.prototype.removeTextTool=function(){var t=this.getCurrentBoard();for(var e in this.textAreaComponentMap){var i=this.textAreaComponentMap[e];i&&i.boardId!=t&&(i.remove(),delete this.textAreaComponentMap[""+i.belongSeq])}},Bt.prototype.getBoardData=function(){return JSON.parse(JSON.stringify(this.store.getData()))},Bt.prototype.addHistory=function(t){this.store.addHistory(t)},Bt.prototype.addData=function(t){var e=this;if("[object String]"===Object.prototype.toString.call(t))try{t=JSON.parse(t)}catch(e){this.event.fire(this,"TEB_WARNING",R,e.message+", "+t)}if(this.enableSyncTime){var i=t.value.operator;this.checkUserTime(i),this.userTime[i].imTimeOffset=d.getTimeStamp()-t.timestamp;var r=this.userTime[i].avTimeOffset-this.userTime[i].imTimeOffset;r>0?setTimeout(function(){e.store.addData(t)},r):this.store.addData(t)}else this.store.addData(t)},Bt.prototype.deleteBoard=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.store.getCurrentBoard();this.inputBlur(),d.boardId2Fid(t)==o.COMMON_GROUP&&this.store.deleteBoard(t)},Bt.prototype.getBoardList=function(){return JSON.parse(JSON.stringify(this.store.getBoardList()))},Bt.prototype.getBoardPicList=function(){return JSON.parse(JSON.stringify(this.store.getBoardPicList()))},Bt.prototype.getCurrentBoard=function(){return this.store.currentBoard},Bt.prototype.getCurrentFile=function(){return this.store.getCurrentFile()},Bt.prototype.addBoard=function(){return this.inputBlur(),this.store.getCurrentFile()!=o.COMMON_GROUP&&this.store.switchFile(o.COMMON_GROUP),this.store.switchBoard()},Bt.prototype.switchBoard=function(t,e){var i=this;if(this.inputBlur(),-1===this.getBoardList().indexOf(t)&&(t=o.COMMON_DEFAULT_BOARD),t){var r=d.boardId2Fid(t);if(this.getFileInfo(r).type===o.FILE_TYPE.H5PPT){var n=this.getBoardByGroup(r).indexOf(t);D.gotoTimestampNew(this.iframeDOM,{slideIndex:n,resetStep:e,isPassive:!1})}else this.store.switchBoard(t)}else clearTimeout(this.bgH5LoadTask),this.backgroundIFrameManager.remove(this.boardBox),this.bgH5LoadTask=setTimeout(function(){i.store.switchBoard(t)},50)},Bt.prototype.switchPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.store.switchPage(t)},Bt.prototype.prevBoard=function(t){this.inputBlur();var e=this.getFileInfo(this.getCurrentFile()),i=this.getBoardByGroup(this.getCurrentFile());e.currentPageIndex<1||this.switchBoard(i[e.currentPageIndex-1],t)},Bt.prototype.prevStep=function(){var t=this.store.getFileInfo(this.store.getCurrentFile());t.type==o.FILE_TYPE.H5PPT?(this.inputBlur(),D.gotoPreviousStep(this.iframeDOM,{currentPageIndex:t.currentPageIndex,currentPageStep:t.currentPageStep})):this.prevBoard()},Bt.prototype.nextBoard=function(t){this.inputBlur();var e=this.getFileInfo(this.getCurrentFile()),i=this.getBoardByGroup(this.getCurrentFile());e.currentPageIndex<e.pageCount-1&&this.switchBoard(i[e.currentPageIndex+1],t)},Bt.prototype.nextStep=function(){this.store.getFileInfo(this.store.getCurrentFile()).type==o.FILE_TYPE.H5PPT?(this.inputBlur(),D.gotoNextStep(this.iframeDOM,{})):this.nextBoard()},Bt.prototype.setGlobalBackgroundColor=function(t){this.store.setGlobalBackgroundColor(t)},Bt.prototype.setBackgroundColor=function(t){this.store.setBackgroundColor(t)},Bt.prototype.init=function(){var t,e,i,r=this,n=this;_.report("init",{extra_info:JSON.stringify({option:this.option})}),this.reportContainerSize(),this.visibilityChangeName="visibilitychange",void 0!==document.hidden?this.visibilityChangeName="visibilitychange":void 0!==document.mozHidden?this.visibilityChangeName="mozvisibilitychange":void 0!==document.msHidden?this.visibilityChangeName="msvisibilitychange":void 0!==document.webkitHidden&&(this.visibilityChangeName="webkitvisibilitychange"),this.visibilityChangeBind=this.visibilityChange.bind(this),document.addEventListener(this.visibilityChangeName,this.visibilityChangeBind),this.windowResizeListenerBind=this.windowResizeListener.bind(this),window.addEventListener("resize",this.windowResizeListenerBind),this.windowMessageListenerBind=this.windowMessageListener.bind(this),window.addEventListener("message",this.windowMessageListenerBind,!1),Bt.prototype.renderCanvas=function(){var e=this,i=new _t;this.container.innerHTML='<div class="tx_board_canvas_wrap">'.concat(i.getTemplate(),"</div>"),this.boardWrap=this.container.getElementsByClassName("tx_board_canvas_wrap")[0],this.boardBox=this.container.getElementsByClassName("tx_board_canvas_box")[0],this.keyboardinput=this.container.getElementsByTagName("textarea")[0],this.el=this.container.getElementsByTagName("canvas")[0],this.laserCanvas=this.container.getElementsByTagName("canvas")[1],this.progress=this.container.getElementsByClassName("tic_board_bg_progress")[0],this.img=this.container.getElementsByClassName("tic_board_img_bg")[0],this.bgDiv=this.container.getElementsByClassName("tic_board_bg")[0],this.iframeDOM=this.container.getElementsByClassName("tic_iframe_H5")[0],this.videoDiv=document.getElementById("tic_video_wrap"),this.imageElementWrap=this.container.getElementsByClassName("tic_board__imagewrap")[0],this.cursorLayerWrap=this.container.getElementsByClassName("tic_cursorlayer__wrap")[0],this.teduBoardCursorLayer=new wt(this.cursorLayerWrap,{onmousemove:d.debounce(function(t){e.store.updateImageElements(t)},100),ontouchstart:function(){null===e.touchID&&(e.touchID=0)},ontouchend:function(){e.touchID=null},ontouchcancel:function(){e.touchID=null}}),this.store.setIframeDom(this.iframeDOM),this.iframeDOM.onload=this.pptIframeOnLoad.bind(this),this.textAreaBox=this.container.getElementsByClassName("tic_board_textbox")[0],this.el.getContext("2d").translate(.5,.5),this.laserCanvas&&this.laserCanvas.getContext("2d").translate(.5,.5),this.draw(),document.body.addEventListener("mouseup",this.mouseupUpdateCursor=function(t){g=!0,s=!1,2===e.laserLineStatus&&(e.laserLineStatus=0),e.updateCursor()},!1),window.addEventListener("mouseup",this.mouseupUpdateCursor,!1),this.boardWrap.addEventListener("click",function(t){if(y(t),e.isDrawEnable()){var i=e.getEventLocation(t);-1e6==i.x&&-1e6==i.y||"mouse"!=e.store.getType()||D.sendMouseEvent(e.iframeDOM,{type:t.type,x:i.x,y:i.y,touch:d.extractTouch(t)})}},!1),this.boardWrap.addEventListener("mousedown",function(t){e.isTouchType="mouse";try{v.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"mousedown",error:t.message})})}},!1),this.boardWrap.addEventListener("mousemove",function(t){e.isTouchType="mouse";try{T.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"mousemove",error:t.message})})}},!0),this.boardWrap.addEventListener("mouseup",function(t){e.isTouchType="mouse";try{E.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"mouseup",error:t.message})})}},!1),this.boardWrap.addEventListener("mouseleave",function(t){e.isTouchType="mouse";try{b.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"mouseleave",error:t.message})})}},!1),document.body.addEventListener("keydown",this.keydownBodyEvent=function(t){e.isTouchType="mouse",function(t){if(this.isDrawEnable()&&46==t.keyCode){var e=this.store.getType();"select"!=e&&"pointselect"!=e||this.isMoving||(this.store.deleteSelectedData(),this.event.fire(this,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",this.store.canUndo()),this.event.fire(this,"TEB_OPERATE_CANREDO_STATUS_CHANGED",this.store.canRedo()))}}.apply(e,[t])},!1);var r=new Tt.a(this.boardWrap,{});r.on("touchStart",function(t){e.isTouchType="finger",e.pinchScale=[];try{v.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"touchStart",error:t.message})})}}),r.on("touchMove",function(t){e.isTouchType="finger";try{T.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"touchMove",error:t.message})})}}),r.on("touchEnd",function(t){e.isTouchType="finger";try{E.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"touchEnd",error:t.message})})}}),r.on("touchCancel",function(t){e.isTouchType="finger";try{b.apply(e,[t])}catch(t){_.report("interaction",{extra_info:JSON.stringify({event:"touchCancel",error:t.message})})}}),r.on("pinch",function(i){e.isTouchType="finger","zoom"===(t=e.store.getType())&&e.pinchScale.push(i.zoom)})},this.renderCanvas(),this.layout(),clearTimeout(this.pregressTask),n.pregressTask=setTimeout(function(){n.store.isProgressEnable()&&(n.progress.style.display="block")},o.PROGRESS_SHOW_DELAY),n.event.on("TEB_HISTROYDATA_SYNCCOMPLETED",function(){clearTimeout(n.pregressTask),n.progress.style.display="none"}),n.event.on("draw_laser",function(t){r.drawLaser(t)}),this.event.on("TEB_DRAW_FACE",function(){try{r.drawFace()}catch(i){var t=i.stack,e="render face pageï¼"+i.message;r.store.machineNotify("markdown",'ç½æ¿æ¸²æéè¯¯\n                \n>versionï¼<font color="#ff0000">'.concat(o.VERSION,'</font>\n                \n>sdkAppIdï¼<font color="#ff0000">').concat(r.option.sdkAppId,'</font>\n                \n>ä¿¡æ¯ï¼<font color="#ff0000">').concat(e,'</font>\n                \n>å æ ï¼<font color="#ff0000">').concat(t,"</font>")),_.report("drawerror",{boardid:r.store.getCurrentBoard(),extra_info:JSON.stringify({stack:t,message:e})})}}),this.drawInterval=setInterval(function(){if(r.store.getNeedDraw()){try{r.draw()}catch(i){var t=i.stack,e=i.message;r.store.machineNotify("markdown",'ç½æ¿æ¸²æéè¯¯\n                \n>versionï¼<font color="#ff0000">'.concat(o.VERSION,'</font>\n                \n>sdkAppIdï¼<font color="#ff0000">').concat(r.option.sdkAppId,'</font>\n                \n>ä¿¡æ¯ï¼<font color="#ff0000">').concat(e,'</font>\n                \n>å æ ï¼<font color="#ff0000">').concat(t,"</font>")),_.report("drawerror",{boardid:r.store.getCurrentBoard(),extra_info:JSON.stringify({stack:t,message:e})})}r.store.setNeedDraw(!1)}},50),this.event.on("TEB_GOTOBOARD",function(t,e){r.img.getAttribute("src")&&r._displayImage()});var s=!1,a=-10,l=-10,u=-10,c=-10,h=-10,p=-10,f=!1,g=!0,m=this.el.getContext("2d");function y(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function v(r){t=this.store.getType(),e=this.store.getColor(),i=this.store.getThin();var n=this;if(y(r),this.isDrawEnable()){var _=this.getEventLocation(r);if(f=!0,s=!0,g=!1,-1e6!=_.x||-1e6!=_.y){var v=this.getFileInfo(this.getCurrentFile());if(v){if("mouse"==t){if(v.type===o.FILE_TYPE.H5PPT)return void D.sendMouseEvent(this.iframeDOM,{type:r.type,x:_.x,y:_.y,touch:d.extractTouch(r)});if(v.fid===o.COMMON_GROUP)return void this.nextBoard();if(v.type===o.FILE_TYPE.IMG)return void this.nextBoard()}if(this.store.resetOperation(),h=-10,p=-10,u=a=_.x,c=l=_.y,this.dragStartX=_.clientX,this.dragStartY=_.clientY,"line"==t){if(this.preLineTimestamp=d.getTimeStamp(),this.preLinePoint={x:a,y:l},this.preSpeed=0,this.preWidth=i,this.pointCount=0,this.ignorePointCount=0,this.hasOptimizeStart=!1,this.hasOptimizeEnd=!0,0!=this.laserLineStatus&&1!=this.laserLineStatus||(this.store.collectRaserData().end(a,l),this.laserLineStatus=2),this.updateCursor(),this.store.cancelSelect(),this.drawPen(a,l),!this.enableHandwriting){var T=Math.max(i/1e4*this.height,this.minLineWidth);m.beginPath(),m.arc(a/1e4*this.width,l/1e4*this.height,T/2,0,2*Math.PI,!0),m.fillStyle=e,m.fill(),m.closePath()}this.store.collectLineData().start(a,l,this.enableHandwriting)}else if("eraser"==t)this.store.cancelSelect(),this.store.collectEraserData(a,l);else if("raser"==t);else if("select"==t)this.store.collectMoverData().beforeStart(a,l)?this.isMoving=!0:(this.store.cancelSelect(),this.store.collectSelectData().start(a,l));else if("pointselect"==t)this.store.collectMoverData().beforeStart(a,l)&&(this.isMoving=!0);else if("inputtext"==t){if(f=!1,s=!1,g=!0,1===this.textInputStatus){var S=this.textAreaFocusBlurStatus.focus;return void(S&&S.dom&&S.dom.blur())}var E,b=_.ox,O=_.oy,x=_.x,I=_.y,A=b,R=O,w=this.store.collectTextInputData().start(x,I),C=this.store.getTextSize()/1e4*n.height/12;w.text?document.getElementById("tic-textarea__".concat(w.belongSeq))&&(E=this.textAreaComponentMap[w.belongSeq]):(E=new Pt({boardId:this.getCurrentBoard(),board:this})).createElement(this.textAreaBox),E.initEvent({onfocus:function(t,e,i,r){n.textAreaFocusBlurStatus.focus=t,n.textInputStatus=1,n.store.updateDragDataFromTextTool(e,i,r),n.draw()},oninput:function(t,e,i,r){n.textInputStatus=1;var o=t.dom.value;n.store.collectTextInputData().inputting(t,t.textItem,o,t.dom.clientWidth+12,t.dom.clientHeight),n.store.updateDragDataFromTextTool(e,i,r),n.draw()},onblur:function(t){var e;n.textAreaFocusBlurStatus.focus===t&&(n.textAreaFocusBlurStatus.focus=null),n.textInputStatus=0,n.store.cancelSelect(),t.dom&&(e=t.dom.value),e?n.store.collectTextInputData().draw(t,t.textItem,e,t.dom.clientWidth+12,t.dom.clientHeight):(delete n.textAreaComponentMap[t.textItem.belongSeq],n.store.collectTextInputData().clearTask())},onresize:function(t){t.textItem}}),n.textAreaComponentMap[w.belongSeq]=E,E&&(E.setBoardContainerSize(this.width,this.container.offsetWidth,this.height,this.container.offsetHeight),E.setTextItem(w),E.setPosition(A,R),E.setFontSize(12),E.setMaxSize(),E.setFontScale(C),E.setSize(),E.focus())}else t.indexOf("graph")>-1?(this.store.cancelSelect(),this.store.collectGraphData().start(a,l)):"zoom"===t&&(d.isMobile()?this.beforePinchScale=this.getBoardScale():(this.store.cancelSelect(),this.store.collectDragData().start(r)));1==this.isMoving&&this.store.collectMoverData().beforeStart(a,l)&&(this.isMoving=!0,this.store.collectMoverData().start(a,l))}}}}function T(r){if(11!==this.getToolType()&&(y(r),this.isDrawEnable())){t=this.store.getType(),e=this.store.getColor(),i=this.store.getThin();var o=this.getEventLocation(r);if(-1e6!=o.x||-1e6!=o.y)if("mouse"!=t){var n=o.x,_=o.y,v=o.clientX,T=o.clientY;if(s){if("line"==t)if(this.enableHandwriting)S.apply(this,[n,_]);else{var E=d.getTimeStamp();if(this.pointCount++,this.enableLineOptimization){var b=Math.sqrt(Math.pow(this.preLinePoint.x-n,2)+Math.pow(this.preLinePoint.y-_,2));if(E-this.preLineTimestamp<20||b<5)return void this.ignorePointCount++}if(this.preLineTimestamp=E,this.preLinePoint={x:n,y:_},h>=0&&p>=0){var O=(h+n)/2,x=(p+_)/2;m.beginPath(),m.moveTo(u/1e4*this.width,c/1e4*this.height),m.quadraticCurveTo(h/1e4*this.width,p/1e4*this.height,O/1e4*this.width,x/1e4*this.height),m.strokeStyle=e,m.lineWidth=Math.max(i/1e4*this.height,this.minLineWidth),m.lineCap="round",m.stroke(),u=O,c=x}h=n,p=_,this.store.collectLineData().draw(n,_,i),this.drawPen(n,_)}else"eraser"==t?this.store.collectEraserData(n,_):"raser"==t||("select"!=t||this.isMoving?"pointselect"==t||(t.indexOf("graph")>-1?this.store.collectGraphData().draw(n,_):"zoom"===t&&(d.isMobile()&&this.pinchScale.length?this.store.collectDragData().scaleDraw(this.beforePinchScale,this.pinchScale):(this.store.collectDragData().draw(r,v,T,this.dragStartX,this.dragStartY),this.dragStartX=v,this.dragStartY=T,this.draw()))):this.store.collectSelectData().draw(n,_));this.isMoving&&(this.store.collectMoverData().draw(n,_,u,c),u=n,c=_)}else if("line"==t&&(0==this.laserLineStatus?(this.store.collectRaserData().start(n,_,this.getToolType()),this.laserLineStatus=1):1==this.laserLineStatus&&this.store.collectRaserData().draw(n,_,this.getToolType()),this.updateCursor()),!g&&"line"==t){f=!0,s=!0,this.store.resetOperation(),h=-10,p=-10,u=a=o.x,c=l=o.y,this.store.cancelSelect(),this.store.collectLineData().start(a,l,i);var I=Math.max(i/1e4*this.height,this.minLineWidth);m.beginPath(),m.arc(a/1e4*this.width,l/1e4*this.height,I/2,0,2*Math.PI,!0),m.fillStyle=e,m.fill(),m.closePath()}"raser"!=t||this.store.collectRaserData().draw(n,_,this.getToolType())}else D.sendMouseEvent(this.iframeDOM,{type:r.type,x:o.x,y:o.y,touch:d.extractTouch(r)})}}function S(t,r){var o=d.getTimeStamp();this.pointCount++;var n=Math.sqrt(Math.pow(this.preLinePoint.x-t,2)+Math.pow(this.preLinePoint.y-r,2)),s=o-this.preLineTimestamp;if((s<20||n<5)&&this.hasOptimizeEnd)this.ignorePointCount++;else{var a=.1*n,l=n/s,f=i;if(0!=this.preSpeed&&(f=Math.min(this.preSpeed/l*i,i),Math.abs(this.preWidth-f)>a&&(f=this.preWidth<f?this.preWidth+a:this.preWidth-a)),f=Math.floor(f),this.hasOptimizeEnd||(t=t<u?Math.floor(t+Math.max(t-u,-50)*f/i*2):Math.floor(t+Math.min(t-u,50)*f/i*2),r=r<c?Math.floor(r+Math.max(r-c,-50)*f/i*2):Math.floor(r+Math.min(r-c,50)*f/i*2),(isNaN(t)||isNaN(r))&&(t=Math.floor(u),r=Math.floor(c))),h>=0&&p>=0){for(var g=(h+t)/2,y=(p+r)/2,_=u,v=c,T=.05;T<1.05;T+=.05){var S=Math.pow(1-T,2)*u+2*T*(1-T)*h+Math.pow(T,2)*g,E=Math.pow(1-T,2)*c+2*T*(1-T)*p+Math.pow(T,2)*y,b=this.preWidth+(f-this.preWidth)*T;this.hasOptimizeStart||(b=Math.min(f/3+f*T,f)),this.hasOptimizeEnd||(b=this.preWidth-this.preWidth*T),m.beginPath(),m.moveTo(_/1e4*this.width,v/1e4*this.height),m.lineTo(S/1e4*this.width,E/1e4*this.height),m.strokeStyle=e,m.lineWidth=Math.max(b/1e4*this.height,this.minLineWidth),m.lineCap="round",m.stroke(),_=S,v=E}u=g,c=y,this.hasOptimizeStart||(this.hasOptimizeStart=!0)}h=t,p=r,this.preLineTimestamp=o,this.preLinePoint={x:t,y:r},this.preSpeed=l,this.preWidth=f,this.hasOptimizeEnd?(this.store.collectLineData().draw(t,r,f),this.drawPen(t,r)):(this.hasOptimizeEnd=!0,this.store.collectLineData().end(t,r,f,this.enableHandwriting))}}function E(r){if(y(r),this.isDrawEnable()){t=this.store.getType();var o=this.getEventLocation(r);if(-1e6!=o.x||-1e6!=o.y)if(g=!0,s=!1,"mouse"!=t){var n=o.x,h=o.y;if("line"==t){if(!f)return;this.enableHandwriting?(this.hasOptimizeEnd=!1,S.apply(this,[n,h])):(m.beginPath(),m.moveTo(u/1e4*this.width,c/1e4*this.height),m.lineTo(n/1e4*this.width,h/1e4*this.height),m.strokeStyle=e,m.lineWidth=Math.max(i/1e4*this.height,this.minLineWidth),m.lineCap="round",m.stroke(),this.store.collectLineData().end(n,h,i,this.enableHandwriting)),2===this.laserLineStatus&&(this.laserLineStatus=0,"finger"===this.isTouchType?this.store.collectRaserData().end(n,h):this.store.collectRaserData().start(n,h,this.getToolType()))}else if("eraser"==t)this.store.collectEraserData(n,h);else if("raser"==t)"finger"===this.isTouchType&&this.store.collectRaserData().end(n,h);else if("select"!=t||this.isMoving)"pointselect"!=t||this.isMoving?t.indexOf("graph")>-1?this.store.collectGraphData().end(n,h):"zoom"===t&&(d.isMobile()?this.store.collectDragData().touchEnd(this.pinchScale):this.store.collectDragData().end()):this.store.collectPointSelectData(n,h);else{if(!f)return;this.store.collectSelectData().end(a,l,n,h)}this.isMoving&&(this.isMoving=!1,this.store.collectMoverData().end()),this.event.fire(this,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",this.store.canUndo()),this.event.fire(this,"TEB_OPERATE_CANREDO_STATUS_CHANGED",this.store.canRedo())}else D.sendMouseEvent(this.iframeDOM,{type:r.type,x:o.x,y:o.y,touch:d.extractTouch(r)})}}function b(t){if(y(t),this.isDrawEnable()){var i=this.store.getType(),r=this.getEventLocation(t);if(-1e6!=r.x||-1e6!=r.y)if("mouse"!=i){var o,n=r.x,h=r.y;f=!1,1==s?("line"==i?(o=this.store.getThin(),n=d.getEffectivePoint(n,o),h=d.getEffectivePoint(h,o),this.enableHandwriting?(this.hasOptimizeEnd=!1,S.apply(this,[n,h])):(m.beginPath(),m.moveTo(u/1e4*this.width,c/1e4*this.height),m.lineTo(n/1e4*this.width,h/1e4*this.height),m.strokeStyle=e,m.lineWidth=Math.max(o/1e4*this.height,this.minLineWidth),m.lineCap="round",m.stroke(),this.store.collectLineData().over(n,h,o),this.drawPen(2e4,2e4))):"raser"==i||("select"!=i||this.isMoving?i.indexOf("graph")>-1?(o=this.store.getThin(),n=d.getEffectivePoint(n,o),h=d.getEffectivePoint(h,o),this.store.collectGraphData().over(n,h)):"zoom"===i&&(d.isMobile()||this.store.collectDragData().over()):this.store.collectSelectData().end(a,l,n,h)),this.isMoving&&(this.isMoving=!1,this.store.collectMoverData().end()),s=!1,this.event.fire(this,"TEB_OPERATE_CANUNDO_STATUS_CHANGED",this.store.canUndo()),this.event.fire(this,"TEB_OPERATE_CANREDO_STATUS_CHANGED",this.store.canRedo())):"line"==i&&(1===this.laserLineStatus?(this.store.collectRaserData().end(n,h),this.laserLineStatus=0):2===this.laserLineStatus&&(this.laserLineStatus=0),this.updateCursor()),"raser"==i&&this.store.collectRaserData().over()}else D.sendMouseEvent(this.iframeDOM,{type:t.type,x:r.x,y:r.y,touch:d.extractTouch(t)})}}},Bt.prototype.getDrawWidth=function(t,e,i,r,o,n){var s=Math.sqrt(Math.pow(t-i,2)+Math.pow(e-r,2))/o;return n*((2-(s=s>2?2:s))/2)},Bt.prototype.reportContainerSize=function(){this.container&&_.report("resize",{extra_info:JSON.stringify({width:this.container.clientWidth,height:this.container.clientHeight})})},Bt.prototype.windowResizeListener=function(){var t=this,e=null;clearTimeout(e),e=setTimeout(function(){t.resize()},200),this.reportContainerSize()},Bt.prototype.windowMessageListener=function(t){var e;if(t.data&&t.data.module&&"tx_h5_postmessage"===t.data.module)switch(t.data.cmd){case"init":var i=JSON.parse(t.data.data),r=i.title,o=i.count,n=i.url,s=i.width,a=i.height,l=i.slideStepData,u=d.extractTaskId(n);r=this.taskIdTitleMap[u]||r;var c=d.parseQueryString(decodeURIComponent(n)).fid;(e=this.store.getFileInfo(c))&&e.fid?D.setFid(this.iframeDOM,e.fid):(this.isRenderFace||(n&&n.indexOf("?")>-1&&(n=n.substring(0,n.indexOf("?"))),this.store.addH5PPTFile(c,n,r,o,s,a,!0,this.addFileNeedSwitchMap[c])),D.setFid(this.iframeDOM,c),e=this.store.getFileInfo(c)),e&&(e.slideStepData=l),_.report("iframe_cmd_init",{boardid:this.getCurrentBoard(),file_id:c,extra_info:JSON.stringify({title:r,count:o,url:n,width:s,height:a})}),this.event.fire(this,"TEB_GOTOSTEP",e.currentPageStep,e.slideStepData[e.currentPageIndex]);break;case"slideStepChangeEvent":this.store.switchH5Board(t.data.data),e=this.getFileInfo(t.data.data.fid),this.event.fire(this,"TEB_GOTOSTEP",t.data.data.stepIndex,e.slideStepData[t.data.data.slideIndex+""]);break;case"assets_loading_error":_.report("assets_loading_error",{boardid:this.getCurrentBoard(),extra_info:JSON.stringify(t.data.data)});break;case"ppt_action":_.report("ppt_action",{boardid:this.getCurrentBoard(),extra_info:JSON.stringify(t.data.data)}),this.store.pptAction(t.data.data)}},Bt.prototype.setColor=function(t){this.store.setColor(t)},Bt.prototype.setThin=function(t){this.store.setThin(t)},Bt.prototype.setTextSize=function(t){var e=this.textAreaFocusBlurStatus.focus;if(this.store.setTextSize(t),this.textAreaFocusBlurStatus.focus){e.textItem.textSize=this.getTextSize();var i=this.getTextSize()/1e4*this.height/12;e.setFontScale(i),e.smartPaintText(),this.store.collectTextInputData().draw(e,e.textItem,e.textItem.text,e.dom.clientWidth+12,e.dom.clientHeight)}},Bt.prototype.getTextSize=function(){return this.store.getTextSize()},Bt.prototype.setTextColor=function(t){var e=this.textAreaFocusBlurStatus.focus;this.store.setTextColor(t),this.textAreaFocusBlurStatus.focus&&(e.textItem.color=this.getTextColor(),e.setTextStyle(),this.store.collectTextInputData().draw(e,e.textItem,e.textItem.text,e.dom.clientWidth+12,e.dom.clientHeight))},Bt.prototype.getTextColor=function(){return this.store.getTextColor()},Bt.prototype.setType=function(t){this.inputBlur();var e=["MOUSE","LINE","ERASER","RASER","GRAPH-LINE","GRAPH-OVAL","GRAPH-RECT","GRAPH-OVAL-SOLID","GRAPH-RECT-SOLID","POINTSELECT","SELECT","INPUTTEXT","ZOOM","GRAPH-STRAIGHTLINE","GRAPH-ELLIPSE"];this.store.setType(n.BOARD_ACTION_TYPE[e[t]]),"inputtext"===n.BOARD_ACTION_TYPE[e[t]]?this.textAreaBox.style.zIndex=100:this.textAreaBox.style.zIndex=9,this.updateCursor()},Bt.prototype.undo=function(){this.inputBlur(),this.store.undo()},Bt.prototype.canUndo=function(){return this.store.canUndo()},Bt.prototype.redo=function(){this.inputBlur(),this.store.redo()},Bt.prototype.canRedo=function(){return this.store.canRedo()},Bt.prototype.clear=function(t,e){this.inputBlur(),this.store.clear(t,e)},Bt.prototype.clearAll=function(){this.inputBlur(),this.store.clearAll(),this.videoDiv.style.display="none",this.resetVideoStatus()},Bt.prototype.addBackgroundPic=function(t,e,i){this.store.addBackgroundPic(t,e,i)},Bt.prototype.setBackgroundPic=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.FILL_MODE.DEFAULT;this.store.setBackgroundPic(t,e,i)},Bt.prototype.setBackgroundH5=function(t){this.store.setBackgroundH5(t)},Bt.prototype.updateCurrentFillMode=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.FILL_MODE.DEFAULT;this.store.updateCurrentFillMode(t)},Bt.prototype.deleteBackgroundPic=function(t){this.store.deleteBackgroundPic(t)},Bt.prototype.cancelBackgroundPic=function(){this.store.cancelBackgroundPic()},Bt.prototype.clearGlobalBgColor=function(){this.store.clearGlobalBgColor()},Bt.prototype.cancelSelect=function(){this.store.cancelSelect()},Bt.prototype.setDrawEnable=function(t){this.store.setDrawEnable(t)},Bt.prototype.setHandwritingEnable=function(t){this.enableHandwriting=t},Bt.prototype.isHandwritingEnable=function(){return this.enableHandwriting},Bt.prototype.addFile=function(t,e,i,r,n,s){return this.inputBlur(),this.store.addFile(t,e,i,r,n,!0,o.FILE_TYPE.IMG,s)},Bt.prototype.addImagesFile=function(t,e,i){var r=this;this.inputBlur();var n="#".concat(d.getTimeStamp());e=e||"imagesfile_".concat(n);var s=JSON.stringify(t),a=(new Date).getTime(),l=d.compress(s),u=(new Date).getTime(),c=100*l.length/s.length,h=u-a;if(l&&l.length>o.IMAGESFILE_MAX_URL_LENGTH)return setTimeout(function(){r.event.fire(r,"TEB_ERROR",N.TEDU_BOARD_ERROR_DATA_TOO_LARGE,"please try to split into two or more files, or try to use shorter url."),_.report("images_file_url_too_large",{extra_info:JSON.stringify({urls:s,urls_len:s.length,compress_len:l.length,compress_ratio:c,elapse:h})})},0),"";var p=l;if(this.store.isFileUrlExist(p)){var f=this.store.getFileInfoByUrl(p);return n=f.fid,setTimeout(function(){r.event.fire(r,"TEB_WARNING",L,n),_.report("images_file_already_exists",{boardid:r.getCurrentBoard(),file_id:n,extra_info:""})},0),n}var g=this.store.addFile(n,t,e,p,null,!1,o.FILE_TYPE.IMAGESFILE,i);return _.report("add_images_file_start",{file_id:g,extra_info:JSON.stringify({urls:s,urls_len:s.length,compress_len:l.length,compress_ratio:c,elapse:h})}),g},Bt.prototype.addH5PPTFile=function(t,e,i){var r=this;this.inputBlur();var n="#".concat(d.getTimeStamp());if(this.addFileNeedSwitchMap[n]=i,this.store.isFileUrlExist(t)){t&&t.indexOf("?")>-1&&(t=t.substring(0,t.indexOf("?")));var s=this.store.getFileInfoByUrl(t);return n=s.fid,setTimeout(function(){r.event.fire(r,"TEB_WARNING",w,n),_.report("h5ppt_already_exists",{boardid:r.getCurrentBoard(),file_id:n,extra_info:t})},0),""}var a,l=d.extractTaskId(t);return this.taskIdTitleMap[l]=e,t.indexOf("?")>-1?t+="&page=0&step=0&fid="+encodeURIComponent(n):t+="?page=0&step=0&fid="+encodeURIComponent(n),document.getElementsByClassName("tx_board_pre_iframe").length?a=document.getElementsByClassName("tx_board_pre_iframe")[0]:((a=document.createElement("iframe")).setAttribute("class","tx_board_pre_iframe"),a.setAttribute("style","position:fixed;visibility:hidden;width:0px;height:0px;border:none;"),document.body.appendChild(a)),this.isRenderFace=!1,_.report("iframe_pre_start_load",{file_id:n,extra_info:t}),a.onload=function(){this.src==o.ABOUTBLANK||this.src&&(D.init(a,{isFirstLoad:!0}),_.report("iframe_pre_load_done",{file_id:n,extra_info:this.src}),a.setAttribute("src",o.ABOUTBLANK))},a.setAttribute("src",t),n},Bt.prototype.addVideoFile=function(t){var e=this;this.inputBlur();var i="#".concat(d.getTimeStamp());if(this.store.isFileUrlExist(t)){var r=this.store.getFileInfoByUrl(t);return i=r.fid,setTimeout(function(){e.event.fire(e,"TEB_WARNING",B,i),_.report("video_already_exists",{file_id:i,extra_info:t})},0),""}return this.resetVideoStatus(),this.stopSyncVideoStatus(),this.videoStatus.fid=i,this.videoStatus.url=t,this.videoStatus.format=this.getVideoFormat(t),this.videoStatus.type=this.getVideoType(t),this.videoStatus.actions.create=o.VIDEO_ACTION.API,this.createVideo(i,t),i},Bt.prototype.addVODFile=function(t,e,i){var r=this;this.inputBlur();var n="#".concat(d.getTimeStamp()),s="".concat(t,"_").concat(e,"_").concat(null!=i?"true":"false");if(this.store.isFileUrlExist(s)){var a=this.store.getFileInfoByUrl(s);return n=a.fid,setTimeout(function(){r.event.fire(r,"TEB_WARNING",B,n),_.report("video_already_exists",{file_id:n,extra_info:s})},0),""}return this.resetVideoStatus(),this.stopSyncVideoStatus(),this.videoStatus.fid=n,this.videoStatus.url=s,this.videoStatus.type=o.FILE_TYPE.VODFILE,this.videoStatus.extParam=i,this.videoStatus.actions.create=o.VIDEO_ACTION.API,this.createVodVideo(n,s,i),n},Bt.prototype.addH5File=function(t){var e=this;this.inputBlur();var i="#".concat(d.getTimeStamp());if(this.store.isFileUrlExist(t)){var r=this.store.getFileInfoByUrl(t);return i=r.fid,setTimeout(function(){e.event.fire(e,"TEB_WARNING",P,i),_.report("h5file_already_exists",{file_id:i,extra_info:t})},0),""}var o=this.boardWrap.clientWidth,n=this.boardWrap.clientHeight;return this.store.addH5File(i,t,o,n),i},Bt.prototype.deleteFile=function(t){return this.inputBlur(),this.store.deleteFile(t)},Bt.prototype.switchFile=function(t,e,i){var r=this;t&&t!=this.store.getCurrentFile()&&(clearTimeout(this.pptH5LoadTask),this.iframeDOM.remove(),this.iframeDOM=Dt.createElement(),this.store.setIframeDom(this.iframeDOM),this.iframeDOM.onload=this.pptIframeOnLoad.bind(this),this.boardBox.appendChild(this.iframeDOM),this.backgroundIFrameManager.remove(this.boardBox),this.pptH5LoadTask=setTimeout(function(){r.store.switchFile(t,e,i)},50),this.videoPlayer&&this.videoPlayer.pause())},Bt.prototype.getGroup=function(){return this.store.getGroup()},Bt.prototype.getFileInfo=function(t){return this.store.getFileInfo(t)},Bt.prototype.getBoardByGroup=function(t){return this.store.getBoardByGroup(t)},Bt.prototype.clearFileDraws=function(t){return this.inputBlur(),this.store.clearFileDraws(t)},Bt.prototype.layout=function(t){var e=this.container.clientWidth,i=this.container.clientHeight;if(0==e||0==i)return!1;var r,n=100,s=50,a=50;n=this.store.getBoardScale();var l=this.store.getDragData();l&&(s=l.xOffset,a=l.yOffset,n=l.scale),r=t&&t.ratio||this.store.getBoardRatio();var u,c,h,p,f,g,m=d.calcRatioWidthHeight(r,o.RATIO),y=m.ratioWidth,_=m.ratioHeight,v=e/y,T=i/_,S=Math.min(v,T);u=S*y,c=S*_,this.width=Math.floor(u*n/100),this.height=Math.floor(c*n/100),this.store.setContainerSize(e,i),this.store.setBoardSize(this.width,this.height),this.width/this.height>e/i?(this.height>i?(f=50+(this.height-i)/2/this.height*100,g=50-(this.height-i)/2/this.height*100):(f=50,g=50),h=50+(this.width-e)/2/this.width*100,p=50-(this.width-e)/2/this.width*100):(f=50+(this.height-i)/2/this.height*100,g=50-(this.height-i)/2/this.height*100,this.width>e?(h=50+(this.width-e)/2/this.width*100,p=50-(this.width-e)/2/this.width*100):(h=50,p=50)),s=Math.min(h,Math.max(p,s)),a=Math.min(f,Math.max(g,a)),l&&this.store.dragDataList.updateDragData(this.getCurrentBoard(),{xOffset:s,yOffset:a});var E,b,O=this.el.getContext("2d"),x=this.laserCanvas&&this.laserCanvas.getContext("2d"),D=window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||1;this.el&&(e/i>this.width/this.height?e>this.width?(E=this.width,b=this.width*_/y):e<this.width?(E=e,b=e*_/y):(E=this.width,b=this.height):i>this.height?(E=this.height*y/_,b=this.height):i<this.height?(E=i*y/_,b=i):(E=this.width,b=this.height),this.el.setAttribute("width",E*D),this.el.setAttribute("height",b*D));var I=this.width*(s-50)/100,A=this.height*(a-50)/100;if(this.laserCanvas){this.laserCanvas.setAttribute("width",E),this.laserCanvas.setAttribute("height",b);var R="z-index:15 !important;position:absolute !important;left:0 !important;top:0 !important;margin-left:".concat((this.width-E)/2,"px !important;margin-top:").concat((this.height-b)/2,"px !important;line-height:1 !important;width:").concat(E,"px !important;height:").concat(b,"px !important;");this.laserCanvas&&this.laserCanvas.setAttribute("style",R),x.translate((E-u)/2-(n/100-1)*u/2+I,(b-c)/2-(n/100-1)*c/2+A)}var w="position:relative !important;left: 50% !important;top: 50% !important;-webkit-transform: translateX(-50%) translateY(-50%) !important;transform: translateX(-50%) translateY(-50%) !important;overflow:hidden !important;width:".concat(this.width,"px !important;height:").concat(this.height,"px !important"),C="position:absolute !important;left: ".concat(s,"% !important;top:").concat(a,"% !important;-webkit-transform: translateX(-50%) translateY(-50%) !important;transform: translateX(-50%) translateY(-50%) !important;width:").concat(this.width,"px !important;height:").concat(this.height,"px !important;"),P="z-index:10 !important;position:absolute !important;left:0 !important;top:0 !important;margin-left:".concat((this.width-E)/2,"px !important;margin-top:").concat((this.height-b)/2,"px !important;line-height:1 !important;width:").concat(E,"px !important;height:").concat(b,"px !important;");this.boardWrap&&this.boardWrap.setAttribute("style",w),this.boardBox&&this.boardBox.setAttribute("style",C),this.el&&this.el.setAttribute("style",P),this.imageElementWrap&&this.imageElementWrap.setAttribute("style",C+"z-index:7;"),this.cursorLayerWrap&&this.cursorLayerWrap.setAttribute("style",C+"z-index:0;"),11===this.getToolType()?this.textAreaBox&&this.textAreaBox.setAttribute("style",C+"z-index:100;"):this.textAreaBox&&this.textAreaBox.setAttribute("style",C+"z-index:9;");var B="z-index:6 !important; display:".concat(this.progress.style.display,"; position:absolute !important;left: 50% !important;top: 50% !important;-webkit-transform: translateX(-50%) translateY(-50%) !important;transform: translateX(-50%) translateY(-50%) !important;overflow:hidden !important;width:70px !important;height:70px !important;");return this.progress&&this.progress.setAttribute("style",B),this.img&&this.img.setAttribute("width",this.width),this.img&&this.img.setAttribute("height",this.height),this.bgDiv&&this.bgDiv.setAttribute("width",this.width),this.bgDiv&&this.bgDiv.setAttribute("height",this.height),this.iframeDOM&&this.iframeDOM.setAttribute("style","position: absolute !important;top: 0 !important;left: 0 !important;width:".concat(this.width,"px !important;height:").concat(this.height,"px !important;border:none !important;z-index:8 !important;")),this.videoStatus.isLoaded&&this.videoDiv.setAttribute("style","z-index:20; position:absolute; top:0; left:0; height:".concat(b,"px; width:").concat(E,"px; display:block")),this.h5Iframe&&this.h5Iframe.layout(E,b),this.updateCursor(),O.translate(((E-u)/2-(n/100-1)*u/2+I)*D,((b-c)/2-(n/100-1)*c/2+A)*D),O.scale(D,D),!0},Bt.prototype.drawLaser=function(t){if(!(t.seq<this.execRenderLaserSeq)){this.execRenderLaserSeq=t.seq;var e=this.laserCanvas&&this.laserCanvas.getContext("2d");if(e.clearRect(0,0,this.width,this.height),t.status){var i=t.toolType;1==i?e.drawImage(this.penIcon,t.location.x/1e4*this.width-o.ICONS[1].offsetX,t.location.y/1e4*this.height-o.ICONS[1].offsetY):3==i&&e.drawImage(this.laserIcon,t.location.x/1e4*this.width-o.ICONS[3].offsetX,t.location.y/1e4*this.height-o.ICONS[3].offsetY)}}},Bt.prototype.drawPen=function(t,e){var i=this.laserCanvas.getContext("2d");i.clearRect(0,0,this.width,this.height),i.drawImage(this.penIcon,t/1e4*this.width-o.ICONS[1].offsetX,e/1e4*this.height-o.ICONS[1].offsetY)},Bt.prototype.drawLine=function(t,e){var i=this;if(e.writing){if(e.lines.length<2)return;for(var r=!0,o=!0,n=e.lines[0].x,s=e.lines[0].y,a=e.lines[0].w,l=e.thin,d=e.color,u=e.lines[1].x,c=e.lines[1].y,h=2;h<e.lines.length;h++){var p=e.lines[h].w,f=e.lines[h].x,g=e.lines[h].y;if(2==h&&(o=!1),h==e.lines.length-1&&(r=!1),r||(f=f<n?Math.floor(f+Math.max(f-n,-50)*p/l*2):Math.floor(f+Math.min(f-n,50)*p/l*2),g=g<s?Math.floor(g+Math.max(g-s,-50)*p/l*2):Math.floor(g+Math.min(g-s,50)*p/l*2),(isNaN(f)||isNaN(g))&&(f=n,g=s)),u>=0&&c>=0){for(var m=(u+f)/2,y=(c+g)/2,_=n,v=s,T=.05;T<1.05;T+=.05){var S=Math.pow(1-T,2)*n+2*T*(1-T)*u+Math.pow(T,2)*m,E=Math.pow(1-T,2)*s+2*T*(1-T)*c+Math.pow(T,2)*y,b=a+(p-a)*T;o||(b=Math.min(p/3+p*T,p)),r||(b=a-a*T),t.beginPath(),t.moveTo(_/1e4*this.width,v/1e4*this.height),t.lineTo(S/1e4*this.width,E/1e4*this.height),t.strokeStyle=d,t.lineWidth=Math.max(b/1e4*this.height,this.minLineWidth),t.lineCap="round",t.stroke(),_=S,v=E}n=m,s=y}u=f,c=g,a=p,o||(o=!0),r||(r=!0)}}else{var O=Math.max(e.thin/1e4*this.height,this.minLineWidth);t.lineWidth=O,t.lineCap="round",t.strokeStyle=e.color,t.fillStyle=e.color;var x=this.store.getSmoothLevel();if(x>0&&e.endSeq&&!e.fitCurve.length){var D=[];e.lines.forEach(function(t){D.push([t.x,t.y])}),e.fitCurve=K(D,1e4*x,null)}if(t.beginPath(),e.lines.length<2)return t.arc(e.lines[0].x/1e4*this.width,e.lines[0].y/1e4*this.height,t.lineWidth/2,0,2*Math.PI,!0),t.fill(),void t.closePath();if(2==e.lines.length&&e.lines[0].x==e.lines[1].x&&e.lines[0].y==e.lines[1].y)return t.arc(e.lines[0].x/1e4*this.width,e.lines[0].y/1e4*this.height,t.lineWidth/2,0,2*Math.PI,!0),t.fill(),void t.closePath();if(t.moveTo(e.lines[0].x/1e4*this.width,e.lines[0].y/1e4*this.height),0===e.fitCurve.length){for(var I=1;I<e.lines.length-2;I++){var A=e.lines[I],R=e.lines[I+1],w=(A.x+R.x)/2/1e4*this.width,C=(A.y+R.y)/2/1e4*this.height;t.quadraticCurveTo(A.x/1e4*this.width,A.y/1e4*this.height,w,C)}var P=e.lines[e.lines.length-1];t.lineTo(P.x/1e4*this.width,P.y/1e4*this.height)}else e.fitCurve.forEach(function(e){var r=e[1][0]/1e4*i.width,o=e[1][1]/1e4*i.height,n=e[2][0]/1e4*i.width,s=e[2][1]/1e4*i.height,a=e[3][0]/1e4*i.width,l=e[3][1]/1e4*i.height;t.bezierCurveTo(r,o,n,s,a,l)});t.stroke()}},Bt.prototype.isDrawEnable=function(){return this.store.isDrawEnable()},Bt.prototype.getGlobalBackgroundColor=function(){return this.store.getGlobalBackgroundColor()},Bt.prototype.getBackgroundColor=function(){return this.store.getBackgroundColor()},Bt.prototype.getToolType=function(){var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e){return t===e};return Object.keys(n.BOARD_ACTION_TYPE).find(function(i){return e(n.BOARD_ACTION_TYPE[i],t)})}(this.store.getType());return["MOUSE","LINE","ERASER","RASER","GRAPH-LINE","GRAPH-OVAL","GRAPH-RECT","GRAPH-OVAL-SOLID","GRAPH-RECT-SOLID","POINTSELECT","SELECT","INPUTTEXT","ZOOM"].indexOf(t)},Bt.prototype.getBrushColor=function(){return this.store.getColor()},Bt.prototype.getBrushThin=function(){return this.store.getThin()},Bt.prototype.setDataSyncEnable=function(t){this.store.setDataSyncEnable(t)},Bt.prototype.isDataSyncEnable=function(){return this.store.isDataSyncEnable()},Bt.prototype.setAccessibleUsers=function(t){this.store.setAccessibleUsers(t)},Bt.prototype.setTextFontFamily=function(t){this.store.setTextFontFamily(t)},Bt.prototype.getTextFontFamily=function(){return this.store.getTextFontFamily()},Bt.prototype.setTextFontStyle=function(t){this.store.setTextFontStyle(t)},Bt.prototype.getTextFontStyle=function(){return this.store.getTextFontStyle()},Bt.prototype.setBoardRatio=function(t){this.inputBlur(),this.store.setBoardRatio(this.store.getCurrentBoard(),t),this.draw()},Bt.prototype.getBoardRatio=function(){return this.store.getBoardRatio()||this.option.ratio},Bt.prototype.setBoardScale=function(t){this.inputBlur(),this.store.setBoardScale(t),this.draw()},Bt.prototype.getBoardScale=function(){return this.store.getBoardScale()},Bt.prototype.setBoardContentFitMode=function(t){this.store.setBoardContentFitMode(t)},Bt.prototype.getBoardContentFitMode=function(){return this.store.getBoardContentFitMode()},Bt.prototype.setLineStyle=function(t){this.store.setLineStyle(t)},Bt.prototype.getLineStyle=function(){return this.store.getLineStyle()},Bt.prototype.setOvalDrawMode=function(t){this.store.setOvalDrawMode(t)},Bt.prototype.getOvalDrawMode=function(){return this.store.getOvalDrawMode()},Bt.prototype.syncRemoteTime=function(t,e){this.checkUserTime(t),this.userTime[t].avTimeOffset=d.getTimeStamp()-e},Bt.prototype.checkUserTime=function(t){this.userTime[t]||(this.userTime[t]={avTimeOffset:0,imTimeOffset:0})},Bt.prototype.getSyncTime=function(){return d.getTimeStamp()},Bt.prototype.updateCursor=function(){if(this.boardBox){var t=this.getToolType(),e=this.store.getCursorIcons()[t];if(e){var i="";e.hasOwnProperty("cursor")&&(i+=e.cursor),i&&(this.boardBox.style.cursor=i,this.laserCanvas.style.cursor=i,this.boardBox.style.webkitTransform="translateX(-50%) translateY(-50%) !important")}else this.laserCanvas.style.cursor="auto",this.boardBox.style.cursor="auto"}},Bt.prototype.pptIframeOnLoad=function(){var t=this.iframeDOM.src;if(t==o.ABOUTBLANK);else if(t){var e=d.parseQueryString(decodeURIComponent(t)).fid;_.report("iframe_load_done",{boardid:this.getCurrentBoard(),file_id:e,extra_info:t}),D.init(this.iframeDOM,{isFirstLoad:!0})}this.store.preloadBoard()},Bt.prototype.inputBlur=function(){if(1===this.textInputStatus){var t=this.textAreaFocusBlurStatus.focus;t&&t.dom&&t.dom.blur()}},Bt.prototype.getThumbnailImages=function(t){var e=this.getFileInfo(t),i=[];if(e){if(e.fid===o.COMMON_GROUP)return i;var r=e.downloadURL;if(!r)return i;if(e.type==o.FILE_TYPE.H5FILE||e.type==o.FILE_TYPE.VOD||e.type==o.FILE_TYPE.LIVE)return i;if(e.type===o.FILE_TYPE.H5PPT)for(var n=d.extractTaskId(r),s=0;s<e.pageCount;s++)i.push("https://thumbnail-tiw.qcloudtrtc.com/".concat(n,"/").concat(s+1,".jpg"));else if(r.endsWith("/"))for(var a=0;a<e.pageCount;a++)i.push("".concat(r).concat(a+1,".jpg"));else if(d.isCosUrl(r))for(var l=d.fileDownLoadUrlToPreviewUrl(r),u=0;u<e.pageCount;u++)i.push("".concat(l).concat(u+1));return i}return[]},Bt.prototype.createTranscode=function(t){return this.store.createTranscode(t)},Bt.prototype.describeTranscode=function(t){return this.store.describeTranscode(t)},Bt.prototype.setCursorIcon=function(t,e){this.store.setCursorIcon(t,e),this.updateCursorIcons()},Bt.prototype.addImageElement=function(t,e){this.store.addImageElement(t,e)},Bt.prototype.addAckData=function(t){this.store.addSendAckData(t)},Bt.prototype.syncAndRefresh=function(){this.store.syncAndRefresh()},Bt.prototype.destroy=function(){_.report("destroy"),this.store.destroy(),this.store=null,this.drawInterval&&clearInterval(this.drawInterval),window.removeEventListener("message",this.windowMessageListenerBind,!1),window.removeEventListener("resize",this.windowResizeListenerBind,!1),document.body.removeEventListener("mouseup",this.mouseupUpdateCursor,!1),window.removeEventListener("mouseup",this.mouseupUpdateCursor,!1),document.body.removeEventListener("keydown",this.keydownBodyEvent,!1),this.container&&(this.container.innerHTML=""),document.removeEventListener(this.visibilityChangeName,this.visibilityChangeBind)};var Lt=Bt;function Nt(){}Nt.prototype.on=function(t,e){return this._cbs=this._cbs||{},(this._cbs[t]||(this._cbs[t]=[])).unshift(e),this},Nt.prototype.off=function(t,e){if(this._cbs=this._cbs||{},!t)return this._cbs={};if(!e)return delete this._cbs[t];for(var i,r=this._cbs[t]||[];r&&~(i=r.indexOf(e));)r.splice(i,1);return this},Nt.prototype.fire=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=arguments.length>1?arguments[1]:void 0;this._cbs=this._cbs||{};var i=this._cbs[e];if(i){for(var r=i.length,o=arguments.length,n=new Array(o>2?o-2:0),s=2;s<o;s++)n[s-2]=arguments[s];for(;r--;)i[r].apply(t,[].concat(n))}return this};var Mt=Nt,qt=(i(128),i(132),{TEDU_BOARD_UPLOAD_SUCC:1,TEDU_BOARD_UPLOAD_ERROR:2});function Ft(t,e){this.cos=null,this.options=t,this.options.cosData=t.cosData||{},this.options.cosData.appid=t.cosData.appid,this.options.cosData.bucket=t.cosData.bucket,this.options.cosData.region=t.cosData.region||"ap-shanghai",this.options.cosData.path=t.cosData.path||"/TIC/",this.request=new S(t),this.init(this.options),this.userDataKeyMap={},this.fidKeyMap={},this.event=t.event,this.board=e}Ft.prototype.init=function(t){var e=this,i=window.COS;i&&(this.cos=new i({getAuthorization:function(t,i){e.request.getCosAuthData().then(function(t){try{if(t&&t.data&&0==t.data.error_code){var e=t.data;i({TmpSecretId:e.tmp_secret_id,TmpSecretKey:e.tmp_secret_key,XCosSecurityToken:e.session_token,ExpiredTime:e.expired_time})}else i({TmpSecretId:"error",TmpSecretKey:"error",XCosSecurityToken:"error",ExpiredTime:-1})}catch(t){i({TmpSecretId:"error",TmpSecretKey:"error",XCosSecurityToken:"error",ExpiredTime:-1})}}).catch(function(t){i({TmpSecretId:"error",TmpSecretKey:"error",XCosSecurityToken:"error",ExpiredTime:-1})})}}))},Ft.prototype.uploadImgFile=function(t,e,i){var r=this,o=d.getTimeStamp();this.uploadCosImageFile(t,e).then(function(t){var e=t.Key.substr(t.Key.lastIndexOf("/")+1),n="https://".concat(t.Bucket,".file.myqcloud.com/").concat(t.Key),s=t.userData;i&&i(e,n,s),_.report("cos_upload_file",{time_consume:d.getTimeStamp()-o,extra_info:JSON.stringify({bucket:r.options.cosData.bucket,cos_appid:r.options.cosData.appid,region:r.options.cosData.region,data:t})})}).catch(function(e){var i;i="[object File]"===Object.prototype.toString.call(t)?"":t.userData,_.report("cos_upload_file",{action_result:1,action_info:JSON.stringify(e),time_consume:d.getTimeStamp()-o,extra_info:JSON.stringify({bucket:r.options.cosData.bucket,cos_appid:r.options.cosData.appid,region:r.options.cosData.region,userData:i})})})},Ft.prototype.transcodeUploadFile=function(t,e){var i=this,r=d.getTimeStamp();return this.uploadCosFileFromTranscode(t,e).then(function(t){return _.report("cos_upload_file",{time_consume:d.getTimeStamp()-r,extra_info:JSON.stringify({bucket:i.options.cosData.bucket,cos_appid:i.options.cosData.appid,region:i.options.cosData.region,data:t})}),Promise.resolve(t)}).catch(function(e){var o;return o="[object File]"===Object.prototype.toString.call(t)?"":t.userData,_.report("cos_upload_file",{action_result:1,action_info:JSON.stringify(e),time_consume:d.getTimeStamp()-r,extra_info:JSON.stringify({bucket:i.options.cosData.bucket,cos_appid:i.options.cosData.appid,region:i.options.cosData.region,userData:o})}),Promise.reject(e)})},Ft.prototype.uploadCosImageFile=function(t,e){var i=null,r="",o="";if("[object File]"===Object.prototype.toString.call(t.data))i=t.data,r=t.data.name,o=t.userData;else{var n=t.data;r=t.name,o=t.userData;for(var s=n.split(","),a=window.atob(s[1]),l=s[0].match(/:(.*?);/)[1],u=new Uint8Array(a.length),c=0;c<a.length;c++)u[c]=a.charCodeAt(c);i=new Blob([u],{type:l})}var h=this;return new Promise(function(t,n){!function(t,i,r,o,n){var s=this,a=h.options.cosData.path+d.getTimeStamp()+"/"+o;h.userDataKeyMap[a]=n,h.fidKeyMap[a]=e,h.options.cosData.appid=h.board.store.cosData.cosAppId,h.options.cosData.bucket=h.board.store.cosData.cosBucket,h.cos.sliceUploadFile({Bucket:h.options.cosData.bucket+"-"+h.options.cosData.appid,Region:h.options.cosData.region,Key:a,Body:r,TaskReady:function(t){},onHashProgress:function(t){},onProgress:function(t){h.event.fire(h,"TEB_FILEUPLOADPROGRESS",Object.assign({userData:n},t))}},function(e,r){r&&200===r.statusCode?(Object.assign(r,{userData:n}),h.event.fire(s,"TEB_FILEUPLOADSTATUS",qt.TEDU_BOARD_UPLOAD_SUCC,{code:0,errorMsg:"",userData:n}),t(r)):(h.event.fire(s,"TEB_FILEUPLOADSTATUS",qt.TEDU_BOARD_UPLOAD_ERROR,{code:e.statusCode?e.statusCode:-3,errorMsg:JSON.stringify(e.error),userData:n}),i(e))})}(t,n,i,r,o)})},Ft.prototype.uploadCosFileFromTranscode=function(t,e){var i=null,r="",o="";if("[object File]"===Object.prototype.toString.call(t.data))i=t.data,r=t.data.name,o=t.userData;else{var n=t.data;r=t.name,o=t.userData;for(var s=n.split(","),a=window.atob(s[1]),l=s[0].match(/:(.*?);/)[1],u=new Uint8Array(a.length),c=0;c<a.length;c++)u[c]=a.charCodeAt(c);i=new Blob([u],{type:l})}var h=this;return new Promise(function(t,n){!function(t,i,r,o,n){var s=h.options.cosData.path+d.getTimeStamp()+"/"+o;h.userDataKeyMap[s]=n,h.options.cosData.appid=h.board.store.cosData.cosAppId,h.options.cosData.bucket=h.board.store.cosData.cosBucket,h.cos.sliceUploadFile({Bucket:h.options.cosData.bucket+"-"+h.options.cosData.appid,Region:h.options.cosData.region,Key:s,Body:r,onTaskReady:function(t){},onHashProgress:function(t,e,i){},onProgress:function(t){e(Object.assign({userData:n},t))}},function(e,r){r&&200===r.statusCode?(Object.assign(r,{userData:n}),t(r)):i(e)})}(t,n,i,r,o)})};var kt=Ft;function Ut(t){var e=this;o.setNativeVersion(t.nativeVersion),o.setPlatform(t.platform||o.PLATFORM),t.tlsData={sdkAppId:t.sdkAppId,identifier:t.userId+"",userSig:t.userSig},this.event=new Mt,t.event=this.event,this.board=new Lt(t),this.fileCos=new kt(t,this.board),this.version=o.VERSION,this.historySyncDone=!1,this.transcodeIntervalMap={},this.taskIdUserDataMap={},this.event.on(Ut.EVENT.TEB_HISTROYDATA_SYNCCOMPLETED,function(){e.historySyncDone=!0})}i(136),Ut.EVENT={TEB_INIT:"TEB_INIT",TEB_OPERATE_CANUNDO_STATUS_CHANGED:"TEB_OPERATE_CANUNDO_STATUS_CHANGED",TEB_OPERATE_CANREDO_STATUS_CHANGED:"TEB_OPERATE_CANREDO_STATUS_CHANGED",TEB_ADDBOARD:"TEB_ADDBOARD",TEB_SYNCDATA:"TEB_SYNCDATA",TEB_ERROR:"TEB_ERROR",TEB_WARNING:"TEB_WARNING",TEB_HISTROYDATA_SYNCCOMPLETED:"TEB_HISTROYDATA_SYNCCOMPLETED",TEB_IMAGE_STATUS_CHANGED:"TEB_IMAGE_STATUS_CHANGED",TEB_H5BACKGROUND_STATUS_CHANGED:"TEB_H5BACKGROUND_STATUS_CHANGED",TEB_H5FILE_STATUS_CHANGED:"TEB_H5FILE_STATUS_CHANGED",TEB_VIDEO_STATUS_CHANGED:"TEB_VIDEO_STATUS_CHANGED",TEB_DELETEBOARD:"TEB_DELETEBOARD",TEB_GOTOBOARD:"TEB_GOTOBOARD",TEB_ADDH5PPTFILE:"TEB_ADDH5PPTFILE",TEB_ADDFILE:"TEB_ADDFILE",TEB_DELETEFILE:"TEB_DELETEFILE",TEB_FILEUPLOADSTATUS:"TEB_FILEUPLOADSTATUS",TEB_SWITCHFILE:"TEB_SWITCHFILE",TEB_SETBACKGROUNDIMAGE:"TEB_SETBACKGROUNDIMAGE",TEB_FILEUPLOADPROGRESS:"TEB_FILEUPLOADPROGRESS",TEB_ADDTRANSCODEFILE:"TEB_ADDTRANSCODEFILE",TEB_GOTOSTEP:"TEB_GOTOSTEP",TEB_TRANSCODEPROGRESS:"TEB_TRANSCODEPROGRESS",TEB_VODEXTPARAM:"TEB_VODEXTPARAM",TEB_ADDIMAGEELEMENT:"TEB_ADDIMAGEELEMENT",TEB_ADDIMAGESFILE:"TEB_ADDIMAGESFILE"},Ut.TOOL_TYPE={TEDU_BOARD_TOOL_TYPE_MOUSE:0,TEDU_BOARD_TOOL_TYPE_PEN:1,TEDU_BOARD_TOOL_TYPE_ERASER:2,TEDU_BOARD_TOOL_TYPE_LASER:3,TEDU_BOARD_TOOL_TYPE_LINE:4,TEDU_BOARD_TOOL_TYPE_OVAL:5,TEDU_BOARD_TOOL_TYPE_RECT:6,TEDU_BOARD_TOOL_TYPE_OVAL_SOLID:7,TEDU_BOARD_TOOL_TYPE_RECT_SOLID:8,TEDU_BOARD_TOOL_TYPE_POINT_SELECT:9,TEDU_BOARD_TOOL_TYPE_RECT_SELECT:10,TEDU_BOARD_TOOL_TYPE_TEXT:11,TEDU_BOARD_TOOL_TYPE_ZOOM_DRAG:12,TEDU_BOARD_TOOL_TYPE_STRAIGHT_LINE:13,TEDU_BOARD_TOOL_TYPE_ELLIPSE:14},Ut.CONTENT_FIT_MODE=M,Ut.ARROW_TYPE=F,Ut.LINE_TYPE=q,Ut.OVAL_DRAW_MODE=et,Ut.VIDEO_STATUS=it,Ut.H5FILE_STATUS=mt,Ut.prototype.destroy=function(){this.off(),this.event=null,this.board&&this.board.destroy(),this.board=null,this.fileCos=null,this.historySyncDone=!1,this.transcodeIntervalMap={},this.taskIdUserDataMap={}},Ut.prototype.on=function(t,e){this.event.on(t,e)},Ut.prototype.off=function(t,e){this.event&&this.event.off(t,e)},Ut.prototype.addSyncData=function(t){this.board.addData(t)},Ut.getVersion=function(){return o.VERSION},Ut.prototype.getVersion=function(){return this.version},Ut.prototype.setDataSyncEnable=function(t){this.board.setDataSyncEnable(t)},Ut.prototype.isDataSyncEnable=function(){return this.board.isDataSyncEnable()},Ut.prototype.reset=function(){this.historySyncDone?this.board.clearAll():this.event.fire(this,"TEB_WARNING",C,"reset invalid while load history")},Ut.prototype.getSyncTime=function(){return this.board.getSyncTime()},Ut.prototype.syncRemoteTime=function(t,e){this.board.syncRemoteTime(t,e)},Ut.prototype.generateFid=function(){return"#".concat(d.getTimeStamp())},Ut.prototype.setDrawEnable=function(t){this.board.setDrawEnable(t)},Ut.prototype.isDrawEnable=function(){return this.board.isDrawEnable()},Ut.prototype.setAccessibleUsers=function(t){this.board.setAccessibleUsers(t)},Ut.prototype.setGlobalBackgroundColor=function(t){this.board.setGlobalBackgroundColor(t)},Ut.prototype.getGlobalBackgroundColor=function(){return this.board.getGlobalBackgroundColor()},Ut.prototype.setBackgroundColor=function(t){this.board.setBackgroundColor(t)},Ut.prototype.getBackgroundColor=function(){return this.board.getBackgroundColor()},Ut.prototype.setToolType=function(t){this.board.setType(t)},Ut.prototype.getToolType=function(){return this.board.getToolType()},Ut.prototype.setCursorIcon=function(t,e){this.board.setCursorIcon(t,e)},Ut.prototype.setBrushColor=function(t){this.board.setColor(t)},Ut.prototype.getBrushColor=function(){return this.board.getBrushColor()},Ut.prototype.setBrushThin=function(t){this.board.setThin(t)},Ut.prototype.getBrushThin=function(){return this.board.getBrushThin()},Ut.prototype.setTextColor=function(t){this.board.setTextColor(t)},Ut.prototype.getTextColor=function(){return this.board.getTextColor()},Ut.prototype.setTextSize=function(t){this.board.setTextSize(t)},Ut.prototype.getTextSize=function(){return this.board.getTextSize()},Ut.prototype.setTextStyle=function(t){this.board.setTextFontStyle(t)},Ut.prototype.getTextStyle=function(){return this.board.getTextFontStyle()},Ut.prototype.setLineStyle=function(t){this.board.setLineStyle(t)},Ut.prototype.getLineStyle=function(){return this.board.getLineStyle()},Ut.prototype.setOvalDrawMode=function(t){this.board.setOvalDrawMode(t)},Ut.prototype.getOvalDrawMode=function(){return this.board.getOvalDrawMode()},Ut.prototype.clear=function(t,e){this.historySyncDone?this.board.clear(t,e):this.event.fire(this,"TEB_WARNING",C,"clear invalid while load history")},Ut.prototype.setBackgroundImage=function(t,e){var i=this;if(this.historySyncDone){var r=this.board.getCurrentBoard();if("[object String]"===Object.prototype.toString.call(t))this.board.setBackgroundPic(r,t,e),this.event.fire(this,"TEB_SETBACKGROUNDIMAGE","",t,"");else if("[object Object]"===Object.prototype.toString.call(t)){var o=t,n=this.getCurrentFile();this.fileCos.uploadImgFile(o,n,function(t,o,n){i.board.setBackgroundPic(r,o,e),i.event.fire(i,"TEB_SETBACKGROUNDIMAGE",t,o,n)})}}else this.event.fire(this,"TEB_WARNING",C,"setBackgroundImage invalid while load history")},Ut.prototype.setBackgroundH5=function(t){this.historySyncDone?this.board.setBackgroundH5(t):this.event.fire(this,"TEB_WARNING",C,"setBackgroundH5 invalid while load history")},Ut.prototype.undo=function(){this.historySyncDone?this.board.undo():this.event.fire(this,"TEB_WARNING",C,"undo invalid while load history")},Ut.prototype.redo=function(){this.historySyncDone?this.board.redo():this.event.fire(this,"TEB_WARNING",C,"redo invalid while load history")},Ut.prototype.resize=function(){this.board.resize()},Ut.prototype.addBoard=function(t,e){if(this.historySyncDone){var i=this.board.addBoard();return this.board.setBackgroundPic(i,t,e),i}this.event.fire(this,"TEB_WARNING",C,"addBoard invalid while load history")},Ut.prototype.deleteBoard=function(t){this.historySyncDone?this.board.deleteBoard(t):this.event.fire(this,"TEB_WARNING",C,"deleteBoard invalid while load history")},Ut.prototype.prevStep=function(){this.historySyncDone?this.board.prevStep():this.event.fire(this,"TEB_WARNING",C,"prevStep invalid while load history")},Ut.prototype.nextStep=function(){this.historySyncDone?this.board.nextStep():this.event.fire(this,"TEB_WARNING",C,"nextStep invalid while load history")},Ut.prototype.prevBoard=function(t){this.historySyncDone?this.board.prevBoard(t):this.event.fire(this,"TEB_WARNING",C,"prevBoard invalid while load history")},Ut.prototype.nextBoard=function(t){this.historySyncDone?this.board.nextBoard(t):this.event.fire(this,"TEB_WARNING",C,"nextBoard invalid while load history")},Ut.prototype.gotoBoard=function(t,e){this.historySyncDone?t&&this.board.switchBoard(t,e):this.event.fire(this,"TEB_WARNING",C,"gotoBoard invalid while load history")},Ut.prototype.getCurrentBoard=function(){return this.board.getCurrentBoard()},Ut.prototype.getBoardList=function(){return this.board.getBoardList()},Ut.prototype.setBoardRatio=function(t){this.board.setBoardRatio(t)},Ut.prototype.getBoardRatio=function(){return this.board.getBoardRatio()},Ut.prototype.setBoardScale=function(t){this.board.setBoardScale(t)},Ut.prototype.getBoardScale=function(){return this.board.getBoardScale()},Ut.prototype.setBoardContentFitMode=function(t){this.board.setBoardContentFitMode(t)},Ut.prototype.getBoardContentFitMode=function(){return this.board.getBoardContentFitMode()},Ut.prototype.applyFileTranscode=function(t,e){var i=this;if(this.historySyncDone){var r="";if("[object Object]"===Object.prototype.toString.call(t)){var o=t.userData;if(r="[object File]"===Object.prototype.toString.call(t.data)?t.data.name:t.name,/\.(bmp|jpg|jpeg|png|gif|webp|svg|psd|ai)/i.test(r))return void this.event.fire(this,"TEB_TRANSCODEPROGRESS",{code:"FailedOperation.SdkModule",message:"transcode does not support image",userData:o,status:"ERROR"});this.fileCos.transcodeUploadFile(t,function(t){i.event.fire(i,"TEB_TRANSCODEPROGRESS",{code:"",message:"",status:"UPLOADING",progress:100*t.percent,userData:o})}).then(function(t){var r="https://".concat(t.Bucket,".file.myqcloud.com/").concat(t.Key);e="[object Object]"===Object.prototype.toString.call(e)?Object.assign(e,{url:r}):{url:r},i.board.createTranscode(e).then(function(t){if(t.data.Response.Error)i.event.fire(i,"TEB_TRANSCODEPROGRESS",{code:t.data.Response.Error.Code,message:t.data.Response.Error.Message,status:"ERROR",userData:o});else{i.event.fire(i,"TEB_TRANSCODEPROGRESS",Object.assign({},d.CamelCase2camelCase(t.data.Response),{code:"",message:"",userData:o,status:"CREATED"}));var e=t.data.Response.TaskId;i.transcodeIntervalMap[e]=setInterval(function(){i.getFileTranscodeProgress({taskId:e})},5e3),i.taskIdUserDataMap[e]=o}},function(t){i.event.fire(i,"TEB_TRANSCODEPROGRESS",{code:"FailedOperation.SdkModule",message:"transcode failure",userData:o,status:"ERROR"})})}).catch(function(t){i.event.fire(i,"TEB_TRANSCODEPROGRESS",{status:"ERROR",code:"FailedOperation.SdkModule",message:"upload file failure",userData:o})})}else this.event.fire(this,"TEB_TRANSCODEPROGRESS",{code:"FailedOperation.SdkModule",message:"invalid arguments",status:"ERROR",userData:""})}else this.event.fire(this,"TEB_WARNING",C,"applyFileTranscode invalid while load history")},Ut.prototype.getFileTranscodeProgress=function(t){var e=this;this.board.describeTranscode(t).then(function(i){i.data.Response.Error?(e.event.fire(e,"TEB_TRANSCODEPROGRESS",{status:"ERROR",code:i.data.Response.Error.Code,message:i.data.Response.Error.Message,taskId:t.taskId,userData:e.taskIdUserDataMap[t.taskId]}),clearInterval(e.transcodeIntervalMap[t.taskId])):i.data.Response&&(e.event.fire(e,"TEB_TRANSCODEPROGRESS",Object.assign({code:"",message:"",userData:e.taskIdUserDataMap[t.taskId]},d.CamelCase2camelCase(i.data.Response))),"FINISHED"===i.data.Response.Status&&clearInterval(e.transcodeIntervalMap[t.taskId]))},function(i){e.event.fire(e,"TEB_TRANSCODEPROGRESS",{status:"ERROR",code:"FailedOperation.SdkModule",message:"transcode failure",taskId:t.taskId,userData:e.taskIdUserDataMap[t.taskId]}),clearInterval(e.transcodeIntervalMap[t.taskId])}).catch(function(){e.event.fire(e,"TEB_TRANSCODEPROGRESS",{status:"ERROR",code:"FailedOperation.SdkModule",message:"transcode failure",taskId:t.taskId,userData:e.taskIdUserDataMap[t.taskId]}),clearInterval(e.transcodeIntervalMap[t.taskId])})},Ut.prototype.addTranscodeFile=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.historySyncDone){var i="#".concat(d.getTimeStamp());if(t.pages&&0!=t.pages)if(t.url.endsWith("/")){for(var r=[],o=0;o<t.pages;o++)r.push("".concat(t.url).concat(o+1,".jpg"));try{var n=t.resolution.split("x")[0],s=t.resolution.split("x")[1],a=d.maxCommonDivisor(n,s),l="".concat(n/a,":").concat(s/a);return this.board.addFile(i,r,t.title,t.url,l,e)}catch(o){return this.board.addFile(i,r,t.title,t.url,null,e)}}else if(t.url.endsWith(".html"))return this.board.addH5PPTFile(t.url,t.title,e)}else this.event.fire(this,"TEB_WARNING",C,"addTranscodeFile invalid while load history")},Ut.prototype.addImagesFile=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Array.isArray(t)?0==t.length?"":this.historySyncDone?this.board.addImagesFile(t,null,e):(this.event.fire(this,"TEB_WARNING",C,"addImagesFile invalid while load history"),""):""},Ut.prototype.deleteFile=function(t){this.historySyncDone?this.board.deleteFile(t):this.event.fire(this,"TEB_WARNING",C,"deleteFile invalid while load history")},Ut.prototype.switchFile=function(t,e,i){this.historySyncDone?this.board.switchFile(t,e,i):this.event.fire(this,"TEB_WARNING",C,"switchFile invalid while load history")},Ut.prototype.getCurrentFile=function(){return this.board.getCurrentFile()},Ut.prototype.getFileInfo=function(t){return this.board.getFileInfo(t)},Ut.prototype.getFileInfoList=function(){return this.board.getGroup()},Ut.prototype.getFileBoardList=function(t){return this.board.getBoardByGroup(t)},Ut.prototype.getThumbnailImages=function(t){return this.board.getThumbnailImages(t)},Ut.prototype.clearFileDraws=function(t){this.historySyncDone?this.board.clearFileDraws(t):this.event.fire(this,"TEB_WARNING",C,"clearFileDraws invalid while load history")},Ut.hasVideoPermission=function(){return Lt.hasVideoPermission()},Ut.applyVideoPermission=function(){Lt.applyVideoPermission()},Ut.prototype.addVideoFile=function(t){return this.historySyncDone?this.board.addVideoFile(t):(this.event.fire(this,"TEB_WARNING",C,"addVideoFile invalid while load history"),"")},Ut.prototype.addVODFile=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.historySyncDone?this.board.addVODFile(t,e,i):(this.event.fire(this,"TEB_WARNING",C,"addVODFile invalid while load history"),"")},Ut.prototype.setVODExtParam=function(t,e){this.board.setVODExtParam(t,e)},Ut.prototype.showVideoControl=function(t){this.board.showVideoControl(t)},Ut.prototype.playVideo=function(){this.board.playVideo()},Ut.prototype.pauseVideo=function(){this.board.pauseVideo()},Ut.prototype.seekVideo=function(t){this.board.seekVideo(t)},Ut.prototype.muteVideo=function(t){this.board.muteVideo(t)},Ut.prototype.setSyncVideoStatusEnable=function(t){this.board.setSyncVideoStatusEnable(t)},Ut.prototype.startSyncVideoStatus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.SYNC_VIDEO_STATUS_INTERVAL;this.board.startSyncVideoStatus(t)},Ut.prototype.stopSyncVideoStatus=function(){this.board.stopSyncVideoStatus()},Ut.prototype.addH5File=function(t){return this.historySyncDone?this.board.addH5File(t):(this.event.fire(this,"TEB_WARNING",C,"addH5File invalid while load history"),"")},Ut.prototype.addImageElement=function(t){var e=this;if(this.historySyncDone){var i=this.board.getCurrentBoard();if("[object String]"===Object.prototype.toString.call(t))this.board.addImageElement(i,t),this.event.fire(this,"TEB_ADDIMAGEELEMENT","",t,"");else if("[object Object]"===Object.prototype.toString.call(t)){var r=t,o=this.getCurrentFile();this.fileCos.uploadImgFile(r,o,function(t,r,o){e.board.addImageElement(i,r),e.event.fire(e,"TEB_ADDIMAGEELEMENT",t,r,o)})}}else this.event.fire(this,"TEB_WARNING",C,"setBackgroundImage invalid while load history")},Ut.prototype.setHandwritingEnable=function(t){return this.historySyncDone?this.board.setHandwritingEnable(t):(this.event.fire(this,"TEB_WARNING",C,"enableHandwriting invalid while load history"),"")},Ut.prototype.isHandwritingEnable=function(){return this.board.isHandwritingEnable()},Ut.prototype.addAckData=function(t){this.board.addAckData(t)},Ut.prototype.syncAndRefresh=function(){this.historySyncDone?(this.historySyncDone=!1,this.board.syncAndRefresh()):this.event.fire(this,"TEB_WARNING",C,"syncAndRefresh invalid while load history")},e.default=Ut}]).default});